# Aim of the study

Considering described evidence, this dissertation aimed to investigate the modulation of two amygdalar subdivisions, namely BLA and CeA, by two chosen chemokines. 
I focused on CXCL12 and CX3CL1, as they, together with their receptors, were implicated in neurodevelopmental processes, synaptic transmission, neuroimmune responses, and glial regulation.
Moreover, the amygdala is involved in the pathophysiology of several neurological diseases, including  neuropathic pain, epilepsy, and anxiety, in which both CX3CL1/CX3CR1 and CXCL12/CXCR4 pairs are thought to play an important role.
To better understand chemokines' modulation at the network level of the whole complex of the amygdala, both the main input nucleus (the basolateral complex) and the main output nucleus (the central complex) were investigated.

Previous studies have demonstrated complex electrophysiological effects of CXCL12 and CX3CL1, which differ between, among others, brain regions or neuronal populations (see Section: \@ref(chemointheCNS)).
Receptors of CXCL12 and CX3CL1 chemokines are also located in the amygdala (see Sections: \@ref(CX3CL1str) and \@ref(CXCL12str)); however, little is known about their functional consequences. 
Thus, the aim of this dissertation was to investigate the electrophysiological role of chosen chemokines and their receptors in the BLA and the CeA. 

Moreover, at least some chemokine-triggered actions were mediated by glial cells.
Accordingly, this dissertation further aimed to dissect the complex mechanisms underlying bidirectional crosstalk between neurons and glial cells (i.e., astrocytes and microglia) regarding its regulation of membrane properties and synaptic transmission in the amygdala.<!---na razie ok, może uda się coś lepszego --> 

The central hypotheses of the research presented here are: 

1.  Chemokines and chemokine receptors are expressed in the BLA and/or CeA in both neuronal and glial cells.

2. Chemokines directly and/or indirectly *via* glial modulation alter neuronal membrane properties and synaptic transmission in the basolateral and/or central nuclei of the amygdala.

Therefore,<!-- based on different nuclei of the amygdala and different chemokine axes,--> this project can be sub-divided into four separate but physiologically and functionally related parts.<!--, summarized in Fig. \@ref(fig:design). figure...-->

1. Investigation of electrophysiological actions of CX3CL1 and its receptor, CX3CR1, in the rat basolateral nucleus of the amygdala.

2. Investigation of electrophysiological actions of CX3CL1 and its receptor, CX3CR1, in the rat central nucleus

3. Investigation of electrophysiological actions of CXCL12 and their receptor, CXCR4, in the rat basolateral nucleus

4. Investigation of electrophysiological actions of CXCL12 and their receptor, CXCR4, in the rat central nucleus

To address these issues, a whole-cell patch-clamp technique, supplemented with pharmacological approach, was employed. <!-- To further knowledge on these receptors in bone cells, patch clamp and cytosolic calcium measurements, supplemented with molecular biology and
immunohistochemical methods, were used in this project --><!-- several research techniques were employed: whole-cell patch-clamp and extracellular recordings *ex vivo*, immunofluorescent staining and <!--dendritic spines--><!-- // Considering described evidence and proposed hypotheses, the present studies were focused on two separate but physiologically and functionally related subjects:  /// 4 major groups of experiment --><!--Detailed aims and hypotheses addressed in each study, as well as techniques used are listed below.  The   specific AIMS are designed to test these hypotheses:    -->
Precisely, to examine the membrane properties and synaptic transmission of BLA and CeA neurons in brain slices and their sensitivity to chosen chemokine application, *in vitro*  whole-cell patch-clamp recordings were performed in rat brain slices containing the amygdala. 
BLA or CeA neuron membrane properties, spontaneous and miniature excitatory and inhibitory synaptic transmission (sEPSCs/mEPSCs/sIPSCs/mIPSCs) were collected before and after bath application of chosen chemokines. 
Notably, to verify whether astrocytes or microglia are involved in observed effects, in subsets of experiments, recordings were made in the presence of either astrocytic toxin (i.e., fluorocitrate) or the inhibitor of microglial activity (i.e., minocycline).<!-- were additionally pre-applied.-->
To gain additional insights into the role of CX3CL1/CX3CR1 signaling in the amygdala, additional experiments were made to measure their potential modulation of the synaptic plasticity, dendritic morphology. 
The co-localization of CX3CR1 expression with neuronal markers such as NeuN, MAPK, CAMKII`r knitr::asis_output("\U03B1")`, SOM, and PKC`r knitr::asis_output("\U03B4")` was also examined by using immunohistochemistry.
<!-- Fluorescent microscopy was utilized to investigate and quantify co-localization within these two nuclei of the amygdala.  (Appendix A)  .     -->

<!--```{r design, fig.cap='**A schematic illustrating experimental designs of presented PhD dissertation** ', fig.align = 'center', echo = FALSE, message= FALSE }
knitr::include_graphics("images/design.png")
```-->


<!-- Schemat doświadczeń pokazujący grupy eksperymentów zaplanowane w projekcie oraz oczekiwane typy wyników i obserwacji 
 Linie ze strzałkami pokazują główne podejścia eksperymentalne, które pozwolą osiągnąć założone cele badawcze. Symbol błyskawicy 
wskazuje miejsca stymulacji dotyczących protokołów z wywołaną transmisją synaptyczną.-->

<!-- how chemokines coordinate local communication between neurons, microglia, and astrocytes to measure synaptic transmission? -->

\newpage 

<!-- library(elektroasia)

-->
```{r setup cx3cl1, include=FALSE}
setwd("..")
setwd("..")
setwd(".//CX3CL1")


# option for having everything in this file in pandoc option
# output: slidy_presentation

library(elektroasia)
library(xml2)
library(pzfx)
library(patchwork)
library(magick)
library(figpatch)
library(afex)
library(lsmeans)

#### frak2nM CeA membrane properties####
CeA_df_frak2nM<-readRDS(".//CeA//frak2nM//membrane_table_CeA.rds")
CeA_df_frak2nM <- CeA_df_frak2nM %>% mutate(Experiment = 'CX3CL1(2nM)') %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, Type , everything())
bad_Cells <- c(11, 8, 20) # 11 - 19o22019, Capacitane in baseline 141, resistance 190. # based on IV - 19n12009 - IV- 4 and 21225017- 20  
CeA_df_frak2nM <- CeA_df_frak2nM %>% filter(!Cell %in% bad_Cells)

#### frak5nM CeA membrane properties####
CeA_df_frak5nM<-readRDS(".//CeA//frak5nM//membrane_table_CeA_frak5nM.rds")
CeA_df_frak5nM <- CeA_df_frak5nM %>% mutate(Experiment = 'CX3CL1(5nM)') %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, Type , everything())
bad_Cells <- c(6)  
CeA_df_frak5nM <- CeA_df_frak5nM %>% filter(!Cell %in% bad_Cells)

#### azd + frak2nM CeA membrane properties####
CeA_azd_df<-readRDS(".//CeA//AZD//membrane_table_CeA_azd.rds") # comment on 26.11.2020 - only 4 cells 20805001 - after fractalkine very excitable, and it is weird bursting; 20814045 - high access..... 
CeA_azd_df <- CeA_azd_df %>% mutate(Experiment = 'AZD8797 + \nCX3CL1(2nM)') %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, Type , everything()) %>% dplyr::rename(sag_ratio_140 = sag_ratio)
bad_Cells <- c(1, 16) # previously c(6, 8, 5), but very weird group, based on IV 12.08.2021 changes = only one spike after CX3CL1 application//// very high capacitance - 150, but other properties are ok, 5 - sEPSC - holding current
CeA_azd_df <- CeA_azd_df %>% filter(!Cell %in% bad_Cells)

#### mino + frak2nM CeA membrane properties####
CeA_mino_df<-readRDS(".//CeA//mino//membrane_table_CeA_mino.rds")
CeA_mino_df <- CeA_mino_df %>% mutate(Experiment = 'minocycline + \nCX3CL1(2nM)') %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, Type , everything()) %>% dplyr::rename(sag_ratio_140 = sag_ratio)
bad_Cells <- c(9, 15, 2, 11) # Capacitance = 184, much higher than others in baseline; 15- 21507018 - Rm = 961 
CeA_mino_df <- CeA_mino_df %>% filter(!Cell %in% bad_Cells)

#### frak2nM CeA sIPSC####
CeA_RS_sIPSC <- read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_RS_frak2nM.csv")
CeA_RS_sIPSC <- as.tibble(CeA_RS_sIPSC) 
CeA_RS_sIPSC <- CeA_RS_sIPSC %>% mutate(Type ='RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
#bad_Cells <- c(4) # 70 pA -> 20 pA, huge decrease in amplitude
#CeA_RS_sIPSC <- CeA_RS_sIPSC %>% filter(!Cell %in% bad_Cells)
bad_Cells <- c(2) # amplitude from 17->29
CeA_RS_sIPSC <- CeA_RS_sIPSC %>% filter(!Cell %in% bad_Cells)
CeA_LF_sIPSC <- read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_LF_frak2nM.csv")
CeA_LF_sIPSC <- as.tibble(CeA_LF_sIPSC) 
CeA_LF_sIPSC <- CeA_LF_sIPSC %>% mutate(Type ='LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
#bad_Cells <- c(9) # 2 -> 6 Hz, deleted 11.09.20
#CeA_LF_sIPSC <- CeA_LF_sIPSC %>% filter(!Cell %in% bad_Cells)
bad_Cells <- c(1, 13, 9) # amplitude from 17->23; RISETIME > 2
CeA_LF_sIPSC <- CeA_LF_sIPSC %>% filter(!Cell %in% bad_Cells)
CeA_sIPSC_frak2nM <- CeA_RS_sIPSC %>% dplyr::bind_rows(CeA_LF_sIPSC) %>% mutate(Experiment = 'CX3CL1(2nM)')
CeA_sIPSC_frak2nM$Filename <- as.character(CeA_sIPSC_frak2nM$Filename)

#### azd + frak2nM CeA sIPSC####
CeA_azd_RS_sIPSC <- read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_LF_azdfrak2nM.csv")
CeA_azd_RS_sIPSC<- as.tibble(CeA_azd_RS_sIPSC) %>% mutate(Type = 'RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())

CeA_azd_LF_sIPSC <- read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_LF_azdfrak2nM.csv")
CeA_azd_LF_sIPSC<- as.tibble(CeA_azd_LF_sIPSC) %>% mutate(Type = 'LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())

CeA_sIPSC_azd<- CeA_azd_RS_sIPSC  %>% dplyr::bind_rows(CeA_azd_LF_sIPSC) %>% mutate(Experiment = 'AZD8797 + \nCX3CL1(2nM)')
CeA_sIPSC_azd$Filename <- as.character(CeA_sIPSC_azd$Filename)

#### mino + frak2nM CeA sIPSC ####
CeA_mino_RS_sIPSC <- read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_RS_minofrak2nM.csv")
CeA_mino_RS_sIPSC <- as.tibble(CeA_mino_RS_sIPSC) %>% mutate(Type ='RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())

CeA_mino_LF_sIPSC <- read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_LF_minofrak2nM.csv")
CeA_mino_LF_sIPSC <- as.tibble(CeA_mino_LF_sIPSC) %>% mutate(Type ='LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_sIPSC_mino <- CeA_mino_RS_sIPSC %>% dplyr::bind_rows(CeA_mino_LF_sIPSC) %>% mutate(Experiment = 'minocycline + \nCX3CL1(2nM)')
CeA_sIPSC_mino$Filename <- as.character(CeA_sIPSC_mino$Filename)

#### frak2nM CeA sEPSC ####
CeA_RS_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_RS_frak2nM.csv"))
CeA_RS_sEPSC <- CeA_RS_sEPSC %>% mutate(Type ='RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())

CeA_LF_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_LF_frak2nM.csv"))
CeA_LF_sEPSC <- CeA_LF_sEPSC %>% mutate(Type ='LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())

CeA_sEPSC_frak2nM <- CeA_RS_sEPSC %>% dplyr::bind_rows(CeA_LF_sEPSC) %>% mutate(Experiment = 'CX3CL1(2nM)')
CeA_sEPSC_frak2nM$Filename <- as.character(CeA_sEPSC_frak2nM$Filename)

#### frak5nM CeA sEPSC ####
CeA_RS_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_RS_frak5nM.csv"))
CeA_RS_sEPSC <- CeA_RS_sEPSC %>% mutate(Type ='RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())

CeA_LF_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_LF_frak5nM.csv"))
CeA_LF_sEPSC <- CeA_LF_sEPSC %>% mutate(Type ='LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())

CeA_sEPSC_frak5nM <- CeA_RS_sEPSC %>% dplyr::bind_rows(CeA_LF_sEPSC) %>% mutate(Experiment = 'CX3CL1(5nM)')
CeA_sEPSC_frak5nM$Filename <- as.character(CeA_sEPSC_frak5nM$Filename)

#### azd + frak2nM CeA sEPSC ####

CeA_azd_RS_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_RS_azdfrak2nM.csv"))
CeA_azd_RS_sEPSC <- CeA_azd_RS_sEPSC %>% mutate(Type ='RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_azd_RS_sEPSC$Filename <- as.character(CeA_azd_RS_sEPSC$Filename)
#bad_Cells <- c(3) # very low baseline -150 and - 200, also very high frequency in comparison to the rest of group (10,12 Hz)
#CeA_azd_RS_sEPSC <- CeA_azd_RS_sEPSC %>% filter(!Cell %in% bad_Cells)
CeA_azd_LF_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_LF_azdfrak2nM.csv"))
CeA_azd_LF_sEPSC <- CeA_azd_LF_sEPSC %>% mutate(Type ='LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_azd_LF_sEPSC$Filename <- as.character(CeA_azd_LF_sEPSC$Filename)
#bad_Cells <- c(3,5) # 20612007, 20710001 - due to high capacitance
#CeA_azd_LF_sEPSC <- CeA_azd_LF_sEPSC %>% filter(!Cell %in% bad_Cells)
CeA_sEPSC_azd<- CeA_azd_RS_sEPSC  %>% dplyr::bind_rows(CeA_azd_LF_sEPSC) %>% mutate(Experiment = 'AZD8797 + \nCX3CL1(2nM)')

#### mino + frak2nM CeA sEPSC ####
CeA_mino_RS_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_RS_minofrak2nM.csv"))
CeA_mino_RS_sEPSC <- CeA_mino_RS_sEPSC %>% mutate(Type ='RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_mino_RS_sEPSC$Filename <- as.character(CeA_mino_RS_sEPSC$Filename)
CeA_mino_LF_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_LF_minofrak2nM.csv"))
CeA_mino_LF_sEPSC <- CeA_mino_LF_sEPSC %>% mutate(Type ='LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_mino_LF_sEPSC$Filename <- as.character(CeA_mino_LF_sEPSC$Filename)
#bad_Cells <- c(5) # 20703027 Capacitance = 184, much higher than others in baseline
#CeA_mino_LF_sEPSC <- CeA_mino_LF_sEPSC %>% filter(!Cell %in% bad_Cells)
CeA_sEPSC_mino<- CeA_mino_RS_sEPSC  %>% dplyr::bind_rows(CeA_mino_LF_sEPSC) %>% mutate(Experiment = 'minocycline + \nCX3CL1(2nM)')



#### mino alone CeA membrane properties ####
CeA_df_minoa<-readRDS(".//minocycline_alone//CeA//membrane_table_CeA_mino_alone.rds")
CeA_df_minoa <- CeA_df_minoa %>% mutate(Experiment = 'minocycline') %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, Type , everything()) %>% dplyr::rename(sag_ratio_140 = sag_ratio)
bad_Cells <- c(9, 8, 10, 12, 18, 13) #poszarpana i brzydka - sEPSC; IV - RS - brzydkie 20d08045, 20813003, 20729032
CeA_df_minoa <- CeA_df_minoa %>% filter(!Cell %in% bad_Cells)


#### mino alone CeA sIPSC ####
CeA_minoa_RS_sIPSC <- read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_RS_minoa.csv") 
CeA_minoa_RS_sIPSC <- as.tibble(CeA_minoa_RS_sIPSC) %>% mutate(Type ='RS', Experiment = 'minocycline') %>% dplyr::select(Filename, Cell, Condition, Type, everything())

CeA_minoa_LF_sIPSC <- read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_LF_minoa.csv") 
CeA_minoa_LF_sIPSC <- as.tibble(CeA_minoa_LF_sIPSC) %>% mutate(Type ='LF', Experiment = 'minocycline') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_sIPSC_minoa<- CeA_minoa_RS_sIPSC  %>% dplyr::bind_rows(CeA_minoa_LF_sIPSC) %>% mutate(Experiment = 'minocycline')
CeA_sIPSC_minoa$Condition <- plyr::revalue(CeA_sIPSC_minoa$Condition, c("b"="baseline", "f" = "minocycline"))
CeA_sIPSC_minoa$Filename <- as.character(CeA_sIPSC_minoa$Filename)

#### mino alone CeA sEPSC ####
CeA_minoa_RS_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_RS_minoa.csv"))
CeA_minoa_RS_sEPSC <- CeA_minoa_RS_sEPSC %>% mutate(Type ='RS', Experiment = 'minocycline') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_minoa_RS_sEPSC$Filename <- as.character(CeA_minoa_RS_sEPSC$Filename)
#bad_Cells <- c(3,6) # iv 20d08045, 20813003
#CeA_minoa_RS_sEPSC <- CeA_minoa_RS_sEPSC %>% filter(!Cell %in% bad_Cells)

CeA_minoa_LF_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_LF_minoa.csv"))
CeA_minoa_LF_sEPSC <- CeA_minoa_LF_sEPSC %>% mutate(Type ='LF', Experiment = 'minocycline') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_minoa_LF_sEPSC$Filename <- as.character(CeA_minoa_LF_sEPSC$Filename)
#bad_Cells <- c(6) # iv 20729032 - LF ale powinien być RS?!
#CeA_minoa_RS_sEPSC <- CeA_minoa_RS_sEPSC %>% filter(!Cell %in% bad_Cells)


CeA_sEPSC_minoa<- CeA_minoa_RS_sEPSC  %>% dplyr::bind_rows(CeA_minoa_LF_sEPSC) %>% mutate(Experiment = 'minocycline')
CeA_sEPSC_minoa$Condition <- plyr::revalue(CeA_sEPSC_minoa$Condition, c("b"="baseline", "f" = "minocycline"))


#### azd alone CeA membrane properties ####
CeA_df_azda<-readRDS(".//AZD_alone//CeA//membrane_table_CeA_azd_alone.rds")
CeA_df_azda <- CeA_df_azda %>% mutate(Experiment = "AZD8797") %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, Type , everything()) %>% dplyr::rename(sag_ratio_140 = sag_ratio)
CeA_df_azda$RMS <- as.numeric(CeA_df_azda$RMS)
bad_Cells <- c(1, 19, 10, 15, 12, 13, 17, 5, 9, 8) # Capacitance almost 0, (0.1, 0.15) ## wrong matlab scripts, check it - 3, 9 //// 10 - strasznie poszarpana w sEPSC ;;; 12, 13 - resistance ; 20d11024 - 17 - IV; 20813033 20819008 IV, // 1- 20805001 IV , 19 - 21219027 - IV 8 - 20814045
CeA_df_azda <- CeA_df_azda %>% dplyr::filter(!Cell %in% bad_Cells)
CeA_df_azda$Condition <- plyr::revalue(CeA_df_azda$Condition, c("AZD" = "AZD8797"))
CeA_df_azda$Condition = factor(CeA_df_azda$Condition, levels=c('baseline', "AZD8797"))
CeA_df_azda <- CeA_df_azda %>% arrange(Experiment, Filename_all1, Cell, Condition)

#### azd alone CeA sIPSC####

sIPSC_CeA_RS_azd_alone <- read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_RS_azda.csv")
CeA_azda_RS_sIPSC <- as.tibble(sIPSC_CeA_RS_azd_alone) %>% mutate(Type ='RS', Experiment = "AZD8797") %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_azda_RS_sIPSC$Condition <- plyr::revalue(CeA_azda_RS_sIPSC$Condition, c("b"="baseline", "f" = "AZD8797"))

sIPSC_CeA_LF_azd_alone <- read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_LF_azda.csv")
CeA_azda_LF_sIPSC <- as.tibble(sIPSC_CeA_LF_azd_alone) %>% mutate(Type ='LF', Experiment = "AZD8797") %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_azda_LF_sIPSC$Condition <- plyr::revalue(CeA_azda_LF_sIPSC$Condition, c("b"="baseline", "f" = "AZD8797"))
bad_Cells <- c("2") # amplitude 13 -> 24
CeA_azda_LF_sIPSC <- CeA_azda_LF_sIPSC %>% filter(!Cell %in% bad_Cells)


CeA_sIPSC_azda<- CeA_azda_RS_sIPSC  %>% dplyr::bind_rows(CeA_azda_LF_sIPSC) %>% mutate(Experiment = "AZD8797")
#CeA_sIPSC_azda$Condition <- plyr::revalue(CeA_sIPSC_azda$Condition, c("b"="baseline", "f" = "AZD8797"))
CeA_sIPSC_azda$Condition = factor(CeA_sIPSC_azda$Condition, levels=c('baseline', "AZD8797"))
CeA_sIPSC_azda$Filename <- as.character(CeA_sIPSC_azda$Filename)

#### azd alone CeA sEPSC ####

sEPSC_CeA_azda_RS <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_RS_azda.csv"))
sEPSC_CeA_azda_RS <- sEPSC_CeA_azda_RS %>% mutate(Type ='RS', Experiment = "AZD8797") %>% dplyr::select(Filename, Cell, Condition, Type, everything())
sEPSC_CeA_azda_RS$Condition <- plyr::revalue(sEPSC_CeA_azda_RS$Condition, c("b"="baseline", "f" = "AZD8797"))
sEPSC_CeA_azda_RS$Filename <- as.character(sEPSC_CeA_azda_RS$Filename)

sEPSC_CeA_azda_LF <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_LF_azda.csv"))
sEPSC_CeA_azda_LF <- sEPSC_CeA_azda_LF %>% mutate(Type ='LF', Experiment = "AZD8797") %>% dplyr::select(Filename, Cell, Condition, Type, everything())
sEPSC_CeA_azda_LF$Condition <- plyr::revalue(sEPSC_CeA_azda_LF$Condition, c("b"="baseline", "f" = "AZD8797"))
sEPSC_CeA_azda_LF$Filename <- as.character(sEPSC_CeA_azda_LF$Filename)
#bad_Cells <- c(3,4) # 3, 5 - IV 
#CeA_azda_LF_sEPSC <- CeA_azda_LF_sEPSC %>% filter(!Cell %in% bad_Cells)
CeA_sEPSC_azda<- sEPSC_CeA_azda_RS  %>% dplyr::bind_rows(sEPSC_CeA_azda_LF) %>% mutate(Experiment = "AZD8797")
CeA_sEPSC_azda$Condition = factor(CeA_sEPSC_azda$Condition, levels=c('baseline', "AZD8797"))


#### CeA big table membrane properties ####

CeA_df_final <- CeA_df_frak2nM  %>% dplyr::bind_rows(CeA_azd_df) %>% dplyr::bind_rows(CeA_mino_df) %>% dplyr::bind_rows(CeA_df_azda) %>% dplyr::bind_rows(CeA_df_minoa) # %>% dplyr::bind_rows(CeA_df_frak5nM)  - too small nr of cells, both in RS and LF condition.

CeA_df_final$Condition <- plyr::revalue(CeA_df_final$Condition, c("fractalkine" = "CX3CL1"))
CeA_df_final$Condition <- plyr::revalue(CeA_df_final$Condition, c("AZD" = "AZD8797"))

CeA_df_final$Experiment = factor(CeA_df_final$Experiment, levels=c('CX3CL1(2nM)','CX3CL1(5nM)', 'AZD8797 + \nCX3CL1(2nM)', "AZD8797", 'minocycline + \nCX3CL1(2nM)', 'minocycline'))
CeA_df_final$Condition <- as.factor(CeA_df_final$Condition)
CeA_df_final$Type <- as.factor(CeA_df_final$Type)
CeA_df_final$Cell <- rep(1:(nrow(CeA_df_final)/2), each = 2)
CeA_df_final <- CeA_df_final %>% dplyr::arrange(Experiment, Filename_all1, Cell, Condition, Type)
CeA_df_final$Condition <- factor(CeA_df_final$Condition, levels = c("baseline", "CX3CL1", "minocycline", "AZD8797"))
CeA_df_final_RS <- CeA_df_final %>% filter( Type == 'RS')
CeA_df_final_LF <- CeA_df_final %>% filter( Type == 'LF')
temp <- CeA_df_final %>% filter(Condition == 'baseline') %>% filter(sag_ratio_140 >= 102)

sag_Cells <- temp$Cell
CeA_df_sag <- CeA_df_final %>% filter(Cell %in% sag_Cells)
CeA_df_sag_RS <- CeA_df_sag %>% filter( Type == 'RS')
CeA_df_sag_LF <- CeA_df_sag %>% filter( Type == 'LF')

#### CeA big table sIPSC ####

CeA_sIPSC_final <- CeA_sIPSC_frak2nM %>% dplyr::bind_rows(CeA_sIPSC_azd) %>% dplyr::bind_rows(CeA_sIPSC_mino) %>% dplyr::bind_rows(CeA_sIPSC_minoa) %>% dplyr::bind_rows(CeA_sIPSC_azda) %>% dplyr::select(Experiment, everything())
CeA_sIPSC_final <- as.tibble(CeA_sIPSC_final)

CeA_sIPSC_final$Condition <- plyr::revalue(CeA_sIPSC_final$Condition, c("b"="baseline", "f" = "CX3CL1"))
CeA_sIPSC_final$Condition <- factor(CeA_sIPSC_final$Condition, levels = c("baseline", "CX3CL1", "AZD8797", "minocycline"))
CeA_sIPSC_final$Cell <- rep(1:(nrow(CeA_sIPSC_final)/2), each = 2)
CeA_sIPSC_final$Experiment <- as.factor(CeA_sIPSC_final$Experiment)
CeA_sIPSC_final$Experiment = factor(CeA_sIPSC_final$Experiment, levels=c('CX3CL1(2nM)','AZD8797 + \nCX3CL1(2nM)',"AZD8797",'minocycline + \nCX3CL1(2nM)', 'minocycline'))
#CeA_all_sIPSC_sum$Cell <- rep(1:(nrow(CeA_all_sIPSC_sum)/2), each = 2)
CeA_sIPSC_RS <- CeA_sIPSC_final %>% filter(Type == 'RS')
CeA_sIPSC_LF <- CeA_sIPSC_final %>% filter(Type == 'LF')

bad_Cells <- c(66) # strasznie duży spadek ampltiduy
CeA_sIPSC_RS <- CeA_sIPSC_RS %>% filter(!Cell %in% bad_Cells) # CeA_LF_sIPSC <- CeA_LF_sIPSC %>% filter(!Cell %in% bad_Cells)

#### frak2nM CeA mIPSC ####
CeA_frak2nM_mIPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_mIPSC_CeA_LF_frak2nM.csv"))
CeA_frak2nM_mIPSC <- CeA_frak2nM_mIPSC %>% dplyr::mutate(Type = "LF") %>% dplyr::mutate(Experiment = "CX3CL1(2nM)")
bad_Cells <- c(7) #reduced amplitude 30-15
CeA_frak2nM_mIPSC <- CeA_frak2nM_mIPSC %>% filter(!Cell %in% bad_Cells)
CeA_frak2nM_mIPSC <- CeA_frak2nM_mIPSC %>% dplyr::select(Experiment, Filename, Cell, Condition, Type, everything()) %>% as_tibble()
CeA_frak2nM_mIPSC$Condition <- plyr::revalue(CeA_frak2nM_mIPSC$Condition, c("b"="baseline", "f" = "CX3CL1"))

#### CeA big table sEPSC ####
CeA_sEPSC_final <- CeA_sEPSC_frak2nM %>% dplyr::bind_rows(CeA_sEPSC_frak5nM) %>% dplyr::bind_rows(CeA_sEPSC_azd) %>% dplyr::bind_rows(CeA_sEPSC_mino) %>% dplyr::bind_rows(CeA_sEPSC_minoa) %>% dplyr::bind_rows(CeA_sEPSC_azda) %>%dplyr::select(Experiment, everything())
CeA_sEPSC_final <- as.tibble(CeA_sEPSC_final)
CeA_sEPSC_final$Condition <- plyr::revalue(CeA_sEPSC_final$Condition, c("b"="baseline", "f" = "CX3CL1"))
CeA_sEPSC_final$Condition <- factor(CeA_sEPSC_final$Condition, levels = c("baseline", "CX3CL1", "AZD8797", "minocycline"))
CeA_sEPSC_final$Cell <- rep(1:(nrow(CeA_sEPSC_final)/2), each = 2)
CeA_sEPSC_final$Experiment = factor(CeA_sEPSC_final$Experiment, levels=c('CX3CL1(2nM)','CX3CL1(5nM)', 'AZD8797 + \nCX3CL1(2nM)', "AZD8797", 'minocycline + \nCX3CL1(2nM)', 'minocycline'))
CeA_sEPSC_RS <- CeA_sEPSC_final %>% filter(Type == 'RS')
CeA_sEPSC_LF <- CeA_sEPSC_final %>% filter(Type == 'LF')

#### frak2nM BLA membrane properties ####

BLA_frak2nM_df<-readRDS(".//BLA//2nM//fractalkine//membrane_table_frak2nM.rds")
BLA_frak2nM_df$Cell <- as.factor(BLA_frak2nM_df$Cell)
BLA_frak2nM_df$Condition <- as.factor(BLA_frak2nM_df$Condition)
bad_Cells <- c(1, 14, 8, 2 , 4, 9)  #filtering 3 and 14 because of capacitance and 2 because of only 2 spikes and very depolarized, 1 - Rm more than 200, duży access, 13 - tau; ealier: 1, 2, 3, 13, 14. WHY 8? 
BLA_frak2nM_df <- BLA_frak2nM_df %>% filter(!Cell %in% bad_Cells) 
BLA_frak2nM_df <- BLA_frak2nM_df %>% mutate(Experiment = "CX3CL1(2nM)") %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, everything())
BLA_frak2nM_inter <- BLA_frak2nM_df %>% filter(Type == "interneuron")
BLA_frak2nM_df <- BLA_frak2nM_df %>% filter(Type == "PC")
BLA_frak2nM_df_b <- BLA_frak2nM_df %>% filter(Condition == 'baseline')
BLA_frak2nM_df_c <- BLA_frak2nM_df %>% filter(Condition == 'CX3CL1')

#### frak5nM BLA membrane properties ####

BLA_frak5nM_df<-readRDS(".//BLA//5nM//membrane_table_frak5nM.rds")
BLA_frak5nM_df$Cell <- as.factor(BLA_frak5nM_df$Cell)
BLA_frak5nM_df$Condition <- as.factor(BLA_frak5nM_df$Condition)
bad_Cells <- c(13, 11, 5) # 13- NA adaptation ratio, 11 - Rm more than 250, 1 - DUŻY ACCESS, ####24.11.2020 wycofany 1, 5 - too different Threshold
BLA_frak5nM_df <- BLA_frak5nM_df %>% filter(!Cell %in% bad_Cells) 
BLA_frak5nM_df <- BLA_frak5nM_df %>% mutate(Experiment = "CX3CL1(5nM)") %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, everything())
BLA_frak5nM_inter <- BLA_frak5nM_df %>% filter(Type == "interneuron")
BLA_frak5nM_df <- BLA_frak5nM_df %>% filter(Type == "PC")
BLA_frak5nM_df_b <- BLA_frak5nM_df %>% filter(Condition == 'baseline')
BLA_frak5nM_df_c <- BLA_frak5nM_df %>% filter(Condition == 'CX3CL1')


#### azd + frak2nM BLA membrane properties ####
BLA_azd_df<-readRDS(".//BLA//2nM//AZD//membrane_table_azd.rds")
BLA_azd_df$Cell <- as.factor(BLA_azd_df$Cell)
BLA_azd_df$Condition <- as.factor(BLA_azd_df$Condition)
bad_Cells <- c(1, 2, 4, 9, 12, 13, 6) # 2, 9 ,12, 13 adaptation ratio less than 2 spikes, 1, 11- weird IV and late starting firing , 4- Cm, 5- Rm > 200, ale na razie cofam to, bo jest sEPSC; 6 - 19121023 - weird IV
BLA_azd_df <- BLA_azd_df %>% filter(!Cell %in% bad_Cells) 
BLA_azd_df <- BLA_azd_df %>% mutate(Experiment = "AZD8797 + \nCX3CL1(2nM)")  %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, everything())
BLA_azd_df <- BLA_azd_df %>% filter(Type == "PC")
BLA_azd_df_b <- BLA_azd_df %>% filter(Condition == 'baseline')
BLA_azd_df_c <- BLA_azd_df %>% filter(Condition == 'CX3CL1')

#### anti + frak2nM BLA membrane properties ####
BLA_anti_df<-readRDS(".//BLA//2nM//przeciwcialo//membrane_table_anti.rds")
BLA_anti_df$Cell <- as.factor(BLA_anti_df$Cell)
BLA_anti_df$Condition <- as.factor(BLA_anti_df$Condition)
bad_Cells <- c(3,8, 2, 4) # adaptation ratio >2   #C > 900, 2, 4 - WEIRD sEPSC
BLA_anti_df <- BLA_anti_df %>% filter(!Cell %in% bad_Cells)
BLA_anti_df <- BLA_anti_df %>% mutate(Experiment = 'anti-CX3CR1 + \nCX3CL1(2nM)') %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, everything()) #%>% dplyr::rename(sag_ratio_140 = sag_ratio_80)
BLA_anti_df <- BLA_anti_df %>% filter(Type == "PC")
BLA_anti_df_b <- BLA_anti_df %>% filter(Condition == 'baseline')
BLA_anti_df_c <- BLA_anti_df %>% filter(Condition == 'CX3CL1')


#### mino + frak2nM BLA membrane properties ####
BLA_mino_df<-readRDS(".//BLA//2nM//minocycline//membrane_table_mino.rds")
BLA_mino_df$Cell <- as.factor(BLA_mino_df$Cell)
BLA_mino_df$Condition <- as.factor(BLA_mino_df$Condition)
bad_Cells <- c(6, 18) #6, 18- NA adaptation ratio 
BLA_mino_df <- BLA_mino_df %>% filter(!Cell %in% bad_Cells)
BLA_mino_df <- BLA_mino_df %>% mutate(Experiment = 'minocycline + \nCX3CL1(2nM)')  %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, everything())
BLA_mino_inter <- BLA_mino_df %>% filter(Type == "interneuron")
BLA_mino_df <- BLA_mino_df %>% filter(Type == "PC")
BLA_mino_df_b <- BLA_mino_df %>% filter(Condition == 'baseline')
BLA_mino_df_c <- BLA_mino_df %>% filter(Condition == 'CX3CL1')

#### picro + frak2nM BLA membrane properties ####

BLA_picro_df<-readRDS(".//BLA//2nM//GABA//membrane_table_picro.rds")
bad_Cells <- c(1) # 20603002 IV
BLA_picro_df <- BLA_picro_df %>% filter(!Cell %in% bad_Cells)
BLA_picro_df$Cell <- as.factor(BLA_picro_df$Cell)
BLA_picro_df$Condition <- as.factor(BLA_picro_df$Condition) 
BLA_picro_df <- BLA_picro_df %>% mutate(Experiment = 'picrotoxin + \nCGP52432 + \nCX3CL1(2nM)') %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, everything()) #%>% dplyr::rename(sag_ratio_140 = sag_ratio)
BLA_picro_df <- BLA_picro_df %>% filter(Type == "PC")
BLA_picro_df_b <- BLA_picro_df %>% filter(Condition == 'baseline')
BLA_picro_df_c <- BLA_picro_df %>% filter(Condition == 'CX3CL1')


#### frak2nM BLA sEPSC ####
BLA_frak2nM_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_BLA_frak2nM.csv"))
BLA_frak2nM_sEPSC <- BLA_frak2nM_sEPSC %>% dplyr::mutate(Experiment = 'CX3CL1(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_frak2nM_sEPSC$Filename <- as.character(BLA_frak2nM_sEPSC$Filename)

BLA_frak5nM_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_BLA_frak5nM.csv"))
BLA_frak5nM_sEPSC <- BLA_frak5nM_sEPSC %>% dplyr::mutate(Experiment = 'CX3CL1(5nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_frak5nM_sEPSC$Filename <- as.character(BLA_frak5nM_sEPSC$Filename)

BLA_azd_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_BLA_azdfrak2nM.csv"))
#bad_Cells <- c(3) # weird IV, 19121023
#BLA_azd_sEPSC <- BLA_azd_sEPSC %>% filter(!Cell %in% bad_Cells)
BLA_azd_sEPSC <- BLA_azd_sEPSC %>% mutate(Experiment = 'AZD8797 + \nCX3CL1(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_azd_sEPSC$Filename <- as.character(BLA_azd_sEPSC$Filename)

BLA_anti_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_BLA_antifrak2nM.csv"))
BLA_anti_sEPSC <- BLA_anti_sEPSC %>% mutate(Experiment = 'anti-CX3CR1 + \nCX3CL1(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_anti_sEPSC$Filename <- as.character(BLA_anti_sEPSC$Filename)

BLA_mino_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_BLA_minofrak2nM.csv"))
BLA_mino_sEPSC <- BLA_mino_sEPSC %>% mutate(Experiment = 'minocycline + \nCX3CL1(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_mino_sEPSC$Filename <- as.character(BLA_mino_sEPSC$Filename)

BLA_picro_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_BLA_picrofrak2nM.csv"))
#bad_Cells <- c(5, 1) # brzydkie sEPSC wg komentarza; 1 - IV
#BLA_picro_sEPSC <- BLA_picro_sEPSC %>% filter(!Cell %in% bad_Cells)
BLA_picro_sEPSC <- BLA_picro_sEPSC %>% mutate(Experiment = 'picrotoxin + \nCGP52432 + \nCX3CL1(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_picro_sEPSC$Filename <- as.character(BLA_picro_sEPSC$Filename)

#### frak2nM BLA sIPSC ####
BLA_frak2nM_sIPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_BLA_frak2nM.csv"))
BLA_frak2nM_sIPSC <- BLA_frak2nM_sIPSC %>% mutate(Experiment = 'CX3CL1(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_frak2nM_sIPSC$Filename <- as.character(BLA_frak2nM_sIPSC$Filename)

BLA_frak5nM_sIPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_BLA_frak5nM.csv"))
#bad_Cells <- c(6, 9 ) # holding current > 600 pA; 9 - big inrease
#BLA_frak5nM_sIPSC <- BLA_frak5nM_sIPSC %>% filter(!Cell %in% bad_Cells)
BLA_frak5nM_sIPSC <- BLA_frak5nM_sIPSC %>%  mutate(Experiment = 'CX3CL1(5nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_frak5nM_sIPSC$Filename <- as.character(BLA_frak5nM_sIPSC$Filename)

BLA_azd_sIPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_BLA_azdfrak2nM.csv"))
BLA_azd_sIPSC <- BLA_azd_sIPSC %>% mutate(Experiment = 'AZD8797 + \nCX3CL1(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_azd_sIPSC$Filename <- as.character(BLA_azd_sIPSC$Filename)

BLA_azdfrak5nM_sIPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_BLA_azdfrak5nM.csv"))
BLA_azdfrak5nM_sIPSC <- BLA_azdfrak5nM_sIPSC %>%  mutate(Experiment = "AZD8797 + \nCX3CL1(5nM)") %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_azdfrak5nM_sIPSC$Filename <- as.character(BLA_azdfrak5nM_sIPSC$Filename)

BLA_anti_sIPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_BLA_antifrak2nM.csv"))
BLA_anti_sIPSC <- BLA_anti_sIPSC %>% mutate(Experiment = 'anti-CX3CR1 + \nCX3CL1(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_anti_sIPSC$Filename <- as.character(BLA_anti_sIPSC$Filename)

BLA_mino_sIPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_BLA_minofrak2nM.csv"))
BLA_mino_sIPSC <- BLA_mino_sIPSC %>% mutate(Experiment = 'minocycline + \nCX3CL1(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_mino_sIPSC$Filename <- as.character(BLA_mino_sIPSC$Filename)

BLA_minofrak5nM_sIPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_BLA_minofrak5nM.csv"))
BLA_minofrak5nM_sIPSC <- BLA_minofrak5nM_sIPSC %>% mutate(Experiment = 'minocycline + \nCX3CL1(5nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_minofrak5nM_sIPSC$Filename <- as.character(BLA_minofrak5nM_sIPSC$Filename)

#### mino alone BLA membrane properties ####
# Setting working directory and loading main table
BLA_df_minoa<-readRDS(".//minocycline_alone//BLA//membrane_table_BLA_mino_alone.rds")
BLA_df_minoa <- BLA_df_minoa %>% mutate(Experiment = 'minocycline') %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, everything()) #%>% dplyr::rename(sag_ratio_140 = sag_ratio)
BLA_df_minoa$Cell <- as.factor(BLA_df_minoa$Cell)
BLA_df_minoa$Condition <- as.factor(BLA_df_minoa$Condition)
BLA_df_minoa <- BLA_df_minoa %>% filter(Type == "PC")


#### mino alone BLA sEPSC ####
BLA_minoa_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_BLA_minoa.csv"))
BLA_minoa_sEPSC <- BLA_minoa_sEPSC %>% mutate(Experiment = 'minocycline') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_minoa_sEPSC$Condition <- plyr::revalue(BLA_minoa_sEPSC$Condition, c("b"="baseline", "f" = "minocycline"))
BLA_minoa_sEPSC$Filename <- as.character(BLA_minoa_sEPSC$Filename)
BLA_minoa_sEPSC$Cell <- as.numeric(BLA_minoa_sEPSC$Cell)
#bad_Cells <- c(7) # BARDZIEJ INTERNEURON, NIE JEST BRANY W IV, ALE ZNÓW MA MAŁĄ POBUDLIWOŚĆ
#BLA_minoa_sEPSC <- BLA_minoa_sEPSC %>% filter(!Cell %in% bad_Cells)

#### mino alone BLA sIPSC ####
BLA_minoa_sIPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_BLA_minoa.csv"))
BLA_minoa_sIPSC <- BLA_minoa_sIPSC %>% mutate(Experiment = 'minocycline') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_minoa_sIPSC$Condition <- plyr::revalue(BLA_minoa_sIPSC$Condition, c("b"="baseline", "f" = "minocycline"))
BLA_minoa_sIPSC$Filename <- as.character(BLA_minoa_sIPSC$Filename)
#BLA_minoa_sIPSC$Cell <- as.numeric(BLA_minoa_sIPSC$Cell)

#### azd alone BLA membrane properties ####
# Setting working directory and loading main table
BLA_df_azda<-readRDS(".//AZD_alone//BLA//membrane_table_BLA_azd_alone.rds")

BLA_df_azda <- BLA_df_azda %>% mutate(Experiment = "AZD8797") %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, everything()) #%>% dplyr::rename(sag_ratio_140 = sag_ratio)
BLA_df_azda$Cell <- as.factor(BLA_df_azda$Cell)
bad_Cells <- c(5, 3) # weird IV - almost none spikes (2082002) ; IV 20603002
BLA_df_azda <- BLA_df_azda %>% filter(!Cell %in% bad_Cells)
BLA_df_azda$Condition <- plyr::revalue(BLA_df_azda$Condition, c("AZD" = "AZD8797"))
BLA_df_azda$Condition <- factor(BLA_df_azda$Condition, levels = c("baseline", "AZD8797"))
BLA_df_azda <- BLA_df_azda %>% dplyr::arrange(Experiment, Filename_all1, Cell, Condition)
BLA_df_azda <- BLA_df_azda %>% filter(Type == "PC")

#### azd alone BLA sEPSC ####

BLA_azda_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_BLA_azda.csv"))
BLA_azda_sEPSC <- BLA_azda_sEPSC %>% mutate(Experiment = "AZD8797") %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
#bad_Cells <- c(5, 3) #weird IV - 2082002
#BLA_azda_sEPSC <- BLA_azda_sEPSC %>% filter(!Cell %in% bad_Cells)
BLA_azda_sEPSC$Condition <- plyr::revalue(BLA_azda_sEPSC$Condition, c("b"="baseline", "f" = "AZD8797"))
BLA_azda_sEPSC$Condition <- factor(BLA_azda_sEPSC$Condition, levels = c("baseline", "AZD8797"))
BLA_azda_sEPSC$Filename <- as.character(BLA_azda_sEPSC$Filename)
BLA_azda_sEPSC$Cell <- as.numeric(BLA_azda_sEPSC$Cell)

#### azd alone BLA sIPSC ####

BLA_azda_sIPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_BLA_azda.csv"))
BLA_azda_sIPSC <- BLA_azda_sIPSC %>% mutate(Experiment = "AZD8797") %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_azda_sIPSC$Condition <- plyr::revalue(BLA_azda_sIPSC$Condition, c("b"="baseline", "f" = "AZD8797"))
BLA_azda_sIPSC$Condition <- factor(BLA_azda_sIPSC$Condition, levels = c("baseline", "AZD8797"))
#BLA_azda_sIPSC$Cell <- as.numeric(BLA_azda_sIPSC$Cell)
BLA_azda_sIPSC$Filename <- as.character(BLA_azda_sIPSC$Filename)

#### BLA final table membrane properties ####

BLA_df_final <- BLA_frak2nM_df %>% dplyr::bind_rows(BLA_frak5nM_df) %>% dplyr::bind_rows(BLA_azd_df) %>% dplyr::bind_rows(BLA_anti_df) %>% dplyr::bind_rows(BLA_mino_df) %>% dplyr::bind_rows(BLA_picro_df)

BLA_df_final$Condition <- plyr::revalue(BLA_df_final$Condition, c("fractalkine" = "CX3CL1"))


BLA_df_final <- BLA_df_final %>% dplyr::bind_rows(BLA_df_minoa) %>% dplyr::bind_rows(BLA_df_azda)
BLA_df_final <- BLA_df_final %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, everything())
BLA_df_final$Experiment = factor(BLA_df_final$Experiment, levels=c('CX3CL1(2nM)', 'CX3CL1(5nM)','anti-CX3CR1 + \nCX3CL1(2nM)','AZD8797 + \nCX3CL1(2nM)',"AZD8797", 'minocycline + \nCX3CL1(2nM)', 'minocycline', 'picrotoxin + \nCGP52432 + \nCX3CL1(2nM)'))
BLA_df_final$Condition <- as.factor(BLA_df_final$Condition)
BLA_df_final$Cell <- rep(1:(nrow(BLA_df_final)/2), each = 2)


temp <- BLA_df_final %>% filter(Condition == 'baseline') %>% filter(sag_ratio >= 102)

sag_Cells <- temp$Cell
BLA_df_sag <- BLA_df_final %>% filter(Cell %in% sag_Cells) %>% dplyr::rename(sag_ratio_140 = sag_ratio)


#### BLA final table sEPSC ####

BLA_sEPSC_final <- BLA_frak2nM_sEPSC %>% dplyr::bind_rows(BLA_frak5nM_sEPSC) %>% dplyr::bind_rows(BLA_azd_sEPSC) %>% dplyr::bind_rows(BLA_anti_sEPSC) %>% dplyr::bind_rows(BLA_mino_sEPSC) %>% dplyr::bind_rows(BLA_picro_sEPSC) %>% dplyr::bind_rows(BLA_minoa_sEPSC) %>% dplyr::bind_rows(BLA_azda_sEPSC)
BLA_sEPSC_final <- BLA_sEPSC_final %>% dplyr::select(Experiment, Filename, Cell, Condition, everything()) %>% as_tibble()
BLA_sEPSC_final$Condition <- plyr::revalue(BLA_sEPSC_final$Condition, c("b"="baseline", "f" = "CX3CL1"))
BLA_sEPSC_final$Condition <- factor(BLA_sEPSC_final$Condition, levels = c("baseline", "CX3CL1", "AZD8797", "minocycline"))
BLA_sEPSC_final$Experiment = factor(BLA_sEPSC_final$Experiment, levels=c('CX3CL1(2nM)', 'CX3CL1(5nM)','anti-CX3CR1 + \nCX3CL1(2nM)', 'AZD8797 + \nCX3CL1(2nM)',"AZD8797", 'minocycline + \nCX3CL1(2nM)', 'minocycline', 'picrotoxin + \nCGP52432 + \nCX3CL1(2nM)'))
BLA_sEPSC_final$Cell <- rep(1:(nrow(BLA_sEPSC_final)/2), each = 2)

#### BLA final table sIPSC ####

BLA_sIPSC_final <- BLA_frak2nM_sIPSC %>% dplyr::bind_rows(BLA_frak5nM_sIPSC) %>% dplyr::bind_rows(BLA_azd_sIPSC) %>% dplyr::bind_rows(BLA_anti_sIPSC) %>% dplyr::bind_rows(BLA_mino_sIPSC) %>% dplyr::bind_rows(BLA_minofrak5nM_sIPSC) %>% dplyr::bind_rows(BLA_minoa_sIPSC) %>% dplyr::bind_rows(BLA_azda_sIPSC) %>% dplyr::bind_rows(BLA_azdfrak5nM_sIPSC)
BLA_sIPSC_final <- BLA_sIPSC_final %>% dplyr::select(Experiment, Filename, Cell, Condition, everything()) %>% as_tibble()
BLA_sIPSC_final$Condition <- plyr::revalue(BLA_sIPSC_final$Condition, c("b"="baseline", "f" = "CX3CL1"))
BLA_sIPSC_final$Condition <- factor(BLA_sIPSC_final$Condition, levels = c("baseline", "CX3CL1", "AZD8797", "minocycline"))
BLA_sIPSC_final$Experiment = factor(BLA_sIPSC_final$Experiment, levels=c('CX3CL1(2nM)', 'CX3CL1(5nM)','anti-CX3CR1 + \nCX3CL1(2nM)','AZD8797 + \nCX3CL1(2nM)',"AZD8797 + \nCX3CL1(5nM)", "AZD8797",'minocycline + \nCX3CL1(2nM)', 'minocycline + \nCX3CL1(5nM)', 'minocycline'))
BLA_sIPSC_final$Cell <- rep(1:(nrow(BLA_sIPSC_final)/2), each = 2)

#### BLA mEPSC ####

BLA_frak2nM_mEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_mEPSC_BLA_frak2nM.csv"))
BLA_frak2nM_mEPSC <- BLA_frak2nM_mEPSC %>% mutate(Experiment = 'CX3CL1(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_frak2nM_mEPSC$Filename <- as.character(BLA_frak2nM_mEPSC$Filename)
#bad_Cells <- c(1)
#BLA_frak2nM_mEPSC <- BLA_frak2nM_mEPSC %>% filter(!Cell %in% bad_Cells)# filtering 1 - holding current < -100
# BLA_frak5nM_mEPSC <- "mEPSC_BLA_frak5nM_igor.xlsx"
# st_table(BLA_frak5nM_mEPSC)
# BLA_frak5nM_mEPSC <- read_rds("summary_BLA_frak5nM_mEPSC.rds") 
# BLA_azd_mEPSC <- "mEPSC_BLA_azd_igor.xlsx"
# st_table(BLA_azd_mEPSC)
# BLA_azd_mEPSC <- read_rds("summary_BLA_azd_mEPSC.rds") 
BLA_anti_mEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_mEPSC_BLA_antifrak2nM.csv"))
#bad_Cells <- c(2,3) 2 - holding - 300
#BLA_anti_mEPSC <- BLA_anti_mEPSC %>% filter(!Cell %in% bad_Cells) # filtering 2,3 - holding current < -100
BLA_anti_mEPSC <- BLA_anti_mEPSC %>% mutate(Experiment = 'anti-CX3CR1 + \nCX3CL1(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_anti_mEPSC$Filename <- as.character(BLA_anti_mEPSC$Filename)

BLA_mino_mEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_mEPSC_BLA_minofrak2nM.csv"))
BLA_mino_mEPSC <- BLA_mino_mEPSC %>% mutate(Experiment = 'minocycline + \nCX3CL1(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_mino_mEPSC$Filename <- as.character(BLA_mino_mEPSC$Filename)

BLA_mEPSC_final <- BLA_frak2nM_mEPSC %>%  dplyr::bind_rows(BLA_anti_mEPSC) %>% dplyr::bind_rows(BLA_mino_mEPSC) 
BLA_mEPSC_final <- BLA_mEPSC_final %>% dplyr::select(Experiment, Filename, Cell, Condition, everything()) %>% as_tibble()
BLA_mEPSC_final$Condition <- plyr::revalue(BLA_mEPSC_final$Condition, c("b"="baseline", "f" = "CX3CL1"))
BLA_mEPSC_final$Experiment = factor(BLA_mEPSC_final$Experiment, levels=c('CX3CL1(2nM)','anti-CX3CR1 + \nCX3CL1(2nM)','minocycline + \nCX3CL1(2nM)'))
BLA_mEPSC_final$Cell <- rep(1:(nrow(BLA_mEPSC_final)/2), each = 2)

#### BLA mIPSC ####
BLA_frak2nM_mIPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_mIPSC_BLA_frak2nM.csv"))
BLA_frak5nM_mIPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_mIPSC_BLA_frak5nM.csv"))
BLA_anti_mIPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_mIPSC_BLA_antifrak2nM.csv"))

# BLA_mino_mIPSC <- "mIPSC_BLA_mino_igor.xlsx"
# st_table(BLA_mino_mIPSC)
# BLA_mino_mIPSC <- read_rds("summary_BLA_mino_mIPSC.rds") 

BLA_frak2nM_mIPSC <- BLA_frak2nM_mIPSC %>% mutate(Experiment = 'CX3CL1(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_frak2nM_mIPSC$Filename <- as.character(BLA_frak2nM_mIPSC$Filename)
#bad_Cells <- c(4,5) # higher median_Frequency than rest > 5Hz
#BLA_frak2nM_mIPSC <- BLA_frak2nM_mIPSC %>% filter(!Cell %in% bad_Cells)
BLA_frak5nM_mIPSC <- BLA_frak5nM_mIPSC %>%  mutate(Experiment = 'CX3CL1(5nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_frak5nM_mIPSC$Filename <- as.character(BLA_frak5nM_mIPSC$Filename)

#BLA_azd_mIPSC <- BLA_azd_mIPSC %>% mutate(Experiment = 'AZD8797 + \nCX3CL1(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_anti_mIPSC <- BLA_anti_mIPSC %>% mutate(Experiment = 'anti-CX3CR1 + \nCX3CL1(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_anti_mIPSC$Filename <- as.character(BLA_anti_mIPSC$Filename)
#BLA_mino_mIPSC <- BLA_mino_mIPSC %>% mutate(Experiment = 'minocycline + \nCX3CL1(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())


BLA_mIPSC_final <- BLA_frak2nM_mIPSC %>%  dplyr::bind_rows(BLA_frak5nM_mIPSC) %>%  dplyr::bind_rows(BLA_anti_mIPSC)
BLA_mIPSC_final <- BLA_mIPSC_final %>% dplyr::select(Experiment, Filename, Cell, Condition, everything()) %>% as_tibble()
BLA_mIPSC_final$Condition <- plyr::revalue(BLA_mIPSC_final$Condition, c("b"="baseline", "f" = "CX3CL1"))
BLA_mIPSC_final$Experiment = factor(BLA_mIPSC_final$Experiment, levels=c('CX3CL1(2nM)', 'CX3CL1(5nM)','anti-CX3CR1 + \nCX3CL1(2nM)'))
BLA_mIPSC_final$Cell <- rep(1:(nrow(BLA_mIPSC_final)/2), each = 2)

#### BLA interneurons ####

BLA_df_inter <- BLA_frak2nM_inter %>% bind_rows(BLA_frak5nM_inter) %>% bind_rows(BLA_mino_inter)
BLA_df_inter$Experiment <- factor(BLA_df_inter$Experiment)
BLA_df_inter$Cell <- factor(BLA_df_inter$Cell)
temp <- BLA_df_inter %>% filter(Condition == 'baseline') %>% filter(sag_ratio >= 102)
sag_Cells <- temp$Cell
BLA_df_inter_sag <- BLA_df_inter %>% filter(Cell %in% sag_Cells) %>% dplyr::rename(sag_ratio_140 = sag_ratio)
BLA_df_inter$AP_width1_all[[7]] <- 0.53 # changing value from 13 ms.... something wrong with matlab script
BLA_df_inter$AP_width1_all[[8]] <- 0.54 # changing value from 87 ms.... something wrong with matlab script

BLA_frak2nM_sEPSC_inter <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_BLA_frak2nM_inter.csv"))
BLA_frak2nM_sEPSC_inter <- BLA_frak2nM_sEPSC_inter %>% mutate(Experiment = 'CX3CL1(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_frak2nM_sEPSC_inter$Filename <- as.character(BLA_frak2nM_sEPSC_inter$Filename)

BLA_frak5nM_sEPSC_inter <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_BLA_frak5nM_inter.csv"))
BLA_frak5nM_sEPSC_inter <- BLA_frak5nM_sEPSC_inter %>% mutate(Experiment = 'CX3CL1(5nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_frak5nM_sEPSC_inter$Filename <- as.character(BLA_frak5nM_sEPSC_inter$Filename)

BLA_mino_sEPSC_inter <-  as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_BLA_minofrak2nM_inter.csv"))
BLA_mino_sEPSC_inter <- BLA_mino_sEPSC_inter  %>% mutate(Experiment = 'minocycline + \nCX3CL1(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_mino_sEPSC_inter$Filename <- as.character(BLA_mino_sEPSC_inter$Filename)

BLA_sEPSC_final_inter <-  BLA_frak2nM_sEPSC_inter  %>% bind_rows(BLA_frak5nM_sEPSC_inter) %>% bind_rows(BLA_mino_sEPSC_inter)
#BLA_sEPSC_final_inter$Condition <- as.factor(BLA_sEPSC_final_inter$Condition)
BLA_sEPSC_final_inter$Condition <- plyr::revalue(BLA_sEPSC_final_inter$Condition, c("b"="baseline", "f" = "CX3CL1"))

#### LTP ####

pzfx_tables("Amygdala_ltp_stst.pzfx")
bartek_LTP <- read_pzfx("Amygdala_ltp_stst.pzfx", "LTP CTX")
bartek_LTP <- as_tibble(bartek_LTP)
bartek_LTP <- bartek_LTP %>% dplyr::rename("Time" = "Var.1")

# excluding empty column
bartek_LTP1 <- bartek_LTP %>% dplyr::select(-c('naive_12', 'naive_13', 'naive_14', 'naive_15', 'naive_16', 'naive_17', 'naive_18', 'naive_19', 'naive_20', 
 'fra 2nM_11', 'fra 2nM_12', 'fra 2nM_13', 'fra 2nM_14', 'fra 2nM_15', 'fra 2nM_16', 'fra 2nM_17', 'fra 2nM_18', 'fra 2nM_19', 'fra 2nM_20',
 'FRA 2 ADX 10uM_9','FRA 2 ADX 10uM_10','FRA 2 ADX 10uM_11', 'FRA 2 ADX 10uM_12', 'FRA 2 ADX 10uM_13', 'FRA 2 ADX 10uM_14', 'FRA 2 ADX 10uM_15', 'FRA 2 ADX 10uM_16', 'FRA 2 ADX 10uM_17', 'FRA 2 ADX 10uM_18', 'FRA 2 ADX 10uM_19', 'FRA 2 ADX 10uM_20'))

#making plot for LTP for each individual cells
max_col <- 2:ncol(bartek_LTP1) # vector for each cell (-Time)
bartek_LTP1_long <- gather(bartek_LTP1, condition, Amplitude, 2:ncol(bartek_LTP1),factor_key=TRUE)
bartek_LTP1_long <- bartek_LTP1_long %>% drop_na()
LTP_for_each_cell <- bartek_LTP1_long %>% ggplot(aes(x = Time, y = Amplitude)) + geom_line() + facet_wrap(. ~ condition)

#based on plot - excluded naive_3, naive_4, naive_9, frak2nM_3, 
bartek_LTP1_exc <- bartek_LTP1 %>% dplyr::select(-c('naive_3',  'naive_4', 'naive_9', 'fra 2nM_3', 'FRA 2 ADX 10uM_5' ,'FRA 2 ADX 10uM_7'))
bartek_LTP1_exc <- gather(bartek_LTP1_exc, condition, Amplitude, 2:ncol(bartek_LTP1_exc),factor_key=TRUE)
bartek_LTP1_exc <- bartek_LTP1_exc %>% drop_na()
bartek_LTP3 <- bartek_LTP1_exc %>% dplyr::select(Time, condition, Amplitude) %>% separate(condition, c("Condition", "Slice"), "_") 
bartek_LTP3$Time <- as.factor(bartek_LTP3$Time)
bartek_LTP3$Condition <- as.factor(bartek_LTP3$Condition)
bartek_LTP3$Slice <- as.factor(bartek_LTP3$Slice)
df_basic <- Rmisc::summarySE(bartek_LTP3 , measurevar="Amplitude", groupvars=c("Condition","Time"))
df_basic <- as_tibble(df_basic)
df_basic$Condition <- plyr::revalue(df_basic$Condition, c("naive" = "baseline","FRA 2 ADX 10uM"="AZD8797 + \nCX3CL1(2nM)", "fra 2nM" = "CX3CL1(2nM)"))
df_basic$Time <-as.numeric(levels(df_basic$Time))[df_basic$Time]
df_basic$Condition <- factor(df_basic$Condition, levels = c("baseline", "CX3CL1(2nM)", "AZD8797 + \nCX3CL1(2nM)"))

LTP_bartek_strict <- df_basic %>% ggplot(aes(x = Time, y= Amplitude, fill = Condition)) +
  geom_errorbar(aes(ymin=Amplitude-se, ymax=Amplitude+se), width=0.5)+
  geom_point(size = 4, pch = 21, alpha = 0.7) +
  #geom_line() +
  ylab("Amplitude (%)") +
  xlab("Time (min)") +
  scale_fill_aaas() +
  theme_classic() +
  geom_hline(yintercept = 100, lty = 'dashed') +
  xlim(-15, 70) +
  ylim(60, 160) +
  ggtitle("LTP AMYGDALA") 

bartek_LTP$Time <- as.factor(bartek_LTP$Time)

#bartek_LTP1 <- bartek_LTP %>% dplyr::select(-c(naive_12, naive_13, naive_14, naive_15, naive_16, naive_17, naive_18, naive_19, naive_20))

# all slices - LTP plot
bartek_LTP<- gather(bartek_LTP, condition, Amplitude, naive_1:"FRA 2 ADX 10uM_8",factor_key=TRUE)
bartek_LTP2 <- bartek_LTP %>% dplyr::select(Time, condition, Amplitude) %>% separate(condition, c("Condition", "Slice"), "_") #str_split_fixed(bartek_LTP2$condition, "_", 2)
bartek_LTP2 <- drop_na(bartek_LTP2)
bartek_LTP2$Time <- as.factor(bartek_LTP2$Time)
bartek_LTP2$Condition <- as.factor(bartek_LTP2$Condition)
bartek_LTP2$Slice <- as.factor(bartek_LTP2$Slice)
df_basic <- Rmisc::summarySE(bartek_LTP2 , measurevar="Amplitude", groupvars=c("Condition","Time"))
df_basic <- as_tibble(df_basic)
df_basic$Condition <- plyr::revalue(df_basic$Condition, c("naive" = "baseline","FRA 2 ADX 10uM"="AZD8797 + \nCX3CL1(2nM)", "fra 2nM" = "CX3CL1(2nM)"))
df_basic$Time <-as.numeric(levels(df_basic$Time))[df_basic$Time]
df_basic$Condition <- factor(df_basic$Condition, levels = c("baseline", "CX3CL1(2nM)", "AZD8797 + \nCX3CL1(2nM)"))

LTP_bartek <- df_basic %>% ggplot(aes(x = Time, y= Amplitude, fill = Condition)) +
  geom_errorbar(aes(ymin=Amplitude-se, ymax=Amplitude+se), width=0.5)+
  geom_point(size = 4, pch = 21, alpha = 0.7) +
  #geom_line() +
  ylab("Amplitude (%)") +
  xlab("Time (min)") +
  scale_fill_aaas() +
  theme_classic() +
  geom_hline(yintercept = 100, lty = 'dashed') +
  xlim(-15, 70) +
  ylim(60, 160)
#  ggtitle("LTP AMYGDALA") 

LTP_bartek <- LTP_bartek + geom_segment((aes(y = 132, x = 62, yend = 107, xend = 62))) + geom_segment((aes(y = 132, x = 66, yend = 120, xend = 66))) + geom_segment((aes(y = 132, x = 61, yend = 132, xend = 62))) + geom_segment((aes(y = 132, x = 65, yend = 132, xend = 66))) + geom_segment((aes(y = 107, x = 61, yend = 107, xend = 62))) + geom_segment((aes(y = 120, x = 65, yend = 120, xend = 66))) + annotate("text", x = 63, y = 120, label = "*") + annotate("text", x = 67, y = 126, label = "*") 

# IV field potential 
bartek_IV <- read_pzfx("Amygdala_ltp_stst.pzfx", "Iv CTX") 
bartek_IV <- as_tibble(bartek_IV)
bartek_IV <- bartek_IV %>% dplyr::rename("Stim" = "Var.1")
bartek_IV$Stim <- as.factor(bartek_IV$Stim)
bartek_IV2<- gather(bartek_IV, condition, Amplitude, "control _1":"ADX10 FRX2_20",factor_key=TRUE)
bartek_IV2$condition <- gsub( " ", "", bartek_IV2$condition)

#making plot for LTP for each individual cells
bartek_IV1_long <- gather(bartek_IV, condition, Amplitude, 2:ncol(bartek_IV),factor_key=TRUE)
bartek_IV1_long <- bartek_IV1_long %>% drop_na()
IV_for_each_cell <- bartek_IV1_long %>% ggplot(aes(x = as.numeric(Stim), y = Amplitude)) + geom_line() + facet_wrap(. ~ condition)

bartek_IV2 <- bartek_IV2 %>% dplyr::select(Stim, condition, Amplitude) %>% separate(condition, c("Condition", "Slice"), "_") #str_split_fixed(bartek_IV2$condition, "_", 2)
bartek_IV2 <- drop_na(bartek_IV2)
bartek_IV2$Stim <- as.factor(bartek_IV2$Stim)
bartek_IV2$Condition <- as.factor(bartek_IV2$Condition)
bartek_IV2$Slice <- as.factor(bartek_IV2$Slice)
bartek_IV2aa<- bartek_IV2 %>% dplyr::filter(Condition == 'control') %>% dplyr::mutate(Experiment = 'baseline')
bartek_IV2a<- bartek_IV2 %>% dplyr::filter(Condition == 'fraccontrol' | Condition =='frac2nM') %>% dplyr::mutate(Experiment = 'CX3CL1')
bartek_IV2b<- bartek_IV2 %>% dplyr::filter(Condition == 'ADXFRXcon' | Condition =='ADX10FRX2') %>% dplyr::mutate(Experiment = 'AZD8797 + \nCX3CL1')
bartek_IV2c<- bartek_IV2 %>% dplyr::filter(Condition == 'ADX10uM' | Condition =='ADXcontrol') %>% dplyr::mutate(Experiment = 'AZD8797')

bartek_IV2$Condition <- plyr::revalue(bartek_IV2$Condition, c("ADXcontrol"="baseline", "fraccontrol" = "baseline", "ADXFRXcon" = "baseline", "ADX10uM" = "AZD8797", "frac2nM" = "CX3CL1(2nM)", "ADX10FRX2" = "AZD8797 + \nCX3CL1(2nM)", "control" = "baseline"))
df_basic <- Rmisc::summarySE(bartek_IV2 , measurevar="Amplitude", groupvars=c("Condition","Stim")) # "Experiment"
df_basic <- as_tibble(df_basic)
df_basic$Stim <-as.numeric(levels(df_basic$Stim))[df_basic$Stim]
df_basic$Condition <- factor(df_basic$Condition, levels = c("baseline",  "CX3CL1(2nM)", "AZD8797 + \nCX3CL1(2nM)", "AZD8797"))
#df_basic$Experiment <- factor(df_basic$Experiment, levels = c("control", "CX3CL1(2nM)", "AZD8797 + \nCX3CL1(2nM)",  "AZD8797"))

bartek_IV99 <- bartek_IV2a %>% dplyr::bind_rows(bartek_IV2b) %>% dplyr::bind_rows(bartek_IV2c)
bartek_IV99$Condition <- plyr::revalue(bartek_IV99$Condition, c("ADXcontrol"="baseline", "fraccontrol" = "baseline", "ADXFRXcon" = "baseline", "ADX10uM" = "AZD8797", "frac2nM" = "CX3CL1(2nM)", "ADX10FRX2" = "AZD8797 + \nCX3CL1(2nM)", "control" = "baseline"))
df_basic99 <- Rmisc::summarySE(bartek_IV99 , measurevar="Amplitude", groupvars=c("Condition","Stim", "Experiment")) # "Experiment"
df_basic99 <- df_basic99 %>% dplyr::select(Experiment, Condition, Stim, everything()) %>% arrange(Experiment, Condition, Stim)
df_basic99 <- df_basic99 %>% drop_na()
df_basic99 <- as_tibble(df_basic99)
df_basic99$Stim <-as.numeric(levels(df_basic99$Stim))[df_basic99$Stim]
df_basic99$Condition <- factor(df_basic99$Condition, levels = c("baseline",  "CX3CL1(2nM)", "AZD8797 + \nCX3CL1(2nM)", "AZD8797"))
df_basic99$Experiment <- as.factor(df_basic99$Experiment)
#df_basic99$Experiment <- factor(df_basic99$Experiment, levels = c("CX3CL1(2nM)", "AZD8797 + \nCX3CL1(2nM)", "AZD8797"))


IV_bartek <- df_basic %>% group_by(Condition) %>% ggplot(aes(x = Stim, y= Amplitude, fill = Condition)) +
  geom_errorbar(aes(ymin=Amplitude-se, ymax=Amplitude+se), width=0.5)+
  geom_point(size = 4, pch = 21, alpha = 0.7) +
  #geom_line() +
  ylab("Amplitude (mV)") +
  xlab("Stimulus Strength (uA)") +
  scale_fill_aaas() +
  theme_classic() 
#  ggtitle("Field potentials - \na stimulus–response curve")

IV_bartek_99 <- df_basic99 %>% group_by(Condition) %>% ggplot(aes(x = Stim, y= Amplitude, fill = Condition)) +
  geom_errorbar(aes(ymin=Amplitude-se, ymax=Amplitude+se), width=0.5)+
  geom_point(size = 4, pch = 21, alpha = 0.7) +
  #geom_line() +
  ylab("Amplitude (mV)") +
  xlab("Stimulus Strength (uA)") +
  scale_fill_aaas() +
  theme_classic()  +
  facet_wrap(. ~ Experiment)


bartek_pp <- read_pzfx("Amygdala_ltp_stst.pzfx", "pp CTX")
bartek_pp <- as_tibble(bartek_pp)
bartek_pp <- bartek_pp %>% mutate(ID = 1:nrow(bartek_pp))
bartek_pp2<- gather(bartek_pp, condition, val, "naive pre":"ADX 10 FRC 2 post",factor_key=TRUE, -ID)
bartek_pp2 <- drop_na(bartek_pp2)
bartek_pp2$condition <- gsub(" pre", "_pre", bartek_pp2$condition)
bartek_pp2$condition <- gsub(" post", "_post", bartek_pp2$condition)
bartek_pp2 <- bartek_pp2 %>% separate(condition, c("Condition", "Ratio"), "_") #str_split_fixed(bartek_pp2$condition, "_", 2)
bartek_pp2$Condition <- as.factor(bartek_pp2$Condition)

bartek_pp2aa<- bartek_pp2 %>% dplyr::filter(Condition == 'naive') %>% dplyr::mutate(Experiment = 'control')
bartek_pp2a<- bartek_pp2 %>% dplyr::filter(Condition == 'fra con' | Condition =='fra 2nM') %>% dplyr::mutate(Experiment = 'CX3CL1')
bartek_pp2b<- bartek_pp2 %>% dplyr::filter(Condition == 'ADX 10 FRC 2' | Condition =='ADX FRC control') %>% dplyr::mutate(Experiment = 'AZD8797 + \nCX3CL1')
bartek_pp2c<- bartek_pp2 %>% dplyr::filter(Condition == 'adx 10uM' | Condition =='ADX 10um' | Condition == 'adx control') %>% dplyr::mutate(Experiment = 'AZD8797')
bartek_pp99 <- bartek_pp2a %>% dplyr::bind_rows(bartek_pp2b) %>% dplyr::bind_rows(bartek_pp2c)

bartek_pp99$Condition <- plyr::revalue(bartek_pp99$Condition, c("naive"="baseline","ADX 10 FRC 2"="AZD8797 + \nCX3CL1(2nM)", "adx 10uM" = "AZD8797", "ADX 10um" = "AZD8797" ,"fra con" = "baseline", "adx control" = "baseline",  "fra 2nM" = "CX3CL1(2nM)", "ADX FRC control" = "baseline"))
bartek_pp99$Condition <- factor(bartek_pp99$Condition, levels = c("baseline", "CX3CL1(2nM)", "AZD8797 + \nCX3CL1(2nM)",  "AZD8797"))
#bartek_pp99$Experiment <- factor(bartek_pp99$Experiment, levels = c("control", "CX3CL1(2nM)", "AZD8797 + \nCX3CL1(2nM)",  "AZD8797"))
bartek_pp991 <- bartek_pp99 %>% arrange(ID, Condition) %>% mutate(Slice = rep(1:(nrow(bartek_pp99)/2), each = 2)) %>% dplyr::select(-ID)
bartek_pp991 <- bartek_pp991 %>% dplyr::select(Condition, Slice, everything())
bartek_pp991$Ratio <- factor(bartek_pp991$Ratio, levels = c("pre", "post"))
bartek_pp992 <- bartek_pp991 %>% tidyr::spread(Ratio, val)
bartek_pp993 <- bartek_pp992 %>% mutate(Ratio = (post/pre)*100)
bartek_pp993 <- bartek_pp993 %>% dplyr::select(Experiment, Condition, Slice, pre, post, everything()) %>% arrange(Experiment, Condition, Slice)
bartek_pp993$Experiment <- as.factor(bartek_pp993$Experiment)
bartek_pp993$Condition <- as.factor(bartek_pp993$Experiment)

bartek_pp2$Condition <- plyr::revalue(bartek_pp2$Condition, c("naive"="baseline","ADX 10 FRC 2"="AZD8797 + \nCX3CL1(2nM)", "adx 10uM" = "AZD8797", "ADX 10um" = "AZD8797" ,"fra con" = "baseline", "adx control" = "baseline",  "fra 2nM" = "CX3CL1(2nM)", "ADX FRC control" = "baseline"))
bartek_pp2$Condition <- factor(bartek_pp2$Condition, levels = c("baseline", "CX3CL1(2nM)", "AZD8797 + \nCX3CL1(2nM)",  "AZD8797"))
#bartek_pp2$Experiment <- factor(bartek_pp2$Experiment, levels = c("control", "CX3CL1(2nM)", "AZD8797 + \nCX3CL1(2nM)",  "AZD8797"))
bartek_pp3 <- bartek_pp2 %>% arrange(ID, Condition) %>% mutate(Slice = rep(1:(nrow(bartek_pp2)/2), each = 2)) %>% dplyr::select(-ID)
bartek_pp3 <- bartek_pp3 %>% dplyr::select(Condition, Slice, everything())
bartek_pp3$Ratio <- factor(bartek_pp3$Ratio, levels = c("pre", "post"))
bartek_pp4 <- bartek_pp3 %>% tidyr::spread(Ratio, val)
bartek_pp5 <- bartek_pp4 %>% mutate(Ratio = (post/pre)*100)

pp_bartek_1 <- bartek_pp5 %>% ggplot(aes(x = Condition, y = Ratio, color = Condition)) +
  geom_boxplot(width = 0.5) +
  geom_jitter(size = 4, alpha = 0.7, width = 0.1, height = 0) +
  ylab("Paired-pulse ratio (%)") +
  ylim(90,140) +
  scale_color_aaas() +
  theme_classic() +
 # ggtitle('Paired-pulse ratio') +
  geom_hline(yintercept = 100, lty = 'dashed') 

pp_bartek_99 <- bartek_pp993 %>% ggplot(aes(x = Condition, y = Ratio, color = Condition)) +
  geom_boxplot(width = 0.5) +
  geom_jitter(size = 4, alpha = 0.7, width = 0.1, height = 0) +
  ylab("Paired-pulse ratio (%)") +
  ylim(90,140) +
  scale_color_aaas() +
  theme_classic() +
 # ggtitle('Paired-pulse ratio') +
  geom_hline(yintercept = 100, lty = 'dashed') +
  facet_wrap(. ~ Experiment)


pp_bartek_2 <- bartek_pp3 %>% ggplot(aes(x = Ratio, y = val, color = Ratio)) +
  geom_boxplot(width = 0.5) +
  geom_point(size = 2, alpha = 0.7) +
  geom_line(aes(group = Slice), alpha =0.5) +
  ylab("Amplitude (mV)") +
  scale_color_aaas() +
  theme_classic() +
#  ggtitle('Paired-pulses') +
  facet_wrap(~ Condition, ncol = 4)

```


```{r setup cxcl12, include=FALSE}
library(here)
library(elektroasia)


setwd("..")
setwd("..")
setwd(".//CXCL12")

####BLA CXCL12 2nM############################################################
BLA_df_cxcl12_2nM<-readRDS(".//BLA//2nM//membrane_table_BLA_cxcl12_2nM.rds")
BLA_df_cxcl12_2nM$Cell <- as.factor(BLA_df_cxcl12_2nM$Cell)
BLA_df_cxcl12_2nM$Condition <- as.factor(BLA_df_cxcl12_2nM$Condition)

bad_Cells <- c(15,9,10,1, 7) #15 - input restistance > 250, 9,10 - Cm > 300, 1- RMS > -50; 7- IV
BLA_df_cxcl12_2nM <- BLA_df_cxcl12_2nM %>% filter(!Cell %in% bad_Cells) 

BLA_df_cxcl12_2nM <- BLA_df_cxcl12_2nM %>% mutate(Experiment = "CXCL12(2nM)") %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, everything())
BLA_df_cxcl12_2nM_inter <- BLA_df_cxcl12_2nM %>% filter(Type == "interneuron")
BLA_df_cxcl12_2nM <- BLA_df_cxcl12_2nM %>% filter(Type == "PC")


####BLA CXCL12 5nM############################################################
BLA_df_cxcl12_5nM<-readRDS(".//BLA//5nM//membrane_table_BLA_cxcl12_5nM.rds")
BLA_df_cxcl12_5nM$Cell <- as.factor(BLA_df_cxcl12_5nM$Cell)
BLA_df_cxcl12_5nM$Condition <- as.factor(BLA_df_cxcl12_5nM$Condition)
BLA_df_cxcl12_5nM <- BLA_df_cxcl12_5nM %>% mutate(Experiment = "CXCL12(5nM)") %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, everything())
bad_Cells <- c(4, 10, 14, 12) # Rm - 478 -> 268 ; 10 - 20d14002 - only 1 spike after application; IV- 14
BLA_df_cxcl12_5nM <- BLA_df_cxcl12_5nM %>% filter(!Cell %in% bad_Cells)

BLA_df_cxcl12_5nM_inter <- BLA_df_cxcl12_5nM %>% filter(Type == "interneuron")
BLA_df_cxcl12_5nM <- BLA_df_cxcl12_5nM %>% filter(Type == "PC")

##### CeA cxcl12 2nM###############
CeA_df_cxcl12_2nM<-readRDS(".//CeA//2nM//membrane_table_CeA_cxcl12_2nM.rds")
CeA_df_cxcl12_2nM <- CeA_df_cxcl12_2nM %>% mutate(Experiment = 'CXCL12(2nM)') %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, Type , everything())
bad_Cells <- c(17, 4, 8, 11, 19, 15) #  17 sEPSC - RS - przymyka się cały czas, 4 - RS - bardzo późno zaczęła spike'ować, 8 LF - dziwny IV. 11 - RS - dziwny IV i bardzo malo sEPSC, 19 -iv
CeA_df_cxcl12_2nM <- CeA_df_cxcl12_2nM %>% filter(!Cell %in% bad_Cells)

##### CeA cxcl12 5nM###############
CeA_df_cxcl12_5nM<-readRDS(".//CeA//5nM//membrane_table_CeA_cxcl12_5nM.rds")
CeA_df_cxcl12_5nM <- CeA_df_cxcl12_5nM %>% mutate(Experiment = 'CXCL12(5nM)') %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, Type , everything())
bad_Cells <- c(2, 10, 3, 9, 1, 15, 7, 8, 23, 17, 18) # Adaptation ratio - NA :( , 3 - poszarpana po podaniu (sEPSC), 9 - LF- based on IV -sEPSC absent 1, 15, 7 -> RS based on IV. sEPSC, 8 - LF - Rm 600 -> 200, 21325036 - IV po podaniu; 21223024 - IV, 21223045 - IV
CeA_df_cxcl12_5nM <- CeA_df_cxcl12_5nM %>% filter(!Cell %in% bad_Cells)


##### CeA AMD + cxcl12 5nM###############
CeA_amd5nM_df <-readRDS(".//CeA//AMD//blocking5nM//membrane_table_CeA_AMD_CXCL12_5nM.rds") # 
CeA_amd5nM_df <- CeA_amd5nM_df %>% mutate(Experiment = "AMD3100 + \nCXCL12(5nM)") %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, Type , everything()) %>% dplyr::rename(sag_ratio_140 = sag_ratio)
bad_Cells <- c(8, 9)
CeA_amd5nM_df <- CeA_amd5nM_df %>% filter(!Cell %in% bad_Cells)

##### CeA AMD alone ###############
CeA_amda_df <-readRDS(".//CeA//AMD//alone//membrane_table_CeA_AMD_alone.rds") # 
bad_Cells <- c(3)
CeA_amda_df <- CeA_amda_df %>% dplyr::filter(!Cell %in% bad_Cells)
CeA_amda_df <- CeA_amda_df %>% mutate(Experiment = "AMD3100") %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, Type, everything()) %>% dplyr::rename(sag_ratio_140 = sag_ratio)
CeA_amda_df$Condition <-  plyr::revalue(CeA_amda_df$Condition,  c("AMD"="AMD3100"))
CeA_amda_df$Condition <- factor(CeA_amda_df$Condition, levels = c("baseline", "AMD3100"))
CeA_amda_df <- CeA_amda_df %>% dplyr::arrange(Experiment, Cell, Condition)

##### CeA fluoro + cxcl12 5nM###############
CeA_df_fluoro <-readRDS(".//CeA//fluorocitrate//membrane_table_CeA_fluoro_cxcl12_5nM.rds") # 
CeA_df_fluoro <- CeA_df_fluoro %>% mutate(Experiment = "fluorocitrate + \nCXCL12(5nM)") %>% dplyr::select(Experiment, Filename_all1, Cell, Condition, Type, everything()) %>% dplyr::rename(sag_ratio_140 = sag_ratio)
#bad_Cells <- c(1)
#CeA_df_fluoro <- CeA_df_fluoro  %>% filter(!Cell %in% bad_Cells)
#####BLA sEPSC cxcl12 2nM###############
BLA_cxcl12_2nM_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_BLA_cxcl12_2nM.csv"))
BLA_cxcl12_2nM_sEPSC$Condition <- plyr::revalue(BLA_cxcl12_2nM_sEPSC$Condition, c("b"="baseline", "f" = "CXCL12"))

BLA_cxcl12_2nM_sEPSC<- BLA_cxcl12_2nM_sEPSC %>% dplyr::mutate(Experiment = 'CXCL12(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_cxcl12_2nM_sEPSC$Filename <- as.character(BLA_cxcl12_2nM_sEPSC$Filename)
#bad_Cells <- c(4, 6) # Frequency 10 -> 30Hz., 17518039 - w IV wygląda spoko, zanalizować jeszcze raz. #6 - 20123016 po IV, który miał 2 spikei i w sEPSC też mało eventów (100). 
#BLA_cxcl12_2nM_sEPSC <- BLA_cxcl12_2nM_sEPSC %>% filter(!Cell %in% bad_Cells)

#####BLA sEPSC cxcl12 5nM###############
BLA_cxcl12_5nM_sEPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_BLA_cxcl12_5nM.csv"))
BLA_cxcl12_5nM_sEPSC$Condition <- plyr::revalue(BLA_cxcl12_5nM_sEPSC$Condition, c("b"="baseline", "f" = "CXCL12"))

BLA_cxcl12_5nM_sEPSC<- BLA_cxcl12_5nM_sEPSC %>% dplyr::mutate(Experiment = 'CXCL12(5nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_cxcl12_5nM_sEPSC$Filename <- as.character(BLA_cxcl12_5nM_sEPSC$Filename)
#bad_Cells <- c(3, 6) # based on Rm - 20930023-26 > 500,  6- 20d14002 - based on IV
#BLA_cxcl12_5nM_sEPSC <- BLA_cxcl12_5nM_sEPSC %>% filter(!Cell %in% bad_Cells)
BLA_cxcl12_5nM_sEPSC<- BLA_cxcl12_5nM_sEPSC %>% dplyr::mutate(Experiment = 'CXCL12(5nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_cxcl12_5nM_sEPSC$Filename <- as.character(BLA_cxcl12_5nM_sEPSC$Filename)

#####BLA sIPSC cxcl12 2nM###############
BLA_cxcl12_2nM_sIPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_BLA_cxcl12_2nM.csv"))
BLA_cxcl12_2nM_sIPSC$Condition <- plyr::revalue(BLA_cxcl12_2nM_sIPSC$Condition, c("b"="baseline", "f" = "CXCL12"))
BLA_cxcl12_2nM_sIPSC$Filename <- as.character(BLA_cxcl12_2nM_sIPSC$Filename)

BLA_cxcl12_2nM_sIPSC<- BLA_cxcl12_2nM_sIPSC %>% dplyr::mutate(Experiment = 'CXCL12(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())

#####BLA sIPSC cxcl12 5nM###############
BLA_cxcl12_5nM_sIPSC <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_BLA_cxcl12_5nM.csv"))
BLA_cxcl12_5nM_sIPSC$Condition <- plyr::revalue(BLA_cxcl12_5nM_sIPSC$Condition, c("b"="baseline", "f" = "CXCL12"))
BLA_cxcl12_5nM_sIPSC$Filename <- as.character(BLA_cxcl12_5nM_sIPSC$Filename)

BLA_cxcl12_5nM_sIPSC<- BLA_cxcl12_5nM_sIPSC %>% dplyr::mutate(Experiment = 'CXCL12(5nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())

#####CeA sEPSC cxcl12 2nM###############
CeA_sEPSC_cxcl12_2nM_RS <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_RS_cxcl12_2nM.csv")) 
CeA_sEPSC_cxcl12_2nM_RS <- CeA_sEPSC_cxcl12_2nM_RS %>% mutate(Type ='RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_sEPSC_cxcl12_2nM_RS$Filename <- as.character(CeA_sEPSC_cxcl12_2nM_RS$Filename)

CeA_sEPSC_cxcl12_2nM_LF <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_LF_cxcl12_2nM.csv")) 
CeA_sEPSC_cxcl12_2nM_LF <- CeA_sEPSC_cxcl12_2nM_LF %>% mutate(Type ='LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_sEPSC_cxcl12_2nM_LF$Filename <- as.character(CeA_sEPSC_cxcl12_2nM_LF$Filename)

CeA_sEPSC_cxcl12_2nM <- CeA_sEPSC_cxcl12_2nM_RS %>% bind_rows(CeA_sEPSC_cxcl12_2nM_LF) %>% dplyr::mutate(Experiment = "CXCL12(2nM)") %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
#bad_Cells <- c(2) # IV bardzo późno zaczęła. 
#CeA_sEPSC_cxcl12_2nM <- CeA_sEPSC_cxcl12_2nM %>% filter(!Cell %in% bad_Cells)
CeA_sEPSC_cxcl12_2nM$Condition <- plyr::revalue(CeA_sEPSC_cxcl12_2nM$Condition, c("b"="baseline", "f" = "CXCL12"))

#####CeA sEPSC cxcl12 5nM###############
CeA_sEPSC_cxcl12_5nM_RS <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_RS_cxcl12_5nM.csv")) 
CeA_sEPSC_cxcl12_5nM_RS <- CeA_sEPSC_cxcl12_5nM_RS %>% mutate(Type ='RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_sEPSC_cxcl12_5nM_RS$Filename <- as.character(CeA_sEPSC_cxcl12_5nM_RS$Filename)

CeA_sEPSC_cxcl12_5nM_LF <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_LF_cxcl12_5nM.csv")) 
CeA_sEPSC_cxcl12_5nM_LF <- CeA_sEPSC_cxcl12_5nM_LF %>% mutate(Type ='LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_sEPSC_cxcl12_5nM_LF$Filename <- as.character(CeA_sEPSC_cxcl12_5nM_LF$Filename)
bad_Cells <- c(1,3,4,5,9) #quality control:(
CeA_sEPSC_cxcl12_5nM_LF <- CeA_sEPSC_cxcl12_5nM_LF %>% filter(!Cell %in% bad_Cells)

CeA_sEPSC_cxcl12_5nM <- CeA_sEPSC_cxcl12_5nM_RS %>% bind_rows(CeA_sEPSC_cxcl12_5nM_LF) %>% mutate(Experiment = "CXCL12(5nM)")  %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
CeA_sEPSC_cxcl12_5nM$Condition <- plyr::revalue(CeA_sEPSC_cxcl12_5nM$Condition, c("b"="baseline", "f" = "CXCL12"))
#bad_Cells <- c(1,2,4) #20929007, 20d14o26, 20o02022 - RS - based on IV
#CeA_sEPSC_cxcl12_5nM <- CeA_sEPSC_cxcl12_5nM %>% filter(!Cell %in% bad_Cells)

#####CeA sEPSC amd + cxcl12 5nM###############
CeA_amd5nM_sEPSC_RS <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_RS_amdcxcl12_5nM.csv"))
CeA_amd5nM_sEPSC_RS <- CeA_amd5nM_sEPSC_RS %>% mutate(Type ='RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_amd5nM_sEPSC_RS$Filename <- as.character(CeA_amd5nM_sEPSC_RS$Filename)
CeA_amd5nM_sEPSC_LF <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_LF_amdcxcl12_5nM.csv"))
CeA_amd5nM_sEPSC_LF <- CeA_amd5nM_sEPSC_LF %>% mutate(Type ='LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_amd5nM_sEPSC_LF$Filename <- as.character(CeA_amd5nM_sEPSC_LF$Filename)
bad_Cells <- c(5) # IV - 20d22029
CeA_amd5nM_sEPSC_LF <- CeA_amd5nM_sEPSC_LF %>% filter(!Cell %in% bad_Cells)

CeA_amd5nM_sEPSC<- CeA_amd5nM_sEPSC_RS %>% bind_rows(CeA_amd5nM_sEPSC_LF) %>% dplyr::mutate(Experiment = "AMD3100 + \nCXCL12(5nM)") %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
CeA_amd5nM_sEPSC$Condition <- plyr::revalue(CeA_amd5nM_sEPSC$Condition, c("b"="baseline", "f" = "CXCL12"))

#####CeA sEPSC fluro + cxcl12 5nM###############
#CeA_fluoro_sEPSC_RS <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_RS_fluoro_cxcl12_5nM.csv"))
#CeA_fluoro_sEPSC_RS <- CeA_fluoro_sEPSC_RS %>% mutate(Type ='RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
#CeA_fluoro_sEPSC_RS$Filename <- as.character(CeA_fluoro_sEPSC_RS$Filename)
CeA_fluoro_sEPSC_LF <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_LF_fluoro_cxcl12_5nM.csv"))
CeA_fluoro_sEPSC_LF <- CeA_fluoro_sEPSC_LF %>% mutate(Type ='LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
#CeA_fluoro_sEPSC_LF$Filename <- as.character(CeA_fluoro_sEPSC_LF$Filename)
#bad_Cells <- c(7) # IV - 20d22029
#CeA_fluoro_sEPSC_LF <- CeA_fluoro_sEPSC_LF %>% filter(!Cell %in% bad_Cells)

CeA_sEPSC_fluoro <-CeA_fluoro_sEPSC_LF %>% dplyr::mutate(Experiment = "fluorocitrate + \nCXCL12(5nM)") %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
CeA_sEPSC_fluoro$Filename <- as.character(CeA_sEPSC_fluoro$Filename)
#CeA_fluoro_sEPSC<- CeA_fluoro_sEPSC_RS %>% bind_rows(CeA_fluoro_sEPSC_LF) %>% dplyr::mutate(Experiment = "AMD3100 + \nCXCL12(5nM)") %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
CeA_sEPSC_fluoro$Condition <- plyr::revalue(CeA_sEPSC_fluoro$Condition, c("b"="baseline", "f" = "CXCL12"))


#####CeA sEPSC amda###############
CeA_amda_sEPSC_RS <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_RS_amda.csv"))
CeA_amda_sEPSC_RS <- CeA_amda_sEPSC_RS  %>% mutate(Type ='RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_amda_sEPSC_RS$Filename <- as.character(CeA_amda_sEPSC_RS$Filename)


CeA_amda_sEPSC_LF <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_CeA_LF_amda.csv"))
CeA_amda_sEPSC_LF <- CeA_amda_sEPSC_LF  %>% mutate(Type ='LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_amda_sEPSC_LF$Filename <- as.character(CeA_amda_sEPSC_LF$Filename)
bad_Cells <- c(2)
CeA_amda_sEPSC_LF <- CeA_amda_sEPSC_LF %>% dplyr::filter(!Cell %in% bad_Cells)

CeA_amda_sEPSC<- CeA_amda_sEPSC_RS %>% bind_rows(CeA_amda_sEPSC_LF) %>% dplyr::mutate(Experiment = "AMD3100") %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
CeA_amda_sEPSC$Condition <- plyr::revalue(CeA_amda_sEPSC$Condition, c("b"="baseline", "f" = "AMD3100"))
CeA_amda_sEPSC$Condition <- factor(CeA_amda_sEPSC$Condition, levels = c("baseline", "AMD3100"))
CeA_amda_sEPSC$Cell <- as.numeric(CeA_amda_sEPSC$Cell)

#####CeA sIPSC amda###############
CeA_sIPSC_amda_RS <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_RS_amda.csv"))
CeA_sIPSC_amda_RS <- CeA_sIPSC_amda_RS %>% mutate(Type ='RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
bad_Cells <- c(1)
CeA_sIPSC_amda_RS <- CeA_sIPSC_amda_RS %>% filter(!Cell %in% bad_Cells)
CeA_sIPSC_amda_LF <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_LF_amda.csv"))
CeA_sIPSC_amda_LF <- CeA_sIPSC_amda_LF %>% mutate(Type ='LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())

CeA_sIPSC_amda<- CeA_sIPSC_amda_RS %>% bind_rows(CeA_sIPSC_amda_LF) %>% dplyr::mutate(Experiment = "AMD3100") %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
CeA_sIPSC_amda$Condition <- plyr::revalue(CeA_sIPSC_amda$Condition, c("b"="baseline", "f" = "AMD3100"))
CeA_sIPSC_amda$Filename <- as.character(CeA_sIPSC_amda$Filename)

#####CeA sIPSC cxcl12 2nM###############
CeA_sIPSC_cxcl12_2nM_RS <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_RS_cxcl12_2nM_2.csv"))
CeA_sIPSC_cxcl12_2nM_RS <- CeA_sIPSC_cxcl12_2nM_RS %>% mutate(Type ='RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
bad_Cells <- c(4,6,8,10)
CeA_sIPSC_cxcl12_2nM_RS <- CeA_sIPSC_cxcl12_2nM_RS %>% dplyr::filter(!Cell %in% bad_Cells)
CeA_sIPSC_cxcl12_2nM_LF <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_LF_cxcl12_2nM.csv"))
CeA_sIPSC_cxcl12_2nM_LF <- CeA_sIPSC_cxcl12_2nM_LF %>% mutate(Type ='LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_sIPSC_cxcl12_2nM <- CeA_sIPSC_cxcl12_2nM_RS %>% bind_rows(CeA_sIPSC_cxcl12_2nM_LF) %>% mutate(Experiment = "CXCL12(2nM)") %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())

CeA_sIPSC_cxcl12_2nM$Condition <- plyr::revalue(CeA_sIPSC_cxcl12_2nM$Condition, c("b"="baseline", "f" = "CXCL12"))
CeA_sIPSC_cxcl12_2nM$Filename <- as.character(CeA_sIPSC_cxcl12_2nM$Filename)

#####CeA sIPSC cxcl12 5nM###############
CeA_sIPSC_cxcl12_5nM_RS <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_RS_cxcl12_5nM_2.csv"))
CeA_sIPSC_cxcl12_5nM_RS <- CeA_sIPSC_cxcl12_5nM_RS %>% mutate(Type ='RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
bad_Cells <- c(2, 10)
wrong_cell_2 <- c(10)
CeA_sIPSC_lostcell2 <- CeA_sIPSC_cxcl12_5nM_RS %>% dplyr::filter(Cell %in% wrong_cell_2)
CeA_sIPSC_cxcl12_5nM_RS <- CeA_sIPSC_cxcl12_5nM_RS %>% filter(!Cell %in% bad_Cells)

CeA_sIPSC_cxcl12_5nM_LF <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_LF_cxcl12_5nM_2.csv"))
CeA_sIPSC_cxcl12_5nM_LF <- CeA_sIPSC_cxcl12_5nM_LF %>% mutate(Type ='LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
bad_Cells <- c(6, 12, 15, 16) #6 - dootworzyła się, tylko 8 min; 12 - niestabilny baseline; 15- dziwne
wrong_Cells <- c(16)
CeA_sIPSC_lostcell <- CeA_sIPSC_cxcl12_5nM_LF %>% dplyr::filter(Cell %in% wrong_Cells)
CeA_sIPSC_cxcl12_5nM_LF <- CeA_sIPSC_cxcl12_5nM_LF %>% dplyr::filter(!Cell %in% bad_Cells)
CeA_sIPSC_cxcl12_5nM <- CeA_sIPSC_cxcl12_5nM_RS %>% bind_rows(CeA_sIPSC_cxcl12_5nM_LF) %>% mutate(Experiment = "CXCL12(5nM)") %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
#bad_Cells <- c(1, 4, 17, 10) # median_RiseTime big changes
CeA_sIPSC_cxcl12_5nM <- CeA_sIPSC_cxcl12_5nM %>% filter(!Cell %in% bad_Cells)

CeA_sIPSC_cxcl12_5nM$Condition <- plyr::revalue(CeA_sIPSC_cxcl12_5nM$Condition, c("b"="baseline", "f" = "CXCL12"))
CeA_sIPSC_cxcl12_5nM$Filename <- as.character(CeA_sIPSC_cxcl12_5nM$Filename)

#####CeA sIPSC amd + cxcl12 2nM###############
CeA_sIPSC_amd2nM_RS <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_RS_amdcxcl12_2nM.csv"))
CeA_sIPSC_amd2nM_RS <- CeA_sIPSC_amd2nM_RS %>% mutate(Type ='RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
bad_Cells <- c(2)
CeA_sIPSC_amd2nM_RS <- CeA_sIPSC_amd2nM_RS %>% filter(!Cell %in% bad_Cells)
CeA_sIPSC_amd2nM_LF <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_LF_amdcxcl12_2nM.csv"))
CeA_sIPSC_amd2nM_LF <- CeA_sIPSC_amd2nM_LF %>% mutate(Type ='LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())

CeA_sIPSC_amd2nM<- CeA_sIPSC_amd2nM_RS %>% bind_rows(CeA_sIPSC_amd2nM_LF) %>% dplyr::mutate(Experiment = "AMD3100 + \nCXCL12(2nM)") %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
CeA_sIPSC_amd2nM$Condition <- plyr::revalue(CeA_sIPSC_amd2nM$Condition, c("b"="baseline", "f" = "CXCL12"))
CeA_sIPSC_amd2nM$Filename <- as.character(CeA_sIPSC_amd2nM$Filename)
#bad_Cells <- c(2) # median_Frequency 7.5 -> 1.68
#CeA_sIPSC_amd2nM <- CeA_sIPSC_amd2nM %>% filter(!Cell %in% bad_Cells)

#####CeA sIPSC amd + cxcl12 5nM###############
CeA_sIPSC_amd5nM_RS <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_RS_amdcxcl12_5nM.csv"))
CeA_sIPSC_amd5nM_RS <- CeA_sIPSC_amd5nM_RS %>% mutate(Type ='RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_sIPSC_lostcell2$Filename <- as.character(CeA_sIPSC_lostcell2$Filename)
CeA_sIPSC_amd5nM_RS$Filename <- as.character(CeA_sIPSC_amd5nM_RS$Filename)
CeA_sIPSC_amd5nM_RS <- CeA_sIPSC_amd5nM_RS %>% dplyr::bind_rows(CeA_sIPSC_lostcell2)

CeA_sIPSC_amd5nM_LF <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_LF_amdcxcl12_5nM.csv"))
CeA_sIPSC_amd5nM_LF <- CeA_sIPSC_amd5nM_LF %>% mutate(Type ='LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_sIPSC_amd5nM_LF$Filename <- as.character(CeA_sIPSC_amd5nM_LF$Filename)
CeA_sIPSC_amd5nM_RS$Filename <- as.character(CeA_sIPSC_amd5nM_RS$Filename)
CeA_sIPSC_lostcell$Filename <- as.character(CeA_sIPSC_lostcell$Filename)
CeA_sIPSC_amd5nM_LF <- CeA_sIPSC_amd5nM_LF %>% bind_rows(CeA_sIPSC_lostcell)

CeA_sIPSC_amd5nM<- CeA_sIPSC_amd5nM_RS %>% bind_rows(CeA_sIPSC_amd5nM_LF) %>% dplyr::mutate(Experiment = "AMD3100 + \nCXCL12(5nM)") %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
CeA_sIPSC_amd5nM$Condition <- plyr::revalue(CeA_sIPSC_amd5nM$Condition, c("b"="baseline", "f" = "CXCL12"))
CeA_sIPSC_amd5nM$Filename <- as.character(CeA_sIPSC_amd5nM$Filename)

#####CeA sIPSC fluoro + cxcl12 5nM###############
CeA_sIPSC_fluoro_5nM_RS <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_RS_fluoro_cxcl12_5nM.csv"))
CeA_sIPSC_fluoro_5nM_RS <- CeA_sIPSC_fluoro_5nM_RS %>% mutate(Type ='RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_sIPSC_fluoro_5nM_LF <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sIPSC_CeA_LF_fluoro_cxcl12_5nM.csv"))
CeA_sIPSC_fluoro_5nM_LF <- CeA_sIPSC_fluoro_5nM_LF %>% mutate(Type ='LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_sIPSC_fluoro_5nM <- CeA_sIPSC_fluoro_5nM_RS %>% bind_rows(CeA_sIPSC_fluoro_5nM_LF) %>% mutate(Experiment = "fluorocitrate + \nCXCL12(5nM)") %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())

CeA_sIPSC_fluoro_5nM$Condition <- plyr::revalue(CeA_sIPSC_fluoro_5nM$Condition, c("b"="baseline", "f" = "CXCL12"))
CeA_sIPSC_fluoro_5nM$Filename <- as.character(CeA_sIPSC_fluoro_5nM$Filename)

#####CeA mIPSC cxcl12 2nM###############
CeA_mIPSC_cxcl12_2nM_RS <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_mIPSC_CeA_RS_cxcl12_2nM.csv"))
CeA_mIPSC_cxcl12_2nM_RS <- CeA_mIPSC_cxcl12_2nM_RS %>% mutate(Type ='RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
# CeA_mIPSC_cxcl12_2nM_LF <- ".//synaptic_transmission//CeA_mIPSC_LF_12_cxcl12_2nM_igor.xlsx" 
# st_table(CeA_mIPSC_cxcl12_2nM_LF)
# CeA_mIPSC_cxcl12_2nM_LF <- read_rds("summary_CeA_mIPSC_cxcl12_2nM_LF.rds") %>% mutate(Type ='LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_mIPSC_cxcl12_2nM <- CeA_mIPSC_cxcl12_2nM_RS  %>% mutate(Experiment = "CXCL12(2nM)") %>% dplyr::select(Experiment, Filename, Cell, Condition, everything()) #%>% bind_rows(CeA_mIPSC_cxcl12_2nM_LF) 

CeA_mIPSC_cxcl12_2nM$Condition <- plyr::revalue(CeA_mIPSC_cxcl12_2nM$Condition, c("b"="baseline", "f" = "CXCL12"))
CeA_mIPSC_cxcl12_2nM$Filename <- as.character(CeA_mIPSC_cxcl12_2nM$Filename)

#####CeA mIPSC cxcl12 5nM###############
CeA_mIPSC_cxcl12_5nM_RS <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_mIPSC_CeA_RS_cxcl12_5nM.csv"))
CeA_mIPSC_cxcl12_5nM_RS <- CeA_mIPSC_cxcl12_5nM_RS %>% mutate(Type ='RS') %>% dplyr::select(Filename, Cell, Condition, Type, everything())

CeA_mIPSC_cxcl12_5nM_LF <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_mIPSC_CeA_LF_cxcl12_5nM.csv"))
CeA_mIPSC_cxcl12_5nM_LF <- CeA_mIPSC_cxcl12_5nM_LF %>% mutate(Type ='LF') %>% dplyr::select(Filename, Cell, Condition, Type, everything())
CeA_mIPSC_cxcl12_5nM <- CeA_mIPSC_cxcl12_5nM_RS %>% dplyr::bind_rows(CeA_mIPSC_cxcl12_5nM_LF) %>% mutate(Experiment = "CXCL12(5nM)") %>% dplyr::select(Experiment, Filename, Cell, Condition, everything()) #%>% bind_rows(CeA_mIPSC_cxcl12_5nM_LF) 

CeA_mIPSC_cxcl12_5nM$Condition <- plyr::revalue(CeA_mIPSC_cxcl12_5nM$Condition, c("b"="baseline", "f" = "CXCL12"))
CeA_mIPSC_cxcl12_5nM$Filename <- as.character(CeA_mIPSC_cxcl12_5nM$Filename)

#####BLA final tables###############
BLA_df_final_12 <- BLA_df_cxcl12_2nM %>% bind_rows(BLA_df_cxcl12_5nM)

temp <- BLA_df_final_12 %>% filter(Condition == 'baseline') %>% filter(sag_ratio >= 102)

sag_Cells <- temp$Cell
BLA_df_sag <- BLA_df_final_12 %>% filter(Cell %in% sag_Cells)

BLA_sEPSC_final_12 <- BLA_cxcl12_2nM_sEPSC %>% bind_rows(BLA_cxcl12_5nM_sEPSC)

BLA_sIPSC_final_12 <- BLA_cxcl12_2nM_sIPSC %>% bind_rows(BLA_cxcl12_5nM_sIPSC)
#bad_Cells <- c(3) # CXCL12 5nM 20n03001 - 500-600 pA HOLDING CURRENT
#BLA_sIPSC_final_12 <- BLA_sIPSC_final_12 %>% filter(!Cell %in% bad_Cells)

#####CeA final tables###############
CeA_df_final_12 <- CeA_df_cxcl12_2nM %>% bind_rows(CeA_df_cxcl12_5nM) %>% bind_rows(CeA_amd5nM_df) %>% bind_rows(CeA_amda_df) %>% bind_rows(CeA_df_fluoro)
CeA_df_final_12$Experiment <- factor(CeA_df_final_12$Experiment, levels = c("CXCL12(2nM)", "CXCL12(5nM)", "AMD3100 + \nCXCL12(5nM)", "AMD3100", "fluorocitrate + \nCXCL12(5nM)"))
CeA_df_final_12$Condition <- factor(CeA_df_final_12$Condition, levels = c("baseline", "CXCL12", "AMD3100"))


CeA_df_final_12_RS <- CeA_df_final_12 %>% filter(Type == "RS")
CeA_df_final_12_LF <- CeA_df_final_12 %>% filter(Type == "LF")

temp <- CeA_df_final_12 %>% filter(Condition == 'baseline') %>% filter(sag_ratio >= 102)

sag_Cells <- temp$Cell
CeA_df_sag <- CeA_df_final_12 %>% filter(Cell %in% sag_Cells)
CeA_df_sag_RS <- CeA_df_sag %>% filter( Type == 'RS')
CeA_df_sag_LF <- CeA_df_sag %>% filter( Type == 'LF')

CeA_sEPSC_final_12 <- CeA_sEPSC_cxcl12_2nM %>% bind_rows(CeA_sEPSC_cxcl12_5nM) %>% bind_rows(CeA_amd5nM_sEPSC) %>% bind_rows(CeA_amda_sEPSC) %>% bind_rows(CeA_sEPSC_fluoro)
CeA_sEPSC_final_12$Condition <- factor(CeA_sEPSC_final_12$Condition, levels = c("baseline", "CXCL12", "AMD3100"))
CeA_sEPSC_final_12$Experiment <- factor(CeA_sEPSC_final_12$Experiment, levels = c("CXCL12(2nM)", "CXCL12(5nM)", "AMD3100 + \nCXCL12(5nM)", "AMD3100", "fluorocitrate + \nCXCL12(5nM)"))

CeA_sEPSC_final_12$Cell <- rep(1:(nrow(CeA_sEPSC_final_12)/2), each = 2)
CeA_sEPSC_RS_12 <- CeA_sEPSC_final_12 %>% filter(Type == 'RS')
CeA_sEPSC_LF_12 <- CeA_sEPSC_final_12 %>% filter(Type == 'LF')

CeA_sIPSC_final_12 <- CeA_sIPSC_cxcl12_2nM %>% bind_rows(CeA_sIPSC_cxcl12_5nM) %>% bind_rows(CeA_sIPSC_amd2nM) %>% bind_rows(CeA_sIPSC_amd5nM) %>% bind_rows(CeA_sIPSC_amda) %>% bind_rows(CeA_sIPSC_fluoro_5nM)
#CeA_sIPSC_final_12$Condition <- plyr::revalue(CeA_sIPSC_final_12$Condition, c("b"="baseline", "c" = "CXCL12"))
CeA_sIPSC_final_12$Experiment <- factor(CeA_sIPSC_final_12$Experiment, levels = c("CXCL12(2nM)", "CXCL12(5nM)", "AMD3100 + \nCXCL12(2nM)", "AMD3100 + \nCXCL12(5nM)", "AMD3100", "fluorocitrate + \nCXCL12(5nM)"))
CeA_sIPSC_final_12$Condition <- factor(CeA_sIPSC_final_12$Condition, levels = c("baseline", "CXCL12", "AMD3100"))
CeA_sIPSC_final_12$Cell <- rep(1:(nrow(CeA_sIPSC_final_12)/2), each = 2)
#bad_Cells <- c(21) # 20929016 - Rise Time more than 10ms, RS
#CeA_sIPSC_final_12 <- CeA_sIPSC_final_12 %>% filter(!Cell %in% bad_Cells)
CeA_sIPSC_RS_12 <- CeA_sIPSC_final_12 %>% filter(Type == 'RS')
CeA_sIPSC_LF_12 <- CeA_sIPSC_final_12 %>% filter(Type == 'LF')

CeA_mIPSC_final_12 <- CeA_mIPSC_cxcl12_2nM  %>% bind_rows(CeA_mIPSC_cxcl12_5nM) #%>% bind_rows(CeA_mIPSC_amd2nM) %>% bind_rows(CeA_mIPSC_amda)
#CeA_mIPSC_final_12$Condition <- plyr::revalue(CeA_mIPSC_final_12$Condition, c("b"="baseline", "c" = "CXCL12"))
CeA_mIPSC_final_12$Experiment <- factor(CeA_mIPSC_final_12$Experiment, levels = c("CXCL12(2nM)", "CXCL12(5nM)")) #, levels = c("CXCL12(2nM)", "CXCL12(5nM)", "AMD3100 + \nCXCL12(2nM)", "AMD3100"))
#CeA_mIPSC_final_12$Condition <- factor(CeA_mIPSC_final_12$Condition, levels = c("baseline", "CXCL12", "AMD3100"))
CeA_mIPSC_final_12$Cell <- rep(1:(nrow(CeA_mIPSC_final_12)/2), each = 2)
CeA_mIPSC_RS_12 <- CeA_mIPSC_final_12 %>% filter(Type == 'RS')
CeA_mIPSC_LF_12 <- CeA_mIPSC_final_12 %>% filter(Type == 'LF')

###############################INTERNEURONS IN PC###################################################################

BLA_df_inter_12 <- BLA_df_cxcl12_5nM_inter %>% bind_rows(BLA_df_cxcl12_2nM_inter)
BLA_df_inter_12$Experiment <- factor(BLA_df_inter_12$Experiment)
BLA_df_inter_12$Cell <- factor(BLA_df_inter_12$Cell)

temp <- BLA_df_inter_12 %>% filter(Condition == 'baseline') %>% filter(sag_ratio >= 102)
sag_Cells <- temp$Cell
BLA_df_inter_12_sag <- BLA_df_inter_12 %>% filter(Cell %in% sag_Cells) %>% dplyr::rename(sag_ratio = sag_ratio)

BLA_cxcl12_2nM_sEPSC_inter <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_BLA_cxcl12_2nM_inter.csv"))
BLA_cxcl12_2nM_sEPSC_inter <- BLA_cxcl12_2nM_sEPSC_inter %>% mutate(Experiment = 'CXCL12(2nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_cxcl12_2nM_sEPSC_inter$Filename <- as.character(BLA_cxcl12_2nM_sEPSC_inter$Filename)

BLA_cxcl12_5nM_sEPSC_inter <- as.tibble(read.csv(".//synaptic_transmission//eventer//st_sEPSC_BLA_cxcl12_5nM_inter.csv"))
BLA_cxcl12_5nM_sEPSC_inter <- BLA_cxcl12_5nM_sEPSC_inter %>% mutate(Experiment = 'CXCL12(5nM)') %>% dplyr::select(Experiment, Filename, Cell, Condition, everything())
BLA_cxcl12_5nM_sEPSC_inter$Filename <- as.character(BLA_cxcl12_5nM_sEPSC_inter$Filename)

BLA_sEPSC_final_12_inter <-  BLA_cxcl12_2nM_sEPSC_inter  %>% bind_rows(BLA_cxcl12_5nM_sEPSC_inter)
BLA_sEPSC_final_12_inter$Cell <- rep(1:(nrow(BLA_sEPSC_final_12_inter)/2), each = 2)
```