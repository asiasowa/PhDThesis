## CX3CL1/CX3CR1 in the CeA

The main target of the BLA is CeA.<!-- ładniej napisać// bardziej rozbudować -->
However, the basolateral and central complexes of the amygdala participate in different extended circuitries <!--citations--> and hence, the CX3CL1 may differentially regulate these networks. 
Thus, to gain insight into the CX3CL1-mediated regulation of the CeA circuitry, we examined cellular localization of CX3CL1 and CX3CR1 and the functional characteristics of CeA neurons.<!-- zmienić drugą część zdania... --> 
<!--the next step was to asses the cellular localization of CX3CL1 and its receptor, as well as their  electrophysiological effects. /// to gain insight into the CX3CL1-mediated regulation of the CeA circuitry, we examined the functional characteristic of the IPSCs in DG granule cells (Figure 1) and CA3 pyramidal neurons (Figure 2) in the dorsal and ventral hippocampus.  zmienić oczywiście...// they have different connectivity patterns -->


### Cellular distribution of CX3CL1 and CX3CR1 in the rat CeA

To gain greater insights about the cellular localization of CXCL12 and CXCR4, their expression was studied in rat brain slices by immunocytochemistry and fluorescence microscopy.

### Electrophysiological classification of CeA neurons 

### CX3CL1/CX3CR1 modulation of the electrical properties in CeA neurons

#### Modulation of intrinsic membrane properties of CeL neurons by CX3CL1 in the cell-type specific manner

```{r CX3CL1CeAexcitabilitystats, include = FALSE}
# getting the table of statistics for all CeA df (LF + RS) condition of one experiment
CX3CL1_CeA_stat_all <- stat_table_exp_membr_extended((CeA_df_final))

# selecting a stat_row so it prints nicely in text
CX3CL1_CeA_stat_all_gain <- as.data.frame(CX3CL1_CeA_stat_all %>% dplyr::filter(Variable == 'gain') %>% dplyr::select(Statistics))

CX3CL1_CeA_stat_all_Rm <- as.data.frame(CX3CL1_CeA_stat_all %>% dplyr::filter(Variable == 'Input_resistance') %>% dplyr::select(Statistics)) 

CX3CL1_CeA_stat_all_tau <- as.data.frame(CX3CL1_CeA_stat_all %>% dplyr::filter(Variable == 'tau') %>% dplyr::select(Statistics))

CX3CL1_CeA_stat_all_Vm <- as.data.frame(CX3CL1_CeA_stat_all %>% dplyr::filter(Variable == 'Vm') %>% dplyr::select(Statistics))

#### RS
CX3CL1_CeA_stat_RS <- stat_table_exp_membr_extended((CeA_df_final_RS))

# selecting a stat_row so it prints nicely in text
CX3CL1_CeA_stat_RS_gain <- as.data.frame(CX3CL1_CeA_stat_RS %>% dplyr::filter(Variable == 'gain') %>% dplyr::select(Statistics))

CX3CL1_CeA_stat_RS_Rm <- as.data.frame(CX3CL1_CeA_stat_RS %>% dplyr::filter(Variable == 'Input_resistance') %>% dplyr::select(Statistics)) 

CX3CL1_CeA_stat_RS_tau <- as.data.frame(CX3CL1_CeA_stat_RS %>% dplyr::filter(Variable == 'tau') %>% dplyr::select(Statistics))

CX3CL1_CeA_stat_RS_Vm <- as.data.frame(CX3CL1_CeA_stat_RS %>% dplyr::filter(Variable == 'Vm') %>% dplyr::select(Statistics))


#### LF
CX3CL1_CeA_stat_LF <- stat_table_exp_membr_extended((CeA_df_final_LF))

# selecting a stat_row so it prints nicely in text
CX3CL1_CeA_stat_LF_gain <- as.data.frame(CX3CL1_CeA_stat_LF %>% dplyr::filter(Variable == 'gain') %>% dplyr::select(Statistics))

CX3CL1_CeA_stat_LF_Rm <- as.data.frame(CX3CL1_CeA_stat_LF %>% dplyr::filter(Variable == 'Input_resistance') %>% dplyr::select(Statistics)) 

CX3CL1_CeA_stat_LF_tau <- as.data.frame(CX3CL1_CeA_stat_LF %>% dplyr::filter(Variable == 'tau') %>% dplyr::select(Statistics))

CX3CL1_CeA_stat_LF_Vm <- as.data.frame(CX3CL1_CeA_stat_LF %>% dplyr::filter(Variable == 'Vm') %>% dplyr::select(Statistics))
```

The next step was to investigate whether reduced excitability of CX3CL1 in the BLA<!--,together with ....,--> would affect the membrane properties of their main target, i.e., GABAergic cells in the CeL.
<!-- razem z tym, że on sam też może mieć udział... --> 
To this end, among others, such electrophysiological features as the excitability, input resistance, membrane time constant, resting membrane potential, was measured (see: Methods \@ref(electroprotocols)). <!-- analogous to the neurons in the BLA./// recorded using a whole-cell patch-clamp approach, in a current-clamp configuration.-->

In general, this experiment revealed that several membrane properties in the CeL neurons were significantly modified by CX3CL1 (Fig. \@ref(fig:CX3CL1CeAintrinsic)). 
Specifically, similar what is observed in the BLA, bath application of CX3CL1 (2nM) produced a <!--reversible--> decrease in the number of action potentials evoked by a given current step, manifested as decreased gain (baseline = `r round(CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)' & Condition == "baseline") %>% ungroup() %>% summarize(mean(gain)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)' & Condition == "baseline") %>% ungroup() %>% dplyr::summarize(x = sd(gain), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)`, CX3CL1(2nM) = `r round(CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)' & Condition == "CX3CL1") %>% ungroup() %>% summarize(mean(gain)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)' & Condition == "CX3CL1") %>% ungroup() %>% dplyr::summarize(x = sd(gain), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)`, `r CX3CL1_CeA_stat_all_gain`, see Fig. \@ref(fig:CX3CL1CeAintrinsic)).<!-- który panel?--><!--  We injected a series of depolarizing current steps to assess the number of action potentials (Figure 4a – c). Repeated-measure ANOVA revealed that projection neurons fired significantly less after NF knockdown // Bath application of DA (0.05–30 μm) produced a reversible decrease in the number of action potentials evoked by a given current step-->
However, contrary to principal cells in the BLA, the input resistance was also decreased after CX3CL1 application, together with membrane time constant.
Moreover, in response to bath-applied 2nM CX3CL1, resting membrane potentials of CeL neurons become more depolarized. <!-- In response to bath-applied agonists, the depolarization is strong enough that it is capable of producing prolonged spiking ( Beierlein et al., 2000; Fanselow et al., 2008; Kawaguchi, 1997; Xu et al., 2013 ).-->

Given that CeL comprises neurons of two main electrophysiological types<!-- La  ter studies further characterized at least four main physiological types of neurons in the CeA, distinguished based on their responses to intracellular current injections.-->, further analysis was aimed at comparison between Regular-Spiking (RS) and Late-Firing neurons in relation to previously measured parameters.<!-- odnośnik do góry i lepiej napisać// segregated those neurons according to their types.-->
Intriguingly, this additional analysis revealed that in RS group all of previously mentioned effects remained following CX3CL1 treatment, whereas CX3CL1 did not affect LF cells (see Fig. \@ref(fig:)),  implying that much higher proportion of RS reactive cells was reactive to CX3CL1.
All parameters and statistics are summarized in Table <!--?-->.

 two major classes of CeL neurons with distinct firing patterns,

```{r CX3CL1CeAintrinsic, fig.cap='**Effects of CX3CL1 on intrinsic properties of CeL neurons** **(a)** Schematics of presented conditions **(b)** Boxplots presenting each cell before and after CX3CL1 application across different conditions **(c)** Pie charts presenting how cells reacted to CX3CL1 **(d)** plots presenting input-output relationships of representative cells **e** representative voltage traces from representative cells to 300, 360 and 400pA injection currents prior to (blue) and after the CX3CL1 application (red) in the five conditions of electrophysiological recordings. Scale bar: 10mV, 10ms ', fig.align = 'center', echo = FALSE, message= FALSE, echo = FALSE, warning= FALSE, message = FALSE, fig.width= 12, fig.height= 18}

#knitr::include_graphics("images/results//CX3CL1_BLA_excitability.png")
#knitr::include_graphics("images/results//CX3CL1_BLA_excitability.png")

inset_frak2nM <- image_read("images//results//inset_frak2nM.png")
inset_frak2nM <- image_ggplot(inset_frak2nM)
inset_frak5nM <- image_read("images//results//inset_frak5nM.png")
inset_frak5nM <- image_ggplot(inset_frak5nM)
inset_ab <- image_read("images//results//inset_ab.png")
inset_ab <- image_ggplot(inset_ab)
inset_azdfrak2nM <- image_read("images//results//inset_azdfrak2nM.png")
inset_azdfrak2nM <- image_ggplot(inset_azdfrak2nM)
inset_azda <- image_read("images//results//inset_azd.png")
inset_azda <- image_ggplot(inset_azda)
inset_minofrak2nM <- image_read("images//results//inset_minofrak2nM.png")
inset_minofrak2nM <- image_ggplot(inset_minofrak2nM)
inset_minoa <- image_read("images//results//inset_minoa.png")
inset_minoa <- image_ggplot(inset_minoa)
inset_gaba <- image_read("images//results//inset_gaba.png")
inset_gaba <- image_ggplot(inset_gaba)

#powinny być nowe 
# IV_representative_frak2nM <- image_read("images//results//IV_representative_frak2nM.png")
# IV_representative_frak2nM <- image_ggplot(IV_representative_frak2nM)
# IV_representative_azdfrak2nM <- image_read("images//results//IV_representative_azdfrak2nM.png")
# IV_representative_azdfrak2nM <- image_ggplot(IV_representative_azdfrak2nM)
# IV_representative_gabafrak2nM <- image_read("images//results//IV_representative_gabafrak2nM.png")
# IV_representative_gabafrak2nM <- image_ggplot(IV_representative_gabafrak2nM)
# IV_representative_minofrak2nM <- image_read("images//results//IV_representative_minofrak2nM.png")
# IV_representative_minofrak2nM <- image_ggplot(IV_representative_minofrak2nM)
# making labels (as minocycline and azd has different condition than CX3CL1) for then making proper automatic statistics
f_labels_BLA_thres <- data.frame(Experiment = c( c("CX3CL1(2nM)" , "CX3CL1(5nM)", 'anti-CX3CR1 + \nCX3CL1(2nM)', "AZD8797 + \nCX3CL1(2nM)", "AZD8797", 'minocycline + \nCX3CL1(2nM)' , "minocycline" , 'picrotoxin + \nCGP52432 + \nCX3CL1(2nM)' )), label = c("", "", "", "", "", "", "*", ""))
f_labels_BLA_thres$Experiment <- factor(f_labels_BLA_thres$Experiment, levels = c("CX3CL1(2nM)" , "CX3CL1(5nM)", 'anti-CX3CR1 + \nCX3CL1(2nM)', "AZD8797 + \nCX3CL1(2nM)", "AZD8797", 'minocycline + \nCX3CL1(2nM)' , "minocycline" , 'picrotoxin + \nCGP52432 + \nCX3CL1(2nM)'))

# subsetting additional control 
BLA_df_frak_add <- BLA_df_final %>% dplyr::filter(Experiment %in% c("AZD8797", 'minocycline'))

# # making boxplot
bp_BLA_thres <- plot_boxplot(BLA_df_frak_all, Treshold1_all, ylabel = "Threshold current (mV)", mtitle = "", vary1 = -55, vary2 = -20, dot_size = 2)
bp_BLA_thres <- bp_BLA_thres + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5),
 strip.text = element_text(size = 11, face="bold"), strip.background = element_blank(), #facet_wrap opitions
 plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm") # plot margin
 ) + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.y = -25, label.x.npc = 'center', size = 10, face = "bold") 
# # making pies chart for every condition
pie_BLA_frak_thres <- BLA_df_final %>% filter(Experiment == 'CX3CL1(2nM)') %>% plot_pie_val3(Treshold1_all, "CX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm"))
pie_BLA_frak5nM_thres <- BLA_df_final %>% filter(Experiment == 'CX3CL1(5nM)') %>% plot_pie_val3(Treshold1_all, "CX3CL1(5nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm"))
pie_BLA_antifrak_thres <- BLA_df_final %>% filter(Experiment == 'anti-CX3CR1 + \nCX3CL1(2nM)') %>% plot_pie_val3(Treshold1_all, 'anti-CX3CR1 + \nCX3CL1(2nM)') + theme(plot.title = element_text(size= 10, hjust = 0.5), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm"))
pie_BLA_azdfrak_thres <- BLA_df_final %>% filter(Experiment == 'AZD8797 + \nCX3CL1(2nM)') %>% plot_pie_val3(Treshold1_all, "AZD8797 + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm"))
pie_BLA_azd_thres <- BLA_df_final %>% filter(Experiment == "AZD8797") %>% plot_pie_val3(Treshold1_all, "AZD8797") + theme(plot.title = element_text(size= 10, hjust = 0.5), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm"))
pie_BLA_minofrak_thres <- BLA_df_final %>% filter(Experiment == 'minocycline + \nCX3CL1(2nM)') %>% plot_pie_val3(Treshold1_all, 'minocycline + \nCX3CL1(2nM)') + theme(plot.title = element_text(size= 10, hjust = 0.5), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm"))
pie_BLA_mino_thres <- BLA_df_final %>% filter(Experiment == 'minocycline') %>% plot_pie_val3(Treshold1_all, "minocycline") + theme(plot.title = element_text(size= 10, hjust = 0.5), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm"))
pie_BLA_picro_thres <- BLA_df_final %>% filter(Experiment == 'picrotoxin + \nCGP52432 + \nCX3CL1(2nM)') %>% plot_pie_val3(Treshold1_all, 'picrotoxin + \nCGP52432 + \nCX3CL1(2nM)') + theme(plot.title = element_text(size= 10, hjust = 0.5), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm"))

### making representative plots 
## frak2nM
frak2nM_IV_subset <- BLA_df_final %>% filter(Experiment == "CX3CL1(2nM)" & Cell %in% c(7)) # subtracting one representative cell from whole dataframe
frak2nM_IV_subset$Filename_all1[frak2nM_IV_subset$Filename_all1 == "18227023"] = "CX3CL1(2nM)" #renaming the name - instead the name of the file - the name of the condition
representative_frak2nM <- frak2nM_IV_subset %>% plot_IV_individual(mtitle = "") + theme(strip.text = element_text(size = 11, face="bold"), strip.background = element_blank(), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm")) # making a plot
# ## importing traces
# 
# ## azdfrak2nM
azdfrak2nM_IV_subset <- BLA_df_final %>% filter(Experiment == "AZD8797 + \nCX3CL1(2nM)") %>% filter(Cell %in% c(30))
azdfrak2nM_IV_subset$Filename_all1[azdfrak2nM_IV_subset$Filename_all1 == "19d02002"] = "AZD8797 + \nCX3CL1(2nM)"
representative_azdfrak2nM <- azdfrak2nM_IV_subset %>% plot_IV_individual(mtitle = "") + theme(strip.text = element_text(size = 11, face="bold"), strip.background = element_blank(), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm")) #+ xlim(300, 500) + ylim(0, 12)
# 
## minofrak2nM
minofrak2nM_IV_subset <- BLA_df_final %>% filter(Experiment == "minocycline + \nCX3CL1(2nM)") %>% filter(Cell %in% c(42))
minofrak2nM_IV_subset$Filename_all1[minofrak2nM_IV_subset$Filename_all1 == "17d07008"] = "minocycline + \nCX3CL1(2nM)"
representative_minofrak2nM <- minofrak2nM_IV_subset %>% plot_IV_individual(mtitle = "") + theme(strip.text = element_text(size = 11, face="bold"), strip.background = element_blank(), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm")) + xlim(260, 500)
# 
## gaba
gabafrak2nM_IV_subset <- BLA_df_final %>% filter(Experiment == "picrotoxin + \nCGP52432 + \nCX3CL1(2nM)") %>% filter(Cell %in% c(55))
gabafrak2nM_IV_subset$Filename_all1[gabafrak2nM_IV_subset$Filename_all1 == "20605006"] = "picrotoxin + \nCGP52432 + \nCX3CL1(2nM)"
representative_gabafrak2nM <- gabafrak2nM_IV_subset %>% plot_IV_individual(mtitle = "") + theme(strip.text = element_text(size = 11, face="bold"), strip.background = element_blank(), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm"))

### general representative IV figure
figure_IV <- representative_frak2nM | representative_azdfrak2nM | representative_minofrak2nM | representative_gabafrak2nM

#using patchwork to do layout of the figure

# f_labels_BLA_thres_add <- data.frame(Experiment = c( c(  "AZD8797", "minocycline" )), label = c("", "*"))
# f_labels_BLA_thres_add$Experiment <- factor(f_labels_BLA_thres_add$Experiment, levels = c( "AZD8797",  "minocycline"))
# 
#  + geom_text(x = 1.5, y = -20, aes(label = label, color = NULL, group= NULL), data = f_labels_BLA_thres_add, size=12, face = 'bold') 

figure1 <-  ((inset_frak2nM | inset_frak5nM | inset_ab | inset_azdfrak2nM | inset_minofrak2nM | inset_gaba)  + plot_layout(tag_level = 'new')) /
 (bp_BLA_thres + theme(legend.position = "none"))  /
  (((pie_BLA_frak_thres | pie_BLA_frak5nM_thres | pie_BLA_antifrak_thres | pie_BLA_azdfrak_thres | pie_BLA_minofrak_thres | pie_BLA_picro_thres)  + plot_layout(tag_level = 'new')) +  plot_layout(guides = "collect") & theme(legend.position = "bottom")) / 
  (((((representative_frak2nM | representative_azdfrak2nM | representative_minofrak2nM | representative_gabafrak2nM) + plot_layout(tag_level = 'new')) +   plot_layout(tag_level = 'new')) + plot_layout(guides = "collect") & theme(legend.position = "right")))  +
    (IV_representative_frak2nM | IV_representative_azdfrak2nM | IV_representative_minofrak2nM | IV_representative_gabafrak2nM)


figure1 <- figure1 + 
  plot_annotation(tag_levels = c('a', '1')) + plot_layout(heights = c(0.3, 0.7, 1, 0.5, 1))

figure1

 
```
 
#### Excitatory synaptic transmission in the CeL and its effect by CX3CL12


#### Effects of CX3CL1 on the inhibitory synaptic transmission in the CeL

