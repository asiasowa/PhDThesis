## CX3CL1/CX3CR1 in the CeA

The main target of the BLA is CeA.<!-- ładniej napisać// bardziej rozbudować -->
However, the basolateral and central complexes of the amygdala participate in different extended circuitries <!--citations--> and hence, the CX3CL1 may differentially regulate these networks. 
Thus, to gain insight into the CX3CL1-mediated regulation of the CeA circuitry, we examined cellular localization of CX3CL1 and CX3CR1 and the functional characteristics of CeA neurons.<!-- zmienić drugą część zdania... --> 
<!--the next step was to asses the cellular localization of CX3CL1 and its receptor, as well as their  electrophysiological effects. /// to gain insight into the CX3CL1-mediated regulation of the CeA circuitry, we examined the functional characteristic of the IPSCs in DG granule cells (Figure 1) and CA3 pyramidal neurons (Figure 2) in the dorsal and ventral hippocampus.  zmienić oczywiście...// they have different connectivity patterns -->


### Cellular distribution of CX3CL1 and CX3CR1 in the rat CeA

To gain greater insights about the cellular localization of CXCL12 and CXCR4, their expression was studied in rat brain slices by immunocytochemistry and fluorescence microscopy.

Molecular identification and characterization of fear controlling circuitries is a promising path towards developing targeted treatments of fear-related disorders.

### Electrophysiological classification of CeA neurons 

### CX3CL1/CX3CR1 modulation of the electrical properties in CeA neurons

#### Modulation of intrinsic membrane properties of CeL neurons by CX3CL1 in the cell-type specific manner

```{r CX3CL1CeAexcitabilitystats, include = FALSE}
# getting the table of statistics for all CeA df (LF + RS) condition of one experiment
CX3CL1_CeA_stat_all <- stat_table_exp_membr_extended((CeA_df_final))
CX3CL1_CeA_stat_2nM_all <- stat_table_exp_membr_extended(CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)'))
CX3CL1_CeA_stat_azdfrak2nM_all <- stat_table_exp_membr_extended(CeA_df_final %>% filter(Experiment == 'AZD8797 + \nCX3CL1(2nM)'))
CX3CL1_CeA_stat_minofrak2nM_all <- stat_table_exp_membr_extended(CeA_df_final %>% filter(Experiment == 'minocycline + \nCX3CL1(2nM)'))
# selecting a stat_row so it prints nicely in text
CX3CL1_CeA_stat_all_gain <- as.data.frame(CX3CL1_CeA_stat_all %>% dplyr::filter(Variable == 'gain') %>% dplyr::select(Statistics))
CX3CL1_CeA_stat_frak2nM_gain <- CX3CL1_CeA_stat_all_gain$Statistics[1]
CX3CL1_CeA_stat_azdfrak_gain <- CX3CL1_CeA_stat_all_gain$Statistics[2]
CX3CL1_CeA_stat_azd_gain <- CX3CL1_CeA_stat_all_gain$Statistics[3]
CX3CL1_CeA_stat_minofrak_gain <- CX3CL1_CeA_stat_all_gain$Statistics[4]
CX3CL1_CeA_stat_mino_gain <- CX3CL1_CeA_stat_all_gain$Statistics[5]

CX3CL1_CeA_stat_all_Rm <- as.data.frame(CX3CL1_CeA_stat_all %>% dplyr::filter(Variable == 'Input_resistance') %>% dplyr::select(Statistics)) 
CX3CL1_CeA_stat_frak2nM_Rm <- CX3CL1_CeA_stat_all_Rm$Statistics[1]
CX3CL1_CeA_stat_azdfrak_Rm <- CX3CL1_CeA_stat_all_Rm$Statistics[2]
CX3CL1_CeA_stat_azd_Rm <- CX3CL1_CeA_stat_all_Rm$Statistics[3]
CX3CL1_CeA_stat_minofrak_Rm <- CX3CL1_CeA_stat_all_Rm$Statistics[4]
CX3CL1_CeA_stat_mino_Rm <- CX3CL1_CeA_stat_all_Rm$Statistics[5]

CX3CL1_CeA_stat_all_tau <- as.data.frame(CX3CL1_CeA_stat_all %>% dplyr::filter(Variable == 'tau') %>% dplyr::select(Statistics))
CX3CL1_CeA_stat_frak2nM_tau <- CX3CL1_CeA_stat_all_tau$Statistics[1]
CX3CL1_CeA_stat_azdfrak_tau <- CX3CL1_CeA_stat_all_tau$Statistics[2]
CX3CL1_CeA_stat_azd_tau <- CX3CL1_CeA_stat_all_tau$Statistics[3]
CX3CL1_CeA_stat_minofrak_tau <- CX3CL1_CeA_stat_all_tau$Statistics[4]
CX3CL1_CeA_stat_mino_tau <- CX3CL1_CeA_stat_all_tau$Statistics[5]

CX3CL1_CeA_stat_all_Vm <- as.data.frame(CX3CL1_CeA_stat_all %>% dplyr::filter(Variable == 'Vm') %>% dplyr::select(Statistics))
CX3CL1_CeA_stat_frak2nM_Vm <- CX3CL1_CeA_stat_all_Vm$Statistics[1]
CX3CL1_CeA_stat_azdfrak_Vm <- CX3CL1_CeA_stat_all_Vm$Statistics[2]
CX3CL1_CeA_stat_azd_Vm <- CX3CL1_CeA_stat_all_Vm$Statistics[3]
CX3CL1_CeA_stat_minofrak_Vm <- CX3CL1_CeA_stat_all_Vm$Statistics[4]
CX3CL1_CeA_stat_mino_Vm <- CX3CL1_CeA_stat_all_Vm$Statistics[5]

#### RS
CX3CL1_CeA_stat_RS <- stat_table_exp_membr_extended((CeA_df_final_RS))

# selecting a stat_row so it prints nicely in text
CX3CL1_CeA_stat_RS_all_gain <- as.data.frame(CX3CL1_CeA_stat_RS %>% dplyr::filter(Variable == 'gain') %>% dplyr::select(Statistics))
CX3CL1_CeA_stat_frak2nM_RS_gain <- CX3CL1_CeA_stat_RS_all_gain$Statistics[1]
CX3CL1_CeA_stat_azdfrak_RS_gain <- CX3CL1_CeA_stat_RS_all_gain$Statistics[2]
CX3CL1_CeA_stat_azd_RS_gain <- CX3CL1_CeA_stat_RS_all_gain$Statistics[3]
CX3CL1_CeA_stat_minofrak_RS_gain <- CX3CL1_CeA_stat_RS_all_gain$Statistics[4]
CX3CL1_CeA_stat_mino_RS_gain <- CX3CL1_CeA_stat_RS_all_gain$Statistics[5]

CX3CL1_CeA_stat_RS_all_Rm <- as.data.frame(CX3CL1_CeA_stat_RS %>% dplyr::filter(Variable == 'Input_resistance') %>% dplyr::select(Statistics)) 
CX3CL1_CeA_stat_frak2nM_RS_Rm <- CX3CL1_CeA_stat_RS_all_Rm$Statistics[1]
CX3CL1_CeA_stat_azdfrak_RS_Rm <- CX3CL1_CeA_stat_RS_all_Rm$Statistics[2]
CX3CL1_CeA_stat_azd_RS_Rm <- CX3CL1_CeA_stat_RS_all_Rm$Statistics[3]
CX3CL1_CeA_stat_minofrak_RS_Rm <- CX3CL1_CeA_stat_RS_all_Rm$Statistics[4]
CX3CL1_CeA_stat_mino_RS_Rm <- CX3CL1_CeA_stat_RS_all_Rm$Statistics[5]

CX3CL1_CeA_stat_RS_all_tau <- as.data.frame(CX3CL1_CeA_stat_RS %>% dplyr::filter(Variable == 'tau') %>% dplyr::select(Statistics))
CX3CL1_CeA_stat_frak2nM_RS_tau <- CX3CL1_CeA_stat_RS_all_tau$Statistics[1]
CX3CL1_CeA_stat_azdfrak_RS_tau <- CX3CL1_CeA_stat_RS_all_tau$Statistics[2]
CX3CL1_CeA_stat_azd_RS_tau <- CX3CL1_CeA_stat_RS_all_tau$Statistics[3]
CX3CL1_CeA_stat_minofrak_RS_tau <- CX3CL1_CeA_stat_RS_all_tau$Statistics[4]
CX3CL1_CeA_stat_mino_RS_tau <- CX3CL1_CeA_stat_RS_all_tau$Statistics[5]

CX3CL1_CeA_stat_RS_all_Vm <- as.data.frame(CX3CL1_CeA_stat_RS %>% dplyr::filter(Variable == 'Vm') %>% dplyr::select(Statistics))
CX3CL1_CeA_stat_frak2nM_RS_Vm <- CX3CL1_CeA_stat_RS_all_Vm$Statistics[1]
CX3CL1_CeA_stat_azdfrak_RS_Vm <- CX3CL1_CeA_stat_RS_all_Vm$Statistics[2]
CX3CL1_CeA_stat_azd_RS_Vm <- CX3CL1_CeA_stat_RS_all_Vm$Statistics[3]
CX3CL1_CeA_stat_minofrak_RS_Vm <- CX3CL1_CeA_stat_RS_all_Vm$Statistics[4]
CX3CL1_CeA_stat_mino_RS_Vm <- CX3CL1_CeA_stat_RS_all_Vm$Statistics[5]


#### LF
CX3CL1_CeA_stat_LF <- stat_table_exp_membr_extended((CeA_df_final_LF))

# selecting a stat_row so it prints nicely in text
CX3CL1_CeA_stat_LF_all_gain <- as.data.frame(CX3CL1_CeA_stat_LF %>% dplyr::filter(Variable == 'gain') %>% dplyr::select(Statistics))
CX3CL1_CeA_stat_frak2nM_LF_gain <- CX3CL1_CeA_stat_LF_all_gain$Statistics[1]
CX3CL1_CeA_stat_azdfrak_LF_gain <- CX3CL1_CeA_stat_LF_all_gain$Statistics[2]
CX3CL1_CeA_stat_azd_LF_gain <- CX3CL1_CeA_stat_LF_all_gain$Statistics[3]
CX3CL1_CeA_stat_minofrak_LF_gain <- CX3CL1_CeA_stat_LF_all_gain$Statistics[4]
CX3CL1_CeA_stat_mino_LF_gain <- CX3CL1_CeA_stat_LF_all_gain$Statistics[5]

CX3CL1_CeA_stat_LF_all_Rm <- as.data.frame(CX3CL1_CeA_stat_LF %>% dplyr::filter(Variable == 'Input_resistance') %>% dplyr::select(Statistics)) 
CX3CL1_CeA_stat_frak2nM_LF_Rm <- CX3CL1_CeA_stat_LF_all_Rm$Statistics[1]
CX3CL1_CeA_stat_azdfrak_LF_Rm <- CX3CL1_CeA_stat_LF_all_Rm$Statistics[2]
CX3CL1_CeA_stat_azd_LF_Rm <- CX3CL1_CeA_stat_LF_all_Rm$Statistics[3]
CX3CL1_CeA_stat_minofrak_LF_Rm <- CX3CL1_CeA_stat_LF_all_Rm$Statistics[4]
CX3CL1_CeA_stat_mino_LF_Rm <- CX3CL1_CeA_stat_LF_all_Rm$Statistics[5]

CX3CL1_CeA_stat_LF_all_tau <- as.data.frame(CX3CL1_CeA_stat_LF %>% dplyr::filter(Variable == 'tau') %>% dplyr::select(Statistics))
CX3CL1_CeA_stat_frak2nM_LF_tau <- CX3CL1_CeA_stat_LF_all_tau$Statistics[1]
CX3CL1_CeA_stat_azdfrak_LF_tau <- CX3CL1_CeA_stat_LF_all_tau$Statistics[2]
CX3CL1_CeA_stat_azd_LF_tau <- CX3CL1_CeA_stat_LF_all_tau$Statistics[3]
CX3CL1_CeA_stat_minofrak_LF_tau <- CX3CL1_CeA_stat_LF_all_tau$Statistics[4]
CX3CL1_CeA_stat_mino_LF_tau <- CX3CL1_CeA_stat_LF_all_tau$Statistics[5]

CX3CL1_CeA_stat_LF_all_Vm <- as.data.frame(CX3CL1_CeA_stat_LF %>% dplyr::filter(Variable == 'Vm') %>% dplyr::select(Statistics))
CX3CL1_CeA_stat_frak2nM_LF_Vm <- CX3CL1_CeA_stat_LF_all_Vm$Statistics[1]
CX3CL1_CeA_stat_azdfrak_LF_Vm <- CX3CL1_CeA_stat_LF_all_Vm$Statistics[2]
CX3CL1_CeA_stat_azd_LF_Vm <- CX3CL1_CeA_stat_LF_all_Vm$Statistics[3]
CX3CL1_CeA_stat_minofrak_LF_Vm <- CX3CL1_CeA_stat_LF_all_Vm$Statistics[4]
CX3CL1_CeA_stat_mino_LF_Vm <- CX3CL1_CeA_stat_LF_all_Vm$Statistics[5]
```

The next step was to investigate whether reduced excitability of CX3CL1 in the BLA<!--,together with ....,--> would affect the membrane properties of their main target, i.e., GABAergic cells in the CeL.
<!-- razem z tym, że on sam też może mieć udział... --> 
To this end, among others, electrophysiological features such as the excitability, input resistance, membrane time constant, resting membrane potential, was measured (see: Methods \@ref(electroprotocols)). <!-- analogous to the neurons in the BLA./// recorded using a whole-cell patch-clamp approach, in a current-clamp configuration.-->

In general, these experiments revealed that several membrane properties in the CeL neurons were significantly modified by CX3CL1 (Fig. \@ref(fig:CX3CL1CeAintrinsic)). 
Specifically, similar to what was observed in the BLA, bath application of CX3CL1 (2nM) produced a <!--reversible--> decrease in the number of action potentials evoked by a given current step, manifested as a decrease in gain (baseline = `r round(CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)' & Condition == "baseline") %>% ungroup() %>% summarize(mean(gain)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)' & Condition == "baseline") %>% ungroup() %>% dplyr::summarize(x = sd(gain), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)`, CX3CL1(2nM) = `r round(CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)' & Condition == "CX3CL1") %>% ungroup() %>% summarize(mean(gain)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)' & Condition == "CX3CL1") %>% ungroup() %>% dplyr::summarize(x = sd(gain), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)`, `r CX3CL1_CeA_stat_all_gain`, see Fig. \@ref(fig:CX3CL1CeAintrinsic)<!--jaki?-->).<!-- który panel?--><!--  We injected a series of depolarizing current steps to assess the number of action potentials (Figure 4a – c). Repeated-measure ANOVA revealed that projection neurons fired significantly less after NF knockdown // Bath application of DA (0.05–30 μm) produced a reversible decrease in the number of action potentials evoked by a given current step-->
This effect was accompanied by decreased input resistance (`r CX3CL1_CeA_stat_all_gain`)and membrane time constant after CX3CL1 application (Fig. \@ref(fig:CX3CL1CeAintrinsic)<!--jaki?-->).
Moreover, in response to bath-applied 2nM CX3CL1, resting membrane potentials of CeL neurons become more depolarized  (Fig. \@ref(fig:CX3CL1CeAintrinsic)<!--jaki?-->).<!-- In response to bath-applied agonists, the depolarization is strong enough that it is capable of producing prolonged spiking ( Beierlein et al., 2000; Fanselow et al., 2008; Kawaguchi, 1997; Xu et al., 2013 ).-->

Given that CeL neurons demonstrate mainly two types of electrophysiological firing patterns (see Introduction, CeA subchapter \@ref(CeA)<!-- i może jeszcze metoda electrophysiological recordings?-->), which was also confirmed by cluster analysis from recorded CeL cells as a part of this dissertation,<!--comprises neurons of two main electrophysiological types // La  ter studies further characterized at least four main physiological types of neurons in the CeA, distinguished based on their responses to intracellular current injections.-->, further analysis was aimed at comparison between Regular-Spiking (RS) and Late-Firing neurons based on previously measured parameters.<!-- odnośnik do góry i lepiej napisać// segregated those neurons according to their types.-->
Intriguingly, this additional analysis revealed that much grated proportion of RS neurons were responsive to CX3CL1, reflected as robust changes in intrinsic properties (Fig. \@ref(fig:CX3CL1CeAintrinsic)<!--part-->).
In contrast, under presented here experimental conditions, CX3CL1 seems not to affect LF cells (see Fig. \@ref(fig:CX3CL1CeAintrinsic)<!--part-->),  implying that much higher proportion of RS reactive cells was reactive to CX3CL1.
All parameters and statistics are summarized in Table <!--?-->.

 

```{r CX3CL1CeAintrinsic, fig.cap='**Effects of CX3CL1 on intrinsic properties of CeL neurons** **(a)** Schematics of presented conditions **(b)** Boxplots presenting each cell before and after CX3CL1 application across different conditions **(c)** Pie charts presenting how cells reacted to CX3CL1 **(d)** plots presenting input-output relationships of representative cells **e** representative voltage traces from representative cells to 300, 360 and 400pA injection currents prior to (blue) and after the CX3CL1 application (red) in the five conditions of electrophysiological recordings. Scale bar: 10mV, 10ms ', fig.align = 'center', echo = FALSE, message= FALSE, echo = FALSE, warning= FALSE, message = FALSE, fig.width= 12, fig.height= 18}

#knitr::include_graphics("images/results//CX3CL1_BLA_excitability.png")
#knitr::include_graphics("images/results//CX3CL1_BLA_excitability.png")

inset_frak2nM <- image_read("images//results//inset_frak2nM.png")
inset_frak2nM <- image_ggplot(inset_frak2nM)
inset_azdfrak2nM <- image_read("images//results//inset_azdfrak2nM.png")
inset_azdfrak2nM <- image_ggplot(inset_azdfrak2nM)
inset_azda <- image_read("images//results//inset_azd.png")
inset_azda <- image_ggplot(inset_azda)
inset_minofrak2nM <- image_read("images//results//inset_minofrak2nM.png")
inset_minofrak2nM <- image_ggplot(inset_minofrak2nM)
inset_minoa <- image_read("images//results//inset_minoa.png")
inset_minoa <- image_ggplot(inset_minoa)

#powinny być nowe 
# IV_representative_frak2nM <- image_read("images//results//IV_representative_frak2nM.png")
# IV_representative_frak2nM <- image_ggplot(IV_representative_frak2nM)
# IV_representative_azdfrak2nM <- image_read("images//results//IV_representative_azdfrak2nM.png")
# IV_representative_azdfrak2nM <- image_ggplot(IV_representative_azdfrak2nM)
# IV_representative_gabafrak2nM <- image_read("images//results//IV_representative_gabafrak2nM.png")
# IV_representative_gabafrak2nM <- image_ggplot(IV_representative_gabafrak2nM)
# IV_representative_minofrak2nM <- image_read("images//results//IV_representative_minofrak2nM.png")
# IV_representative_minofrak2nM <- image_ggplot(IV_representative_minofrak2nM)
# making labels (as minocycline and azd has different condition than CX3CL1) for then making proper automatic statistics
# f_labels_BLA_thres <- data.frame(Experiment = c( c("CX3CL1(2nM)" , "CX3CL1(5nM)", 'anti-CX3CR1 + \nCX3CL1(2nM)', "AZD8797 + \nCX3CL1(2nM)", "AZD8797", 'minocycline + \nCX3CL1(2nM)' , "minocycline" , 'picrotoxin + \nCGP52432 + \nCX3CL1(2nM)' )), label = c("", "", "", "", "", "", "*", ""))
# f_labels_BLA_thres$Experiment <- factor(f_labels_BLA_thres$Experiment, levels = c("CX3CL1(2nM)" , "CX3CL1(5nM)", 'anti-CX3CR1 + \nCX3CL1(2nM)', "AZD8797 + \nCX3CL1(2nM)", "AZD8797", 'minocycline + \nCX3CL1(2nM)' , "minocycline" , 'picrotoxin + \nCGP52432 + \nCX3CL1(2nM)'))

# GAIN
bp_CeA_gain <- plot_boxplot(CeA_df_final, gain, mtitle= "CeL - All Neurons", ylabel = "gain",  dot_size = 2)
bp_CeA_gain <- bp_CeA_gain + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5)) + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE)

pie_CeA_frak2nM_gain <- CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)') %>% plot_pie_val15(gain, mtitle = "CX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
#pie_CeA_frak5nM_gain <- CeA_df_final %>% filter(Experiment == 'CX3CL1(5nM)') %>% plot_pie_val15(gain, mtitle = "CX3CL1(5nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_azdfrak_gain <- CeA_df_final %>% filter(Experiment == 'AZD8797 + \nCX3CL1(2nM)') %>% plot_pie_val15(gain, mtitle = "AZD8797 + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_azd_gain <- CeA_df_final %>% filter(Experiment == "AZD8797") %>% plot_pie_val15(gain, mtitle = "AZD8797") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_minofrak_gain <- CeA_df_final %>% filter(Experiment == "minocycline + \nCX3CL1(2nM)") %>% plot_pie_val15(gain, mtitle = "minocycline + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_mino_gain <- CeA_df_final %>% filter(Experiment == 'minocycline') %>% plot_pie_val15(gain, mtitle = "minocycline") + theme(plot.title = element_text(size= 10, hjust = 0.5))
# THRESHOLD CURRENT

# f_labels_CeA_thres <- data.frame(Experiment = c( c("CX3CL1(2nM)",  "AZD8797 + \nCX3CL1(2nM)", "AZD8797", "minocycline + \nCX3CL1(2nM)" , "minocycline" )), label = c("", "", "*", "", ""))
# f_labels_CeA_thres$Experiment <- factor(f_labels_CeA_thres$Experiment, levels = c("CX3CL1(2nM)", "AZD8797 + \nCX3CL1(2nM)", "AZD8797", "minocycline + \nCX3CL1(2nM)" , "minocycline"))
# 
# bp_CeA_thres <- plot_boxplot(CeA_df_final, Treshold1_all, mtitle= "CeA - All Cells", ylabel = "Threshold current (mV)", vary1 = -60, vary2 = -20, dot_size = 2)
# bp_CeA_thres <- bp_CeA_thres + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5)) + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE) + geom_text(x = 1.5, y = -20, aes(label = label, color = NULL, group= NULL), data = f_labels_CeA_thres)
# 
# pie_CeA_frak2nM_thres <- CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)') %>% plot_pie_val3(Treshold1_all, mtitle = "CX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
#pie_CeA_frak5nM_thres <- CeA_df_final %>% filter(Experiment == 'CX3CL1(5nM)') %>% plot_pie_val3(Treshold1_all, mtitle = "CX3CL1(5nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
# pie_CeA_azdfrak_thres <- CeA_df_final %>% filter(Experiment == 'AZD8797 + \nCX3CL1(2nM)') %>% plot_pie_val3(Treshold1_all, mtitle = "AZD8797 + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
# pie_CeA_azd_thres <- CeA_df_final %>% filter(Experiment == "AZD8797") %>% plot_pie_val3(Treshold1_all, mtitle = "AZD8797") + theme(plot.title = element_text(size= 10, hjust = 0.5))
# pie_CeA_minofrak_thres <- CeA_df_final %>% filter(Experiment == "minocycline + \nCX3CL1(2nM)") %>% plot_pie_val3(Treshold1_all, mtitle = "minocycline + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
# pie_CeA_mino_thres <- CeA_df_final %>% filter(Experiment == 'minocycline') %>% plot_pie_val3(Treshold1_all, mtitle = "minocycline") + theme(plot.title = element_text(size= 10, hjust = 0.5))
# ADAPTATION
# bp_CeA_adap <- plot_boxplot(CeA_df_final, Adaptation_ratio, mtitle= "CeA - All Cells", ylabel = "Adaptation ratio", vary1 = 0, vary2 = 2, dot_size = 2)
# bp_CeA_adap <- bp_CeA_adap + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5)) + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE)
# 
# pie_CeA_frak2nM_adap <- CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)') %>% plot_pie2(Adaptation_ratio, mtitle = "CX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
#pie_CeA_frak5nM_adap <- CeA_df_final %>% filter(Experiment == 'CX3CL1(5nM)') %>% plot_pie2(Adaptation_ratio, mtitle = "CX3CL1(5nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
# pie_CeA_azdfrak_adap <- CeA_df_final %>% filter(Experiment == 'AZD8797 + \nCX3CL1(2nM)') %>% plot_pie2(Adaptation_ratio, mtitle = "AZD8797 + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
# pie_CeA_azd_adap <- CeA_df_final %>% filter(Experiment == "AZD8797") %>% plot_pie2(Adaptation_ratio, mtitle = "AZD8797") + theme(plot.title = element_text(size= 10, hjust = 0.5))
# pie_CeA_minofrak_adap <- CeA_df_final %>% filter(Experiment == "minocycline + \nCX3CL1(2nM)") %>% plot_pie2(Adaptation_ratio, mtitle = "minocycline + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
# pie_CeA_mino_adap <- CeA_df_final %>% filter(Experiment == 'minocycline') %>% plot_pie2(Adaptation_ratio, mtitle = "minocycline") + theme(plot.title = element_text(size= 10, hjust = 0.5))

# INPUT RESISTANCE
bp_CeA_rm <- plot_boxplot(CeA_df_final, Rm_20, mtitle= "CeA - All Cells", ylabel = "Input resistance (MOhm)", vary1 = 100, vary2 = 900, dot_size = 2)
bp_CeA_rm <- bp_CeA_rm + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5)) + stat_compare_means(method = 'wilcox.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE)

pie_CeA_frak2nM_rm <- CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)') %>% plot_pie2(Rm_20, mtitle = "CX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
#pie_CeA_frak5nM_rm <- CeA_df_final %>% filter(Experiment == 'CX3CL1(5nM)') %>% plot_pie2(Rm_20, mtitle = "CX3CL1(5nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_azdfrak_rm <- CeA_df_final %>% filter(Experiment == 'AZD8797 + \nCX3CL1(2nM)') %>% plot_pie2(Rm_20, mtitle = "AZD8797 + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_azd_rm <- CeA_df_final %>% filter(Experiment == "AZD8797") %>% plot_pie2(Rm_20, mtitle = "AZD8797") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_minofrak_rm <- CeA_df_final %>% filter(Experiment == "minocycline + \nCX3CL1(2nM)") %>% plot_pie2(Rm_20, mtitle = "minocycline + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_mino_rm <- CeA_df_final %>% filter(Experiment == 'minocycline') %>% plot_pie2(Rm_20, mtitle = "minocycline") + theme(plot.title = element_text(size= 10, hjust = 0.5))

# TAU
bp_CeA_tau <- plot_boxplot(CeA_df_final, tau_20, mtitle= "CeA - All Cells", ylabel = "tau (ms)", vary1 = 0, vary2 = 40, dot_size = 2)
bp_CeA_tau <- bp_CeA_tau + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5)) + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE)

pie_CeA_frak2nM_tau <- CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)') %>% plot_pie2(tau_20, mtitle = "CX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
#pie_CeA_frak5nM_tau <- CeA_df_final %>% filter(Experiment == 'CX3CL1(5nM)') %>% plot_pie2(tau_20, mtitle = "CX3CL1(5nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_azdfrak_tau <- CeA_df_final %>% filter(Experiment == 'AZD8797 + \nCX3CL1(2nM)') %>% plot_pie2(tau_20, mtitle = "AZD8797 + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_azd_tau <- CeA_df_final %>% filter(Experiment == "AZD8797") %>% plot_pie2(tau_20, mtitle = "AZD8797") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_minofrak_tau <- CeA_df_final %>% filter(Experiment == "minocycline + \nCX3CL1(2nM)") %>% plot_pie2(tau_20, mtitle = "minocycline + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_mino_tau <- CeA_df_final %>% filter(Experiment == 'minocycline') %>% plot_pie2(tau_20, mtitle = "minocycline") + theme(plot.title = element_text(size= 10, hjust = 0.5))
# CAPACITANCE
# f_labels_CeA_cap <- data.frame(Experiment = c( c("CX3CL1(2nM)", "AZD8797 + \nCX3CL1(2nM)", "AZD8797", "minocycline + \nCX3CL1(2nM)" , "minocycline")), label = c("", "", "", "", "*"))
# f_labels_CeA_cap$Experiment <- factor(f_labels_CeA_cap$Experiment, levels = c("CX3CL1(2nM)" ,"AZD8797 + \nCX3CL1(2nM)", "AZD8797", "minocycline + \nCX3CL1(2nM)" , "minocycline"))
# bp_CeA_cap <- plot_boxplot(CeA_df_final, C_20, mtitle= "CeA - All Cells", ylabel = "Capacitance (pF)", vary1 = 30, vary2 = 155, dot_size = 2)
# bp_CeA_cap <- bp_CeA_cap + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5)) + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE) + geom_text(x = 1.5, y = 130, aes(label = label, color = NULL, group= NULL), data = f_labels_CeA_cap)

# pie_CeA_frak2nM_cap <- CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)') %>% plot_pie2(C_20, mtitle = "CX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
#pie_CeA_frak5nM_cap <- CeA_df_final %>% filter(Experiment == 'CX3CL1(5nM)') %>% plot_pie2(C_20, mtitle = "CX3CL1(5nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
# pie_CeA_azdfrak_cap <- CeA_df_final %>% filter(Experiment == 'AZD8797 + \nCX3CL1(2nM)') %>% plot_pie2(C_20, mtitle = "AZD8797 + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
# pie_CeA_azd_cap <- CeA_df_final %>% filter(Experiment == "AZD8797") %>% plot_pie2(C_20, mtitle = "AZD8797") + theme(plot.title = element_text(size= 10, hjust = 0.5))
# pie_CeA_minofrak_cap <- CeA_df_final %>% filter(Experiment == "minocycline + \nCX3CL1(2nM)") %>% plot_pie2(C_20, mtitle = "minocycline + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
# pie_CeA_mino_cap <- CeA_df_final %>% filter(Experiment == 'minocycline') %>% plot_pie2(C_20, mtitle = "minocycline") + theme(plot.title = element_text(size= 10, hjust = 0.5))
# SAG
# bp_CeA_sag <- plot_boxplot(CeA_df_sag, sag_ratio_140, mtitle= "CeA - All Cells", ylabel = "sag ratio @-140 pA", dot_size = 2)
# bp_CeA_sag <- bp_CeA_sag + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5))

#pie_CeA_frak2nM_sag <- CeA_df_sag %>% filter(Experiment == 'CX3CL1(2nM)') %>% plot_pie_val3(sag_ratio_140, mtitle = "CX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
#pie_CeA_frak5nM_sag <- CeA_df_sag %>% filter(Experiment == 'CX3CL1(5nM)') %>% plot_pie_val3(sag_ratio_140, mtitle = "CX3CL1(5nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
#pie_CeA_azdfrak_sag <- CeA_df_sag %>% filter(Experiment == 'AZD8797 + \nCX3CL1(2nM)') %>% plot_pie_val3(sag_ratio_140, mtitle = "AZD8797 + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
# pie_CeA_azd_sag <- CeA_df_sag %>% filter(Experiment == "AZD8797") %>% plot_pie_val3(sag_ratio_140, mtitle = "AZD8797") + theme(plot.title = element_text(size= 10, hjust = 0.5))
# pie_CeA_minofrak_sag <- CeA_df_sag %>% filter(Experiment == "minocycline + \nCX3CL1(2nM)") %>% plot_pie_val3(sag_ratio_140, mtitle = "minocycline + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
# pie_CeA_mino_sag <- CeA_df_sag %>% filter(Experiment == 'minocycline') %>% plot_pie_val3(sag_ratio_140, mtitle = "minocycline") + theme(plot.title = element_text(size= 10, hjust = 0.5))

# RESTING MEMBRANE POTENTIAL
bp_CeA_vm <- plot_boxplot(CeA_df_final, RMS, mtitle= "CeA - All Cells", ylabel = "Resting membrane potential (mV)", vary1 = -80, vary2 = -25, dot_size = 2)
bp_CeA_vm <- bp_CeA_vm + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5))

pie_CeA_frak2nM_vm <- CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)') %>% plot_pie_val3(RMS, mtitle = "CX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
#pie_CeA_frak5nM_vm <- CeA_df_final %>% filter(Experiment == 'CX3CL1(5nM)') %>% plot_pie_val3(RMS, mtitle = "CX3CL1(5nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_azdfrak_vm <- CeA_df_final %>% filter(Experiment == 'AZD8797 + \nCX3CL1(2nM)') %>% plot_pie_val3(RMS, mtitle = "AZD8797 + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_azd_vm <- CeA_df_final %>% filter(Experiment == "AZD8797") %>% plot_pie_val3(RMS, mtitle = "AZD8797") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_minofrak_vm <- CeA_df_final %>% filter(Experiment == "minocycline + \nCX3CL1(2nM)") %>% plot_pie_val3(RMS, mtitle = "minocycline + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_mino_vm <- CeA_df_final %>% filter(Experiment == 'minocycline') %>% plot_pie_val3(RMS, mtitle = "minocycline") + theme(plot.title = element_text(size= 10, hjust = 0.5))

# ACTION POTENTIAL WIDTH
bp_CeA_apw <- plot_boxplot(CeA_df_final, AP_width1_all, mtitle= "CeA - All Cells", ylabel = "Action potential width (ms)", vary1 = 0.5, vary2 = 2.5, dot_size = 2)
bp_CeA_apw <- bp_CeA_apw + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5)) # + stat_compare_means(method = 'wilcox.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE)

pie_CeA_frak2nM_apw <- CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)') %>% plot_pie_val3(AP_width1_all, mtitle = "CX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
#pie_CeA_frak5nM_apw <- CeA_df_final %>% filter(Experiment == 'CX3CL1(5nM)') %>% plot_pie_val3(AP_width1_all, mtitle = "CX3CL1(5nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_azdfrak_apw <- CeA_df_final %>% filter(Experiment == 'AZD8797 + \nCX3CL1(2nM)') %>% plot_pie_val3(AP_width1_all, mtitle = "AZD8797 + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_azd_apw <- CeA_df_final %>% filter(Experiment == "AZD8797") %>% plot_pie_val3(AP_width1_all, mtitle = "AZD8797") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_minofrak_apw <- CeA_df_final %>% filter(Experiment == "minocycline + \nCX3CL1(2nM)") %>% plot_pie_val3(AP_width1_all, mtitle = "minocycline + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_mino_apw <- CeA_df_final %>% filter(Experiment == 'minocycline') %>% plot_pie_val3(AP_width1_all, mtitle = "minocycline") + theme(plot.title = element_text(size= 10, hjust = 0.5))

# ACTION POTENTIAL AMPLITUDE
bp_CeA_apa <- plot_boxplot(CeA_df_final, AP_amp1_all, mtitle= "CeA - All Cells", ylabel = "Action potential amplitude (pA)", vary1 = 50, vary2 = 120, dot_size = 2)
bp_CeA_apa <- bp_CeA_apa + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5)) #+ stat_compare_means(method = 'wilcox.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE)

pie_CeA_frak2nM_apa <- CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)') %>% plot_pie2(AP_amp1_all, mtitle = "CX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
#pie_CeA_frak5nM_apa <- CeA_df_final %>% filter(Experiment == 'CX3CL1(5nM)') %>% plot_pie2(AP_amp1_all, mtitle = "CX3CL1(5nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_azdfrak_apa <- CeA_df_final %>% filter(Experiment == 'AZD8797 + \nCX3CL1(2nM)') %>% plot_pie2(AP_amp1_all, mtitle = "AZD8797 + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_azd_apa <- CeA_df_final %>% filter(Experiment == "AZD8797") %>% plot_pie2(AP_amp1_all, mtitle = "AZD8797") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_minofrak_apa <- CeA_df_final %>% filter(Experiment == "minocycline + \nCX3CL1(2nM)") %>% plot_pie2(AP_amp1_all, mtitle = "minocycline + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_mino_apa <- CeA_df_final %>% filter(Experiment == 'minocycline') %>% plot_pie2(AP_amp1_all, mtitle = "minocycline") + theme(plot.title = element_text(size= 10, hjust = 0.5))

# FAST AHP
bp_CeA_fast <- plot_boxplot(CeA_df_final, AHPf1_all, mtitle= "CeA - All Cells", ylabel = "fast AHP (pA)", vary1 = -25, vary2 = 7, dot_size = 2)
bp_CeA_fast <- bp_CeA_fast + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5)) #+ stat_compare_means(method = 'wilcox.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE)

pie_CeA_frak2nM_fast <- CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)') %>% plot_pie2(AHPf1_all, mtitle = "CX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
#pie_CeA_frak5nM_fast <- CeA_df_final %>% filter(Experiment == 'CX3CL1(5nM)') %>% plot_pie2(AHPf1_all, mtitle = "CX3CL1(5nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_azdfrak_fast <- CeA_df_final %>% filter(Experiment == 'AZD8797 + \nCX3CL1(2nM)') %>% plot_pie2(AHPf1_all, mtitle = "AZD8797 + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_azd_fast <- CeA_df_final %>% filter(Experiment == "AZD8797") %>% plot_pie2(AHPf1_all, mtitle = "AZD8797") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_minofrak_fast <- CeA_df_final %>% filter(Experiment == "minocycline + \nCX3CL1(2nM)") %>% plot_pie2(AHPf1_all, mtitle = "minocycline + \nCX3CL1(2nM)") + theme(plot.title = element_text(size= 10, hjust = 0.5))
pie_CeA_mino_fast <- CeA_df_final %>% filter(Experiment == 'minocycline') %>% plot_pie2(AHPf1_all, mtitle = "minocycline") + theme(plot.title = element_text(size= 10, hjust = 0.5))


figure1 <- ggarrange(ggarrange(bp_CeA_gain, nrow =1), #fiLFt row - gain
                     ggarrange(pie_CeA_frak2nM_gain,  pie_CeA_azdfrak_gain, pie_CeA_azd_gain, pie_CeA_minofrak_gain, pie_CeA_mino_gain, nrow = 1, common.legend = TRUE, legend = 'bottom'), # pie charts - gain
                     ggarrange(bp_CeA_thres, nrow =1), #fiLFt row - thres
                     ggarrange(pie_CeA_frak2nM_thres,  pie_CeA_azdfrak_thres, pie_CeA_azd_thres, pie_CeA_minofrak_thres, pie_CeA_mino_thres, nrow = 1, common.legend = TRUE, legend = 'bottom'), # pie charts - thres
                     ggarrange(bp_CeA_adap, nrow =1), #fiLFt row - adap
                     ggarrange(pie_CeA_frak2nM_adap,  pie_CeA_azdfrak_adap, pie_CeA_azd_adap, pie_CeA_minofrak_adap, pie_CeA_mino_adap, nrow = 1, common.legend = TRUE, legend = 'bottom'), # pie charts - adap
                     ggarrange(bp_CeA_rm, nrow =1), #fiLFt row - rm
                     ggarrange(pie_CeA_frak2nM_rm, pie_CeA_azdfrak_rm, pie_CeA_azd_rm, pie_CeA_minofrak_rm, pie_CeA_mino_rm, nrow = 1, common.legend = TRUE, legend = 'bottom'), # pie charts - rm
                     ggarrange(bp_CeA_tau, nrow =1), #fiLFt row - tau
                     ggarrange(pie_CeA_frak2nM_tau,  pie_CeA_azdfrak_tau, pie_CeA_azd_tau, pie_CeA_minofrak_tau, pie_CeA_mino_tau, nrow = 1, common.legend = TRUE, legend = 'bottom'), # pie charts - tau
                     ggarrange(bp_CeA_cap, nrow =1), #fiLFt row - cap
                     ggarrange(pie_CeA_frak2nM_cap,  pie_CeA_azdfrak_cap, pie_CeA_azd_cap, pie_CeA_minofrak_cap, pie_CeA_mino_cap, nrow = 1, common.legend = TRUE, legend = 'bottom'), # pie charts - cap
                     ggarrange(bp_CeA_vm, nrow =1), #fiLFt row - vm
                     ggarrange(pie_CeA_frak2nM_vm,  pie_CeA_azdfrak_vm, pie_CeA_azd_vm, pie_CeA_minofrak_vm, pie_CeA_mino_vm, nrow = 1, common.legend = TRUE, legend = 'bottom'), # pie charts - vm
                     ggarrange(bp_CeA_apw, nrow =1), #fiLFt row - apw
                     ggarrange(pie_CeA_frak2nM_apw,  pie_CeA_azdfrak_apw, pie_CeA_azd_apw, pie_CeA_minofrak_apw, pie_CeA_mino_apw, nrow = 1, common.legend = TRUE, legend = 'bottom'), # pie charts - apw
                     ggarrange(bp_CeA_apa, nrow =1), #fiLFt row - apa
                     ggarrange(pie_CeA_frak2nM_apa,  pie_CeA_azdfrak_apa, pie_CeA_azd_apa, pie_CeA_minofrak_apa, pie_CeA_mino_apa, nrow = 1, common.legend = TRUE, legend = 'bottom'), # pie charts - apa
                     ggarrange(bp_CeA_fast, nrow =1), #fiLFt row - fast
                     ggarrange(pie_CeA_frak2nM_fast,  pie_CeA_azdfrak_fast, pie_CeA_azd_fast, pie_CeA_minofrak_fast, pie_CeA_mino_fast, nrow = 1, common.legend = TRUE, legend = 'bottom'), # pie charts - fast
                     ggarrange(bp_CeA_sag, nrow =1), #fiLFt row - sag
                     ggarrange(pie_CeA_azd_sag, pie_CeA_minofrak_sag, pie_CeA_mino_sag, nrow = 1, common.legend = TRUE, legend = 'bottom'), # pie charts - sag
                     nrow = 22, heights = c(1, 0.8, 1, 0.8, 1, 0.8, 1, 0.8, 1, 0.8, 1, 0.8, 1, 0.8, 1, 0.8, 1, 0.8, 1, 0.8, 1, 0.8))
figure1

### making representative plots 
## frak2nM
frak2nM_IV_subset <- BLA_df_final %>% filter(Experiment == "CX3CL1(2nM)" & Cell %in% c(7)) # subtracting one representative cell from whole dataframe
frak2nM_IV_subset$Filename_all1[frak2nM_IV_subset$Filename_all1 == "18227023"] = "CX3CL1(2nM)" #renaming the name - instead the name of the file - the name of the condition
representative_frak2nM <- frak2nM_IV_subset %>% plot_IV_individual(mtitle = "") + theme(strip.text = element_text(size = 11, face="bold"), strip.background = element_blank(), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm")) # making a plot
# ## importing traces
# 
# ## azdfrak2nM
azdfrak2nM_IV_subset <- BLA_df_final %>% filter(Experiment == "AZD8797 + \nCX3CL1(2nM)") %>% filter(Cell %in% c(30))
azdfrak2nM_IV_subset$Filename_all1[azdfrak2nM_IV_subset$Filename_all1 == "19d02002"] = "AZD8797 + \nCX3CL1(2nM)"
representative_azdfrak2nM <- azdfrak2nM_IV_subset %>% plot_IV_individual(mtitle = "") + theme(strip.text = element_text(size = 11, face="bold"), strip.background = element_blank(), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm")) #+ xlim(300, 500) + ylim(0, 12)
# 
## minofrak2nM
minofrak2nM_IV_subset <- BLA_df_final %>% filter(Experiment == "minocycline + \nCX3CL1(2nM)") %>% filter(Cell %in% c(42))
minofrak2nM_IV_subset$Filename_all1[minofrak2nM_IV_subset$Filename_all1 == "17d07008"] = "minocycline + \nCX3CL1(2nM)"
representative_minofrak2nM <- minofrak2nM_IV_subset %>% plot_IV_individual(mtitle = "") + theme(strip.text = element_text(size = 11, face="bold"), strip.background = element_blank(), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm")) + xlim(260, 500)
# 
## gaba
gabafrak2nM_IV_subset <- BLA_df_final %>% filter(Experiment == "picrotoxin + \nCGP52432 + \nCX3CL1(2nM)") %>% filter(Cell %in% c(55))
gabafrak2nM_IV_subset$Filename_all1[gabafrak2nM_IV_subset$Filename_all1 == "20605006"] = "picrotoxin + \nCGP52432 + \nCX3CL1(2nM)"
representative_gabafrak2nM <- gabafrak2nM_IV_subset %>% plot_IV_individual(mtitle = "") + theme(strip.text = element_text(size = 11, face="bold"), strip.background = element_blank(), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm"))

### general representative IV figure
figure_IV <- representative_frak2nM | representative_azdfrak2nM | representative_minofrak2nM | representative_gabafrak2nM

#using patchwork to do layout of the figure

# f_labels_BLA_thres_add <- data.frame(Experiment = c( c(  "AZD8797", "minocycline" )), label = c("", "*"))
# f_labels_BLA_thres_add$Experiment <- factor(f_labels_BLA_thres_add$Experiment, levels = c( "AZD8797",  "minocycline"))
# 
#  + geom_text(x = 1.5, y = -20, aes(label = label, color = NULL, group= NULL), data = f_labels_BLA_thres_add, size=12, face = 'bold') 

figure1 <-  ((inset_frak2nM | inset_frak5nM | inset_ab | inset_azdfrak2nM | inset_minofrak2nM | inset_gaba)  + plot_layout(tag_level = 'new')) /
 (bp_BLA_thres + theme(legend.position = "none"))  /
  (((pie_BLA_frak_thres | pie_BLA_frak5nM_thres | pie_BLA_antifrak_thres | pie_BLA_azdfrak_thres | pie_BLA_minofrak_thres | pie_BLA_picro_thres)  + plot_layout(tag_level = 'new')) +  plot_layout(guides = "collect") & theme(legend.position = "bottom")) / 
  (((((representative_frak2nM | representative_azdfrak2nM | representative_minofrak2nM | representative_gabafrak2nM) + plot_layout(tag_level = 'new')) +   plot_layout(tag_level = 'new')) + plot_layout(guides = "collect") & theme(legend.position = "right")))  +
    (IV_representative_frak2nM | IV_representative_azdfrak2nM | IV_representative_minofrak2nM | IV_representative_gabafrak2nM)


figure1 <- figure1 + 
  plot_annotation(tag_levels = c('a', '1')) + plot_layout(heights = c(0.3, 0.7, 1, 0.5, 1))

figure1

 
```
 
#### Excitatory synaptic transmission in the CeL and its effect by CX3CL12

Considering the observed reduction in RS cells' excitability, 


 Neurons in both regions also make extensive local connections (McDonald, 1982; Sun and Cassell, 1993; Jolkkonen and Pitkänen, 1998), with local glutamate excitation of CeL neurons evoking IPSCs in neighboring neurons (Lopez de Armentia and Sah, 2004).

#### Effects of CX3CL1 on the inhibitory synaptic transmission in the CeL

<!-- two major classes of CeL neurons with distinct firing patterns,-->