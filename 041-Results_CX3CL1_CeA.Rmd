## CX3CL1/CX3CR1 signaling in the central amygdala

Principal cells in the basolateral nucleus of the amygdala send their projections to the central nucleus (see: Introduction \@ref(CeA)). 
However, the basolateral and central complexes of the amygdala participate in different extended circuitries.
Hence, CX3CL1 may differentially regulate these networks. 
Thus, to gain insight into the CX3CL1-mediated regulation of the CeA circuitry, its functional consequences in CeL circuitry was examined.<!--the next step was to asses the cellular localization of CX3CL1 and its receptor, as well as their  electrophysiological effects. /// to gain insight into the CX3CL1-mediated regulation of the CeA circuitry, we examined the functional characteristic of the IPSCs in DG granule cells (Figure 1) and CA3 pyramidal neurons (Figure 2) in the dorsal and ventral hippocampus.  zmienić oczywiście...// they have different connectivity patterns -->

### Modulation of intrinsic membrane properties of CeL neurons by CX3CL1 in the cell-type specific manner

```{r CX3CL1CeAexcitabilitystats, include = FALSE}
# getting the table of statistics for all CeA df (LF + RS) condition of one experiment
CX3CL1_CeA_stat_all <- stat_table_exp_membr_extended((CeA_df_final))
CX3CL1_CeA_stat_2nM_all <- stat_table_exp_membr_extended(CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)'))
CX3CL1_CeA_stat_azdfrak2nM_all <- stat_table_exp_membr_extended(CeA_df_final %>% filter(Experiment == 'AZD8797 + \nCX3CL1(2nM)'))
CX3CL1_CeA_stat_minofrak2nM_all <- stat_table_exp_membr_extended(CeA_df_final %>% filter(Experiment == 'minocycline + \nCX3CL1(2nM)'))
# selecting a stat_row so it prints nicely in text
CX3CL1_CeA_stat_all_gain <- as.data.frame(CX3CL1_CeA_stat_all %>% dplyr::filter(Variable == 'gain') %>% dplyr::select(Statistics))
CX3CL1_CeA_stat_frak2nM_gain <- CX3CL1_CeA_stat_all_gain$Statistics[1]
CX3CL1_CeA_stat_azdfrak_gain <- CX3CL1_CeA_stat_all_gain$Statistics[2]
CX3CL1_CeA_stat_azd_gain <- CX3CL1_CeA_stat_all_gain$Statistics[3]
CX3CL1_CeA_stat_minofrak_gain <- CX3CL1_CeA_stat_all_gain$Statistics[4]
CX3CL1_CeA_stat_mino_gain <- CX3CL1_CeA_stat_all_gain$Statistics[5]

CX3CL1_CeA_stat_all_Rm <- as.data.frame(CX3CL1_CeA_stat_all %>% dplyr::filter(Variable == 'Input_resistance') %>% dplyr::select(Statistics)) 
CX3CL1_CeA_stat_frak2nM_Rm <- CX3CL1_CeA_stat_all_Rm$Statistics[1]
CX3CL1_CeA_stat_azdfrak_Rm <- CX3CL1_CeA_stat_all_Rm$Statistics[2]
CX3CL1_CeA_stat_azd_Rm <- CX3CL1_CeA_stat_all_Rm$Statistics[3]
CX3CL1_CeA_stat_minofrak_Rm <- CX3CL1_CeA_stat_all_Rm$Statistics[4]
CX3CL1_CeA_stat_mino_Rm <- CX3CL1_CeA_stat_all_Rm$Statistics[5]

CX3CL1_CeA_stat_all_tau <- as.data.frame(CX3CL1_CeA_stat_all %>% dplyr::filter(Variable == 'tau') %>% dplyr::select(Statistics))
CX3CL1_CeA_stat_frak2nM_tau <- CX3CL1_CeA_stat_all_tau$Statistics[1]
CX3CL1_CeA_stat_azdfrak_tau <- CX3CL1_CeA_stat_all_tau$Statistics[2]
CX3CL1_CeA_stat_azd_tau <- CX3CL1_CeA_stat_all_tau$Statistics[3]
CX3CL1_CeA_stat_minofrak_tau <- CX3CL1_CeA_stat_all_tau$Statistics[4]
CX3CL1_CeA_stat_mino_tau <- CX3CL1_CeA_stat_all_tau$Statistics[5]

CX3CL1_CeA_stat_all_Vm <- as.data.frame(CX3CL1_CeA_stat_all %>% dplyr::filter(Variable == 'Vm') %>% dplyr::select(Statistics))
CX3CL1_CeA_stat_frak2nM_Vm <- CX3CL1_CeA_stat_all_Vm$Statistics[1]
CX3CL1_CeA_stat_azdfrak_Vm <- CX3CL1_CeA_stat_all_Vm$Statistics[2]
CX3CL1_CeA_stat_azd_Vm <- CX3CL1_CeA_stat_all_Vm$Statistics[3]
CX3CL1_CeA_stat_minofrak_Vm <- CX3CL1_CeA_stat_all_Vm$Statistics[4]
CX3CL1_CeA_stat_mino_Vm <- CX3CL1_CeA_stat_all_Vm$Statistics[5]

#### RS
CX3CL1_CeA_stat_RS <- stat_table_exp_membr_extended((CeA_df_final_RS))

# selecting a stat_row so it prints nicely in text
CX3CL1_CeA_stat_RS_all_gain <- as.data.frame(CX3CL1_CeA_stat_RS %>% dplyr::filter(Variable == 'gain') %>% dplyr::select(Statistics))
CX3CL1_CeA_stat_frak2nM_RS_gain <- CX3CL1_CeA_stat_RS_all_gain$Statistics[1]
CX3CL1_CeA_stat_azdfrak_RS_gain <- CX3CL1_CeA_stat_RS_all_gain$Statistics[2]
CX3CL1_CeA_stat_azd_RS_gain <- CX3CL1_CeA_stat_RS_all_gain$Statistics[3]
CX3CL1_CeA_stat_minofrak_RS_gain <- CX3CL1_CeA_stat_RS_all_gain$Statistics[4]
CX3CL1_CeA_stat_mino_RS_gain <- CX3CL1_CeA_stat_RS_all_gain$Statistics[5]

CX3CL1_CeA_stat_RS_all_Rm <- as.data.frame(CX3CL1_CeA_stat_RS %>% dplyr::filter(Variable == 'Input_resistance') %>% dplyr::select(Statistics)) 
CX3CL1_CeA_stat_frak2nM_RS_Rm <- CX3CL1_CeA_stat_RS_all_Rm$Statistics[1]
CX3CL1_CeA_stat_azdfrak_RS_Rm <- CX3CL1_CeA_stat_RS_all_Rm$Statistics[2]
CX3CL1_CeA_stat_azd_RS_Rm <- CX3CL1_CeA_stat_RS_all_Rm$Statistics[3]
CX3CL1_CeA_stat_minofrak_RS_Rm <- CX3CL1_CeA_stat_RS_all_Rm$Statistics[4]
CX3CL1_CeA_stat_mino_RS_Rm <- CX3CL1_CeA_stat_RS_all_Rm$Statistics[5]

CX3CL1_CeA_stat_RS_all_tau <- as.data.frame(CX3CL1_CeA_stat_RS %>% dplyr::filter(Variable == 'tau') %>% dplyr::select(Statistics))
CX3CL1_CeA_stat_frak2nM_RS_tau <- CX3CL1_CeA_stat_RS_all_tau$Statistics[1]
CX3CL1_CeA_stat_azdfrak_RS_tau <- CX3CL1_CeA_stat_RS_all_tau$Statistics[2]
CX3CL1_CeA_stat_azd_RS_tau <- CX3CL1_CeA_stat_RS_all_tau$Statistics[3]
CX3CL1_CeA_stat_minofrak_RS_tau <- CX3CL1_CeA_stat_RS_all_tau$Statistics[4]
CX3CL1_CeA_stat_mino_RS_tau <- CX3CL1_CeA_stat_RS_all_tau$Statistics[5]

CX3CL1_CeA_stat_RS_all_Vm <- as.data.frame(CX3CL1_CeA_stat_RS %>% dplyr::filter(Variable == 'Vm') %>% dplyr::select(Statistics))
CX3CL1_CeA_stat_frak2nM_RS_Vm <- CX3CL1_CeA_stat_RS_all_Vm$Statistics[1]
CX3CL1_CeA_stat_azdfrak_RS_Vm <- CX3CL1_CeA_stat_RS_all_Vm$Statistics[2]
CX3CL1_CeA_stat_azd_RS_Vm <- CX3CL1_CeA_stat_RS_all_Vm$Statistics[3]
CX3CL1_CeA_stat_minofrak_RS_Vm <- CX3CL1_CeA_stat_RS_all_Vm$Statistics[4]
CX3CL1_CeA_stat_mino_RS_Vm <- CX3CL1_CeA_stat_RS_all_Vm$Statistics[5]


#### LF
CX3CL1_CeA_stat_LF <- stat_table_exp_membr_extended((CeA_df_final_LF))

# selecting a stat_row so it prints nicely in text
CX3CL1_CeA_stat_LF_all_gain <- as.data.frame(CX3CL1_CeA_stat_LF %>% dplyr::filter(Variable == 'gain') %>% dplyr::select(Statistics))
CX3CL1_CeA_stat_frak2nM_LF_gain <- CX3CL1_CeA_stat_LF_all_gain$Statistics[1]
CX3CL1_CeA_stat_azdfrak_LF_gain <- CX3CL1_CeA_stat_LF_all_gain$Statistics[2]
CX3CL1_CeA_stat_azd_LF_gain <- CX3CL1_CeA_stat_LF_all_gain$Statistics[3]
CX3CL1_CeA_stat_minofrak_LF_gain <- CX3CL1_CeA_stat_LF_all_gain$Statistics[4]
CX3CL1_CeA_stat_mino_LF_gain <- CX3CL1_CeA_stat_LF_all_gain$Statistics[5]

CX3CL1_CeA_stat_LF_all_Rm <- as.data.frame(CX3CL1_CeA_stat_LF %>% dplyr::filter(Variable == 'Input_resistance') %>% dplyr::select(Statistics)) 
CX3CL1_CeA_stat_frak2nM_LF_Rm <- CX3CL1_CeA_stat_LF_all_Rm$Statistics[1]
CX3CL1_CeA_stat_azdfrak_LF_Rm <- CX3CL1_CeA_stat_LF_all_Rm$Statistics[2]
CX3CL1_CeA_stat_azd_LF_Rm <- CX3CL1_CeA_stat_LF_all_Rm$Statistics[3]
CX3CL1_CeA_stat_minofrak_LF_Rm <- CX3CL1_CeA_stat_LF_all_Rm$Statistics[4]
CX3CL1_CeA_stat_mino_LF_Rm <- CX3CL1_CeA_stat_LF_all_Rm$Statistics[5]

CX3CL1_CeA_stat_LF_all_tau <- as.data.frame(CX3CL1_CeA_stat_LF %>% dplyr::filter(Variable == 'tau') %>% dplyr::select(Statistics))
CX3CL1_CeA_stat_frak2nM_LF_tau <- CX3CL1_CeA_stat_LF_all_tau$Statistics[1]
CX3CL1_CeA_stat_azdfrak_LF_tau <- CX3CL1_CeA_stat_LF_all_tau$Statistics[2]
CX3CL1_CeA_stat_azd_LF_tau <- CX3CL1_CeA_stat_LF_all_tau$Statistics[3]
CX3CL1_CeA_stat_minofrak_LF_tau <- CX3CL1_CeA_stat_LF_all_tau$Statistics[4]
CX3CL1_CeA_stat_mino_LF_tau <- CX3CL1_CeA_stat_LF_all_tau$Statistics[5]

CX3CL1_CeA_stat_LF_all_Vm <- as.data.frame(CX3CL1_CeA_stat_LF %>% dplyr::filter(Variable == 'Vm') %>% dplyr::select(Statistics))
CX3CL1_CeA_stat_frak2nM_LF_Vm <- CX3CL1_CeA_stat_LF_all_Vm$Statistics[1]
CX3CL1_CeA_stat_azdfrak_LF_Vm <- CX3CL1_CeA_stat_LF_all_Vm$Statistics[2]
CX3CL1_CeA_stat_azd_LF_Vm <- CX3CL1_CeA_stat_LF_all_Vm$Statistics[3]
CX3CL1_CeA_stat_minofrak_LF_Vm <- CX3CL1_CeA_stat_LF_all_Vm$Statistics[4]
CX3CL1_CeA_stat_mino_LF_Vm <- CX3CL1_CeA_stat_LF_all_Vm$Statistics[5]
```


The next step was to investigate whether reduced excitability of CX3CL1 in the BLA<!--,together with ....,-->would affect the membrane properties of their main target, i.e., GABAergic cells in the CeL.
<!-- razem z tym, że on sam też może mieć udział... --> 
To this end, among others, electrophysiological features such as excitability, input resistance, membrane time constant, and resting membrane potential, were measured (see: Methods \@ref(electroprotocols)).<!-- analogous to the neurons in the BLA./// recorded using a whole-cell patch-clamp approach, in a current-clamp configuration.-->

In general, these experiments revealed that several membrane properties in the CeL neurons were significantly modified by CX3CL1 (see Figs. \@ref(fig:CX3CL1CeAVmexc) and \@ref(fig:CX3CL1CeARmtau)). 
However, given that CeL neurons demonstrate mainly two types of electrophysiological firing patterns, such as Regular-Spiking and Late-Firing neurons (see: Introduction \@ref(CeA) and Fig. \@ref(fig:methodsBLACeAIVrep)b),<!-- which was also confirmed by cluster analysis from recorded CeL cells as a part of this dissertation,comprises neurons of two main electrophysiological types // La  ter studies further characterized at least four main physiological types of neurons in the CeA, distinguished based on their responses to intracellular current injections.--> these intrinsic parameters were further analyzed  by these neuronal subtypes.<!--divided?--><!-- odnośnik do góry i lepiej napisać// segregated those neurons according to their types.-->
Intriguingly, while LF cells remained unaffected (see Figs. \@ref(fig:CX3CL1CeAVmexc) and \@ref(fig:CX3CL1CeARmtau), right panels), most RS neurons were responsive to CX3CL1 application, which was reflected by robust changes in their intrinsic properties (Figs. \@ref(fig:CX3CL1CeAVmexc) and \@ref(fig:CX3CL1CeARmtau), middle panels).<!-- , implying that much higher proportion of RS cells was reactive to CX3CL1-->
Specifically, similar to what was observed in the BLA, bath application of CX3CL1 (2nM) produced a <!--reversible--> decrease in the number of action potentials evoked by a given current step, manifested as a decrease in the gain (baseline = `r round(CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)' & Type == "RS" & Condition == "baseline") %>% ungroup() %>% summarize(mean(gain)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)' & Type == "RS"  & Condition == "baseline") %>% ungroup() %>% dplyr::summarize(x = sd(gain), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)`, CX3CL1(2nM) = `r round(CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)' & Type == "RS"  & Condition == "CX3CL1") %>% ungroup() %>% summarize(mean(gain)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)' & Type == "RS"  & Condition == "CX3CL1") %>% ungroup() %>% dplyr::summarize(x = sd(gain), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)`, `r CX3CL1_CeA_stat_frak2nM_RS_gain`, see Fig. \@ref(fig:CX3CL1CeAVmexc)).<!--  We injected a series of depolarizing current steps to assess the number of action potentials (Figure 4a – c). Repeated-measure ANOVA revealed that projection neurons fired significantly less after NF knockdown-->
This effect was accompanied by a reduced input resistance (`r CX3CL1_CeA_stat_frak2nM_RS_Rm`) and membrane time constant (`r CX3CL1_CeA_stat_frak2nM_RS_tau`; Fig. \@ref(fig:CX3CL1CeARmtau), middle panel).
Moreover, resting membrane potentials of Resular-Spiking CeL neurons become more depolarized in response to bath-applied 2nM CX3CL1, being `r round(CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)' & Type == "RS" & Condition == "baseline") %>% ungroup() %>% summarize(mean(RMS)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)' & Type == "RS"  & Condition == "baseline") %>% ungroup() %>% dplyr::summarize(x = sd(RMS), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)` at baseline and reaching `r round(CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)' & Type == "RS" & Condition == "CX3CL1") %>% ungroup() %>% summarize(mean(RMS)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_df_final %>% filter(Experiment == 'CX3CL1(2nM)' & Type == "RS" & Condition == "CX3CL1") %>% ungroup() %>% dplyr::summarize(x = sd(RMS), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)`, `r CX3CL1_CeA_stat_frak2nM_RS_Vm` after CX3CL1 application (Fig. \@ref(fig:CX3CL1CeAVmexc)a2).<!-- In response to bath-applied agonists, the depolarization is strong enough that it is capable of producing prolonged spiking ( Beierlein et al., 2000; Fanselow et al., 2008; Kawaguchi, 1997; Xu et al., 2013 ).-->

AZD8797 alone did not significantly change any of those parameters (see Fig. \@ref(fig:AZDCeAmembrappendix) in Appendix \@ref(CX3CL1CeAmembrappendix)).
All measured parameters and statistics are summarized in Table <!--?-->.

```{r CX3CL1CeAVmexc, fig.cap='**Effects of CX3CL1 on resting membrane potential and excitability of CeL neurons** **(a1)** Boxplots presenting membrane resting potential of each cell before and after CX3CL1 application in all CeL neurons (right), Regular-Spiking neurons (middle), and Late-Firing neurons (left). **(a2)** Boxplots presenting a gain of each cell before and after CX3CL1 application in all CeL neurons (right), Regular-Spiking neurons (middle), and Late-Firing neurons (left). Boxplots showing a resting membrane potential **(b1)** and a gain **(b2)** of each cell before and after CX3CL1 application in Regular-Spiking neurons across different conditions. **(c1)** Input-Output relationship of a representative Regular-Spiking neuron illustrating its excitability before (baseline) and after CX3CL1 treatment. **(c2)** Voltage traces from the same representative cells. They represent the highlighted by orange dots from the previous plot. **(d1)** Input-Output relationship of a representative Regular-Spiking neuron illustrating its excitability before (baseline) and after CX3CL1 treatment in the presence of AZD8797, the blocker of CX3CL1 receptor. **(d2)** Voltage traces from the same representative cells. They represent the highlighted by orange dots from the previous plot. **(e1)** Input-Output relationship of a representative Regular-Spiking neuron illustrating its excitability before (baseline) and after CX3CL1 treatment in the presence of minocycline, the blocker of microglial activity. **(e2)** Voltage traces from the same representative cells. They represent the highlighted by orange dots from the previous plot. Scale bar: 10mV, 100ms', fig.align = 'center', echo = FALSE, message= FALSE, warning= FALSE, fig.width= 12, fig.height= 10}

#knitr::include_graphics("images/results//CX3CL1_BLA_excitability.png")
#knitr::include_graphics("images/results//CX3CL1_BLA_excitability.png")

inset_frak2nM <- image_read("images//results//inset_frak2nM.png")
inset_frak2nM <- image_ggplot(inset_frak2nM)
inset_azdfrak2nM <- image_read("images//results//inset_azdfrak2nM.png")
inset_azdfrak2nM <- image_ggplot(inset_azdfrak2nM)
inset_azda <- image_read("images//results//inset_azd.png")
inset_azda <- image_ggplot(inset_azda)
inset_minofrak2nM <- image_read("images//results//inset_minofrak2nM.png")
inset_minofrak2nM <- image_ggplot(inset_minofrak2nM)
inset_minoa <- image_read("images//results//inset_minoa.png")
inset_minoa <- image_ggplot(inset_minoa)


# making group of 3 types of neurons (CeL, RS, LF)
CeA_df_final_fin <- CeA_df_final %>% dplyr::filter(Experiment %in% c("CX3CL1(2nM)")) %>% dplyr::mutate(Var = "CeL neurons")
CeA_df_final_fin_RS <- CeA_df_final_RS %>% dplyr::filter(Experiment %in% c("CX3CL1(2nM)")) %>% dplyr::mutate(Var = "Regular Spiking \nneurons")
CeA_df_final_fin_LF <- CeA_df_final_LF %>% dplyr::filter(Experiment %in% c("CX3CL1(2nM)"))  %>% dplyr::mutate(Var = "Late Firing \nneurons")

CeA_df_fin_fin <- CeA_df_final_fin %>% dplyr::bind_rows(CeA_df_final_fin_RS) %>% dplyr::bind_rows(CeA_df_final_fin_LF)
CeA_df_fin_fin$Var <- factor(CeA_df_fin_fin$Var, levels = c("CeL neurons", "Regular Spiking \nneurons", "Late Firing \nneurons")) 

## subsetting only CX3CL1 conditions
CeA_df_final_sub <- CeA_df_final %>% dplyr::filter(Experiment %in% c("CX3CL1(2nM)", "AZD8797 + \nCX3CL1(2nM)", "minocycline + \nCX3CL1(2nM)"))
CeA_df_final_sub_RS <- CeA_df_final_RS %>% dplyr::filter(Experiment %in% c("CX3CL1(2nM)", "AZD8797 + \nCX3CL1(2nM)", "minocycline + \nCX3CL1(2nM)"))
CeA_df_final_sub_LF <- CeA_df_final_LF %>% dplyr::filter(Experiment %in% c("CX3CL1(2nM)", "AZD8797 + \nCX3CL1(2nM)", "minocycline + \nCX3CL1(2nM)"))


# GENERAL - RESTING MEMBRANE POTENTIAL
bp_CeA_vm <- plot_boxplot(CeA_df_fin_fin, RMS, mtitle= "Resting Membrane Potential regarding\n electrophysiological type", ylabel = "Resting membrane potential (mV)", vary1 = -80, vary2 = -25, dot_size = 2)
bp_CeA_vm <- bp_CeA_vm + facet_wrap(~ Var, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5),
 strip.text = element_text(size = 11, face="bold"), strip.background = element_blank()) + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE,  size = 10, face = "bold", label.y = -35)

# GAIN
bp_CeA_gain <- plot_boxplot(CeA_df_fin_fin, gain, mtitle= "Gain regarding\n electrophysiological type", ylabel = "gain",  dot_size = 2)
bp_CeA_gain <- bp_CeA_gain + facet_wrap(~ Var, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5),
 strip.text = element_text(size = 11, face="bold"), strip.background = element_blank()) + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE,  size = 10, face = "bold", label.y = 0.25)



bp_CeA_vm_RS <- plot_boxplot(CeA_df_final_sub_RS, RMS, mtitle= "CeL - \nRegular Spiking Neurons", ylabel = "Resting membrane potential (mV)", vary1 = -80, vary2 = -25, dot_size = 2)
bp_CeA_vm_RS <- bp_CeA_vm_RS + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5),
 strip.text = element_text(size = 11, face="bold"), strip.background = element_blank())  + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE,  size = 10, face = "bold", label.y = -35)

bp_CeA_vm_LF <- plot_boxplot(CeA_df_final_sub_LF, RMS, mtitle= "CeL - \nLate Firing Neurons", ylabel = "Resting membrane potential (mV)", vary1 = -80, vary2 = -25, dot_size = 2)
bp_CeA_vm_LF <- bp_CeA_vm_LF + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5),
 strip.text = element_text(size = 11, face="bold"), strip.background = element_blank())

bp_CeA_gain_RS <- plot_boxplot(CeA_df_final_sub_RS, gain, mtitle= "", ylabel = "gain",  dot_size = 2)
bp_CeA_gain_RS <- bp_CeA_gain_RS + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5),
 strip.text = element_text(size = 11, face="bold"), strip.background = element_blank()) + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE,  size = 10, face = "bold", label.y = 0.22)

bp_CeA_gain_LF <- plot_boxplot(CeA_df_final_sub_LF, gain, mtitle= "", ylabel = "gain",  dot_size = 2)
bp_CeA_gain_LF <- bp_CeA_gain_LF + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5),
 strip.text = element_text(size = 11, face="bold"), strip.background = element_blank()) + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE,  size = 10, face = "bold", label.y = 0.25)


### making representative plots 
## frak2nM
frak2nM_IV_subset <- CeA_df_final %>% filter(Experiment == "CX3CL1(2nM)" & Cell %in% c(20)) # subtracting one representative cell from whole dataframe
frak2nM_IV_subset$Filename_all1[frak2nM_IV_subset$Filename_all1 == "21303018"] = "" #renaming the name - instead the name of the file - the name of the condition
representative_frak2nM <- frak2nM_IV_subset %>% plot_IV_individual(mtitle = "") + theme(strip.text = element_text(size = 11, face="bold"), strip.background = element_blank(), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm")) # making a plot
# ## importing traces  
# 
# ## azdfrak2nM
azdfrak2nM_IV_subset <- CeA_df_final %>% filter(Experiment == "AZD8797 + \nCX3CL1(2nM)") %>% filter(Cell %in% c(24))
azdfrak2nM_IV_subset$Filename_all1[azdfrak2nM_IV_subset$Filename_all1 == "20611001"] = ""
representative_azdfrak2nM <- azdfrak2nM_IV_subset %>% plot_IV_individual(mtitle = "") + theme(strip.text = element_text(size = 11, face="bold"), strip.background = element_blank(), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm")) #+ xlim(300, 500) + ylim(0, 12)
# 
## minofrak2nM
minofrak2nM_IV_subset <- CeA_df_final %>% filter(Experiment == "minocycline + \nCX3CL1(2nM)") %>% filter(Cell %in% c(43))
minofrak2nM_IV_subset$Filename_all1[minofrak2nM_IV_subset$Filename_all1 == "20703013"] = ""
representative_minofrak2nM <- minofrak2nM_IV_subset %>% plot_IV_individual(mtitle = "") + theme(strip.text = element_text(size = 11, face="bold"), strip.background = element_blank(), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm")) #+ xlim(260, 500)
# 
#powinny być nowe IV_representative_minoa <- fig("images//results//IV_representative_minoa.png", aspect.ratio = "free", b_pos = "inside", b_size = 0, b_margin =  ggplot2::margin(0, 0, 0, 0))
traces_frak2nM <- fig("images//results//CX3CL1_CeA_IV_traces_frak2nM.png", aspect.ratio = "free", b_pos = "inside", b_size = 0, b_margin =  ggplot2::margin(0, 0, 0, 0))
traces_azdfrak <- fig("images//results//CX3CL1_CeA_IV_traces_azdfrak.png", aspect.ratio = "free", b_pos = "inside", b_size = 0, b_margin =  ggplot2::margin(0, 0, 0, 0))
traces_minofrak <- fig("images//results//CX3CL1_CeA_IV_traces_minofrak.png", aspect.ratio = "free", b_pos = "inside", b_size = 0, b_margin =  ggplot2::margin(0, 0, 0, 0))

### general representative IV figure
#figure_IV <- representative_frak2nM | representative_azdfrak2nM | representative_minofrak2nM

#using patchwork to do layout of the figure

A <- ((bp_CeA_vm | bp_CeA_gain) + plot_layout(tag_level = "new"))
B <- ((bp_CeA_vm_RS| bp_CeA_gain_RS) + plot_layout(tag_level = "new"))
C <- (((representative_frak2nM +  ggtitle('CX3CL1(2nM)'))| traces_frak2nM) + plot_layout(tag_level = "new", widths = c(0.5,1))) 
D <- (((representative_azdfrak2nM +  ggtitle('AZD8797 + CX3CL1(2nM)'))| traces_azdfrak) + plot_layout(tag_level = "new", widths = c(0.5,1))) 
E <- (((representative_minofrak2nM +  ggtitle('minocycline + CX3CL1(2nM)')) | traces_minofrak) + plot_layout(tag_level = "new", widths = c(0.5,1))) 

des <- "
AAA
BBB
CDE
"

fig2 <- wrap_plots(A = A, B= B, C = C, D = D, E = E, design = des)


fig2 <- fig2 + plot_annotation(tag_levels = c('a', '1'))
fig2

```

```{r CX3CL1CeARmtau, fig.cap='**Effects of CX3CL1 on input resistance and membrane time constant** **(a1)** Boxplots showing input resistance of all CeL neurons (left), Regular-Spiking neurons (middle), or Late-Firing neurons (right) before and after CX3CL1 application. **(a2)** Boxplots showing membrane time constant of all CeL neurons (left), Regular-Spiking neurons (middle), or Late-Firing neurons (right) before and after CX3CL1 application. Boxplots showing input resistance **(b1)** and membrane time constant **(b2)** of each Regular-Spiking neuron before and after CX3CL1 application across different conditions. **(c1)** Aligned voltage traces from a representative cell to -20pA injection currents prior to (blue) and after the CX3CL1 application (red), illustrating changes in the input resistance and membrane time constant. **(c2)** Aligned voltage traces from a representative cell to -20pA injection currents prior to (blue) and after the CX3CL1 application (red), illustrating changes in the input resistance and membrane time constant in the presence of AZD8797, a blocker of CX3CL1 receptor. **(c3)** Aligned voltage traces from a representative cell to -20pA injection currents prior to (blue) and after the CX3CL1 application (red), illustrating changes in the input resistance and membrane time constant in the presence of minocycline, a blocker of microglial activity. Scale bar: 10mV, 100ms', fig.align = 'center', echo = FALSE, message= FALSE, warning= FALSE, fig.width= 12, fig.height= 8}

#knitr::include_graphics("images/results//CX3CL1_BLA_excitability.png")
#knitr::include_graphics("images/results//CX3CL1_BLA_excitability.png")

inset_frak2nM <- image_read("images//results//inset_frak2nM.png")
inset_frak2nM <- image_ggplot(inset_frak2nM)
inset_azdfrak2nM <- image_read("images//results//inset_azdfrak2nM.png")
inset_azdfrak2nM <- image_ggplot(inset_azdfrak2nM)
inset_azda <- image_read("images//results//inset_azd.png")
inset_azda <- image_ggplot(inset_azda)
inset_minofrak2nM <- image_read("images//results//inset_minofrak2nM.png")
inset_minofrak2nM <- image_ggplot(inset_minofrak2nM)
inset_minoa <- image_read("images//results//inset_minoa.png")
inset_minoa <- image_ggplot(inset_minoa)

## subsetting only CX3CL1 conditions
# CeA_df_final_sub <- CeA_df_final %>% dplyr::filter(Experiment %in% c("CX3CL1(2nM)", "AZD8797 + \nCX3CL1(2nM)", "minocycline + \nCX3CL1(2nM)"))
# CeA_df_final_sub_RS <- CeA_df_final_RS %>% dplyr::filter(Experiment %in% c("CX3CL1(2nM)", "AZD8797 + \nCX3CL1(2nM)", "minocycline + \nCX3CL1(2nM)"))
# CeA_df_final_sub_LF <- CeA_df_final_LF %>% dplyr::filter(Experiment %in% c("CX3CL1(2nM)", "AZD8797 + \nCX3CL1(2nM)", "minocycline + \nCX3CL1(2nM)"))

# # INPUT RESISTANCE
bp_CeA_rm <- plot_boxplot(CeA_df_fin_fin, Rm_20, mtitle= "Input restistance based on \n electrophysiological type", ylabel = "Input resistance (MOhm)", vary1 = 100, vary2 = 900, dot_size = 2)
bp_CeA_rm <- bp_CeA_rm + facet_wrap(~ Var, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5),
 strip.text = element_text(size = 11, face="bold"), strip.background = element_blank()) + stat_compare_means(method = 'wilcox.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE,  size = 8, face = "bold", label.y = 770)

bp_CeA_tau <- plot_boxplot(CeA_df_fin_fin, tau_20, mtitle= "Time membrane constant based on \n electrophysiological type", ylabel = "tau (ms)", vary1 = 0, vary2 = 40, dot_size = 2)
bp_CeA_tau <- bp_CeA_tau + facet_wrap(~ Var, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5),
 strip.text = element_text(size = 11, face="bold"), strip.background = element_blank()) + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE,  size = 8, face = "bold", label.y = 35)


bp_CeA_rm_RS <- plot_boxplot(CeA_df_final_sub_RS, Rm_20, mtitle= "CeL - \nRegular Spiking Neurons", ylabel = "Input resistance (MOhm)", vary1 = 100, vary2 = 900, dot_size = 2)
bp_CeA_rm_RS <- bp_CeA_rm_RS + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5),
 strip.text = element_text(size = 11, face="bold"), strip.background = element_blank()) + stat_compare_means(method = 'wilcox.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE,  size = 8, face = "bold", label.y = 770)

bp_CeA_rm_LF <- plot_boxplot(CeA_df_final_sub_LF, Rm_20, mtitle= "CeL - \nLate Firing Neurons", ylabel = "Input resistance (MOhm)", vary1 = 100, vary2 = 900, dot_size = 2)
bp_CeA_rm_LF <- bp_CeA_rm_LF + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5),
 strip.text = element_text(size = 11, face="bold"), strip.background = element_blank()) + stat_compare_means(method = 'wilcox.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE,  size = 8, face = "bold", label.y = 770)

# TAU


bp_CeA_tau_RS <- plot_boxplot(CeA_df_final_sub_RS, tau_20, mtitle= "CeL - \nRegular Spiking Neurons", ylabel = "tau (ms)", vary1 = 0, vary2 = 40, dot_size = 2)
bp_CeA_tau_RS <- bp_CeA_tau_RS + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5),
 strip.text = element_text(size = 11, face="bold"), strip.background = element_blank()) + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE,  size = 8, face = "bold", label.y = 35)

bp_CeA_tau_LF <- plot_boxplot(CeA_df_final_sub_LF, tau_20, mtitle= "", ylabel = "tau (ms)", vary1 = 0, vary2 = 40, dot_size = 2)
bp_CeA_tau_LF <- bp_CeA_tau_LF + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5),
 strip.text = element_text(size = 11, face="bold"), strip.background = element_blank()) + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE,  size = 8, face = "bold", label.y = 35)

### making representative plots 

traces_frak2nM <- fig("images//results//CX3CL1_CeA_Rm_CX3CL1_traces.png")
traces_azdfrak <- fig("images//results//CX3CL1_CeA_Rm_AZDCX3CL1_traces.png")
traces_minofrak <- fig("images//results//CX3CL1_CeA_Rm_MINOCX3CL1_traces.png")

#using patchwork to do layout of the figure
A <- ((bp_CeA_rm | bp_CeA_tau) + plot_layout(tag_level = "new"))
B <- ((bp_CeA_rm_RS | bp_CeA_tau_RS) + plot_layout(tag_level = "new"))
C <- (((traces_frak2nM +  ggtitle('CX3CL1(2nM)')) | (traces_azdfrak + ggtitle('AZD8797 + CX3CL1(2nM)')) | (traces_minofrak + ggtitle('minocycline + CX3CL1(2nM)')) + plot_layout(tag_level = "new")))
# D <- ((representative_azdfrak2nM | traces_azdfrak) + plot_layout(tag_level = "new", widths = c(0.5,1)))
# E <- ((representative_minofrak2nM | traces_minofrak) + plot_layout(tag_level = "new", widths = c(0.5,1)))

des <- "
AAA
BBB
CCC
"


fig2 <- wrap_plots(A = A, B= B, C = C, design = des)


fig2 <- fig2 + plot_annotation(tag_levels = c('a', '1'))
fig2

```

```{r minoCeAexcitabilitystats, include = FALSE}
# subseting minocycline experiments

mino_CeA_subset <- CeA_df_final %>% filter(Experiment == 'minocycline')
mino_CeA_subset_RS <- mino_CeA_subset %>% filter(Type == 'RS')
mino_CeA_subset_LF <- mino_CeA_subset %>% filter(Type == 'LF')
# getting the table of statistics for all CeA df (LF + RS) condition of one experiment
mino_CeA_stat_all <- stat_table_exp_membr_extended((mino_CeA_subset))
mino_CeA_stat_RS <- stat_table_exp_membr_extended((mino_CeA_subset_RS))
mino_CeA_stat_LF <- stat_table_exp_membr_extended((mino_CeA_subset_LF))

# selecting a stat_row so it prints nicely in text
mino_CeA_stat_RS_tres <- as.data.frame(mino_CeA_stat_RS %>% dplyr::filter(Variable == 'Threshold') %>% dplyr::select(Statistics))
mino_CeA_stat_LF_tres <- as.data.frame(mino_CeA_stat_LF %>% dplyr::filter(Variable == 'Threshold') %>% dplyr::select(Statistics))

mino_CeA_stat_LF_rm <- as.data.frame(mino_CeA_stat_LF %>% dplyr::filter(Variable == 'Input_resistance') %>% dplyr::select(Statistics))
mino_CeA_stat_LF_cap <- as.data.frame(mino_CeA_stat_LF %>% dplyr::filter(Variable == 'Capacitance') %>% dplyr::select(Statistics))


```

Notably, similar to what was observed in the BLA, minocycline alone also affected the excitability of CeL neurons, especially the Late-Firing subtype (Fig. \@ref(fig:CX3CL1CeAintrinsicmino)).
Specifically, treatment with 100 `r knitr::asis_output("\U03BC")`M minocycline lowered the threshold needed for inducing action potentials in both types of neurons (from `r round(CeA_df_final %>% filter(Experiment == 'minocycline' & Type == 'LF' & Condition == "baseline") %>% ungroup() %>% summarize(mean(Treshold1_all)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_df_final %>% filter(Experiment == 'minocycline' & Type == 'LF' & Condition == "baseline") %>% ungroup() %>% dplyr::summarize(x = sd(Treshold1_all), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)` to `r round(CeA_df_final %>% filter(Experiment == 'minocycline' & Type == 'LF' & Condition == "minocycline") %>% ungroup() %>% summarize(mean(Treshold1_all)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_df_final %>% filter(Experiment == 'minocycline' & Type == 'LF' & Condition == "minocycline") %>% ungroup() %>% dplyr::summarize(x = sd(Treshold1_all), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)`, `r mino_CeA_stat_LF_tres` in Late Firing neurons 
and from `r round(CeA_df_final %>% filter(Experiment == 'minocycline' & Type == 'RS' & Condition == "baseline") %>% ungroup() %>% summarize(mean(Treshold1_all)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_df_final %>% filter(Experiment == 'minocycline' & Type == 'RS' & Condition == "baseline") %>% ungroup() %>% dplyr::summarize(x = sd(Treshold1_all), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)` to `r round(CeA_df_final %>% filter(Experiment == 'minocycline' & Type == 'RS' & Condition == "minocycline") %>% ungroup() %>% summarize(mean(Treshold1_all)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_df_final %>% filter(Experiment == 'minocycline' & Type == 'RS' & Condition == "minocycline") %>% ungroup() %>% dplyr::summarize(x = sd(Treshold1_all), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)`, `r mino_CeA_stat_RS_tres` in Regular Spiking neurons, Fig. \@ref(fig:CX3CL1CeAintrinsicmino)a).
However, minocycline-induced increased input resistance and cell capacitance was observed only in Late-Firing neurons (from `r round(CeA_df_final %>% filter(Experiment == 'minocycline' & Type == 'LF' & Condition == "baseline") %>% ungroup() %>% summarize(mean(Rm_20)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_df_final %>% filter(Experiment == 'minocycline' & Type == 'LF' & Condition == "baseline") %>% ungroup() %>% dplyr::summarize(x = sd(Rm_20), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)` to `r round(CeA_df_final %>% filter(Experiment == 'minocycline' & Type == 'LF' & Condition == "minocycline") %>% ungroup() %>% summarize(mean(Rm_20)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_df_final %>% filter(Experiment == 'minocycline' & Type == 'LF' & Condition == "minocycline") %>% ungroup() %>% dplyr::summarize(x = sd(Rm_20), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)`, `r mino_CeA_stat_LF_rm` and 
from `r round(CeA_df_final %>% filter(Experiment == 'minocycline' & Type == 'LF' & Condition == "baseline") %>% ungroup() %>% summarize(mean(C_20)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_df_final %>% filter(Experiment == 'minocycline' & Type == 'LF' & Condition == "baseline") %>% ungroup() %>% dplyr::summarize(x = sd(C_20), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)` to `r round(CeA_df_final %>% filter(Experiment == 'minocycline' & Type == 'LF' & Condition == "minocycline") %>% ungroup() %>% summarize(mean(C_20)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_df_final %>% filter(Experiment == 'minocycline' & Type == 'LF' & Condition == "minocycline") %>% ungroup() %>% dplyr::summarize(x = sd(C_20), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)`, `r mino_CeA_stat_LF_cap`, respectively; Fig.\@ref(fig:CX3CL1CeAintrinsicmino) b and c).
All measured parameters are summarized in Table <!-- --> in Appendix \@ref(CX3CL1CeAmembrappendix).

```{r CX3CL1CeAintrinsicmino, fig.cap='**Effects of minocycline on intrinsic neuronal properties in CeL neurons based on their type.** **(a-c)** Boxplots presenting threshold currents, input resistance, and cell capacitance of each neuron before and after minocycline application based on their neuronal type. **(d)** Plots presenting input-output relationships of grouped neurons. **(e)** Voltage traces from representative cells to xxx pA injection currents prior to (blue) and after the minocycline application (red). **(f)** Aligned voltage traces of representative cell to hyperpolarizing 20pA current step in order to measure an input resistance and time constant before (blue) and after (red) minocycline application. Scale bar: 10mV, 100ms', fig.align = 'center', echo = FALSE, message= FALSE, echo = FALSE, warning= FALSE, message = FALSE, fig.width= 10, fig.height= 8}

#knitr::include_graphics("images/results//CX3CL1_BLA_excitability.png")
#knitr::include_graphics("images/results//CX3CL1_BLA_excitability.png")


inset_minoa <- image_read("images//results//inset_minoa.png")
inset_minoa <- image_ggplot(inset_minoa)

# making labels (as minocycline and azd has different condition than CX3CL1) for then making proper automatic statistics
# f_labels_BLA_thres <- data.frame(Experiment = c( c("CX3CL1(2nM)" , "CX3CL1(5nM)", 'anti-CX3CR1 + \nCX3CL1(2nM)', "AZD8797 + \nCX3CL1(2nM)", "AZD8797", 'minocycline + \nCX3CL1(2nM)' , "minocycline" , 'picrotoxin + \nCGP52432 + \nCX3CL1(2nM)' )), label = c("", "", "", "", "", "", "*", ""))
# f_labels_BLA_thres$Experiment <- factor(f_labels_BLA_thres$Experiment, levels = c("CX3CL1(2nM)" , "CX3CL1(5nM)", 'anti-CX3CR1 + \nCX3CL1(2nM)', "AZD8797 + \nCX3CL1(2nM)", "AZD8797", 'minocycline + \nCX3CL1(2nM)' , "minocycline" , 'picrotoxin + \nCGP52432 + \nCX3CL1(2nM)'))

## subsetting only mino conditions

CeA_df_mino_sub <- CeA_df_final %>% dplyr::filter(Experiment %in% c("minocycline"))
CeA_df_mino_sub <- CeA_df_mino_sub %>% dplyr::filter(!Type %in% c("OTHER"))
CeA_df_mino_sub <- droplevels(CeA_df_mino_sub)
CeA_df_mino_sub$Type <- plyr::revalue(CeA_df_mino_sub$Type, c("LF"="Late \nFiring", "RS" = "Regular \nSpiking"))
CeA_df_mino_sub_RS <- CeA_df_final_RS %>% dplyr::filter(Experiment %in% c("minocycline"))
CeA_df_mino_sub_LF <- CeA_df_final_LF %>% dplyr::filter(Experiment %in% c("minocycline"))

# THRESHOLD CURRENT

# f_labels_CeA_thres <- data.frame(Experiment = c( c("CX3CL1(2nM)",  "AZD8797 + \nCX3CL1(2nM)", "AZD8797", "minocycline + \nCX3CL1(2nM)" , "minocycline" )), label = c("", "", "*", "", ""))
# f_labels_CeA_thres$Experiment <- factor(f_labels_CeA_thres$Experiment, levels = c("CX3CL1(2nM)", "AZD8797 + \nCX3CL1(2nM)", "AZD8797", "minocycline + \nCX3CL1(2nM)" , "minocycline"))
# 

# Gain
bp_CeA_gain <- plot_boxplot(CeA_df_mino_sub, gain, mtitle= "", ylabel = "gain", dot_size = 2, vary1 = 0, vary2 = 0.5)
bp_CeA_gain <- bp_CeA_gain + facet_wrap(~ Type, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5), strip.text = element_text(size = 11, face="bold"), strip.background = element_blank())  + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE, size = 8, face = "bold", label.y = -20)

# Threshold
bp_CeA_thres <- plot_boxplot(CeA_df_mino_sub, Treshold1_all, mtitle= "", ylabel = "Threshold (mV)", dot_size = 2, vary1 = -60, vary2 = -10)
bp_CeA_thres <- bp_CeA_thres + facet_wrap(~ Type, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5), strip.text = element_text(size = 11, face="bold"), strip.background = element_blank())  + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE, size = 8, face = "bold", label.y = -20)

# INPUT RESISTANCE
bp_CeA_rm <- plot_boxplot(CeA_df_mino_sub, Rm_20, mtitle= "", ylabel = "Input resistance (MOhm)", dot_size = 2, vary1 = 100, vary2 = 1200)
bp_CeA_rm <- bp_CeA_rm + facet_wrap(~ Type, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5), strip.text = element_text(size = 11, face="bold"), strip.background = element_blank())  + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE, size = 8, face = "bold", label.y = 750)

# TAU
bp_CeA_tau <- plot_boxplot(CeA_df_mino_sub, tau_20, mtitle= "", ylabel = "tau (ms)", dot_size = 2, vary1 = 10, vary2 = 50)
bp_CeA_tau <- bp_CeA_tau + facet_wrap(~ Type, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5), strip.text = element_text(size = 11, face="bold"), strip.background = element_blank())  + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE)


# CAPACITANCE
bp_CeA_cap <- plot_boxplot(CeA_df_mino_sub, C_20, mtitle= "", ylabel = "Capacitance (pF)", dot_size = 2, vary1 = 20, vary2 = 200)
bp_CeA_cap <- bp_CeA_cap + facet_wrap(~ Type, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5), strip.text = element_text(size = 11, face="bold"), strip.background = element_blank())  + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE, size = 8, face = "bold", label.y = 110)

### making representative plots 
## AZD8797
minoa_CeA_IV_subset <- CeA_df_final %>% filter(Experiment == "minocycline") %>% filter(Cell %in% c(64))
minoa_CeA_IV_subset$Filename_all1[minoa_CeA_IV_subset$Filename_all1 == "20729027"] = ""
representative_minoa_CeA_IV <- minoa_CeA_IV_subset %>% plot_IV_individual(mtitle = "") + theme(strip.text = element_text(size = 11, face="bold"), strip.background = element_blank(), plot.margin = unit(c(0.25,0.25,0.25,0.25), "cm"))

# loading image with representative traces
#traces_azd <- fig("images//results//CX3CL1_CeA_IV_traces_frak2nM.png", aspect.ratio = "free", b_pos = "inside", b_size = 0, b_margin =  ggplot2::margin(0, 0, 0, 0))

# making final figure with patchwork
representative_minoa_IV <- fig("images//results//CeA_minoa_IV_representative.png", aspect.ratio = "free", b_pos = "inside", b_size = 0, b_margin =  ggplot2::margin(0, 0, 0, 0))
representative_minoa_Rm <- fig("images//results//CeA_minoa_Rm_representative.png", aspect.ratio = "free", b_pos = "inside", b_size = 0, b_margin =  ggplot2::margin(0, 0, 0, 0))


lay <- "
AB
C#
"
# A <- (bp_CeA_thres | bp_CeA_gain) 
# B <- (bp_CeA_rm | bp_CeA_tau) 
# C <- (bp_CeA_cap | plot_spacer()) 
# D <- (bp_CeA_RS_tau | bp_CeA_LF_tau) + plot_layout(tag_level = 'new')
# E <- (bp_CeA_RS_adap | bp_CeA_LF_adap) + plot_layout(tag_level = 'new')
# F <- (bp_CeA_RS_cap | bp_CeA_LF_cap) + plot_layout(tag_level = 'new')
# G <- (bp_CeA_RS_apw | bp_CeA_LF_apw) + plot_layout(tag_level = 'new')
# H <- (bp_CeA_RS_apa | bp_CeA_LF_apa) + plot_layout(tag_level = 'new')
# I <- (bp_CeA_RS_vm | bp_CeA_LF_vm) + plot_layout(tag_level = 'new')
# J <- (bp_CeA_RS_fast | bp_CeA_LF_fast) + plot_layout(tag_level = 'new')

#figure1 <- wrap_plots(A = A, B = B, C = C, design = lay)

figure1 <- (bp_CeA_thres | bp_CeA_rm | bp_CeA_cap) /
           (representative_minoa_CeA_IV| representative_minoa_IV | representative_minoa_Rm)

figure1 <- figure1 +
   plot_annotation(tag_levels = c('a')) #+ plot_layout(heights = c(0.3, 0.7, 1, 0.5, 1))

figure1



```

### Effects of CX3CL1 on synaptic transmission in the CeL

As CX3CL1 reduced excitability of both the glutamatergic BLA as well as GABAergic CeL neurons, both the excitatory and inhibitory transmission was investigated. 
Regarding excitatory synaptic transmission, no substantial changes were observed in RS and LF neurons. 
The detailed data is shown in the Appendix \@ref(CX3CL1CeAsEPSC).

```{r CX3CL1CeAsIPSCtable, echo = FALSE, message= FALSE, echo = FALSE, warning= FALSE, message = FALSE, fig.width= 15, fig.height= 18}

CeA_sIPSC_final_subset<- CeA_sIPSC_final %>% dplyr::filter(!Experiment %in% c("CX3CL1(5nM)"))
CeA_sIPSC_final_subset_RS <- CeA_sIPSC_final_subset %>% dplyr::filter(Type == 'RS')
CeA_sIPSC_final_subset_LF <- CeA_sIPSC_final_subset %>% dplyr::filter(Type == 'LF')

CeA_frak2nM_mIPSC$Experiment <- plyr::revalue(CeA_frak2nM_mIPSC$Experiment, c("CX3CL1(2nM)" = "TTX + \nCX3CL1(2nM)"))
CeA_frak2nM_mIPSC$Filename <- as.character(CeA_frak2nM_mIPSC$Filename)
CeA_sIPSC_final_subset_LF <- CeA_sIPSC_final_subset_LF %>% dplyr::bind_rows(CeA_frak2nM_mIPSC)
CeA_sIPSC_final_subset_LF$Experiment <- factor(CeA_sIPSC_final_subset_LF$Experiment, levels = c("CX3CL1(2nM)",  "AZD8797 + \nCX3CL1(2nM)", "AZD8797", "minocycline + \nCX3CL1(2nM)", "minocycline",  'TTX + \nCX3CL1(2nM)'))
CeA_sIPSC_final_subset_LF$Condition <- factor(CeA_sIPSC_final_subset_LF$Condition, levels = c("baseline", "CX3CL1", "AZD8797", "minocycline"))
CeA_sIPSC_final_subset_LF$Cell <- rep(1:(nrow(CeA_sIPSC_final_subset_LF)/2), each = 2)
CeA_sIPSC_final_subset_LF$Cell <- as.factor(CeA_sIPSC_final_subset_LF$Cell)

# getting the table of statistics for all CeA df (LF + RS) condition of one experiment
CeA_CX3CL1_sIPSC_stat_all <- stat_table_exp_syn_extended((CeA_sIPSC_final_subset))
CeA_CX3CL1_sIPSC_stat_RS <- stat_table_exp_syn_extended((CeA_sIPSC_final_subset_RS))
CeA_CX3CL1_sIPSC_stat_LF <- stat_table_exp_syn_extended((CeA_sIPSC_final_subset_LF))

CeA_CX3CL1_sIPSC_stat_LF_freq <- as.data.frame(CeA_CX3CL1_sIPSC_stat_LF %>% dplyr::filter(Variable == 'median_Frequency') %>% dplyr::select(Statistics))
CeA_CX3CL1_sIPSC_stat_LF_frak2nM_freq <- CeA_CX3CL1_sIPSC_stat_LF_freq$Statistics[1]
CeA_CX3CL1_sIPSC_stat_LF_azdfrak_freq <- CeA_CX3CL1_sIPSC_stat_LF_freq$Statistics[2]
CeA_CX3CL1_sIPSC_stat_LF_minofrak_freq <- CeA_CX3CL1_sIPSC_stat_LF_freq$Statistics[3]
CeA_CX3CL1_mIPSC_stat_LF_frak2nM_freq <- CeA_CX3CL1_sIPSC_stat_LF_freq$Statistics[6]

CeA_CX3CL1_sIPSC_stat_RS_freq <- as.data.frame(CeA_CX3CL1_sIPSC_stat_RS %>% dplyr::filter(Variable == 'median_Frequency') %>% dplyr::select(Statistics))
CeA_CX3CL1_sIPSC_stat_RS_frak2nM_freq <- CeA_CX3CL1_sIPSC_stat_RS_freq$Statistics[1]
CeA_CX3CL1_sIPSC_stat_RS_azdfrak_freq <- CeA_CX3CL1_sIPSC_stat_RS_freq$Statistics[2]
CeA_CX3CL1_sIPSC_stat_RS_minofrak_freq <- CeA_CX3CL1_sIPSC_stat_RS_freq$Statistics[3]

#CeA_CX3CL1_mIPSC_stat_LF_frak2nM_freq

# CeA_CX3CL1_sIPSC_stat_all <- CeA_CX3CL1_sIPSC_stat_all %>% mutate(Type = "All CeL neurons") %>% dplyr::select(Type, everything())
# CeA_CX3CL1_sIPSC_stat_RS <- CeA_CX3CL1_sIPSC_stat_RS %>% mutate(Type = "Regular-Spiking neurons") %>% dplyr::select(Type, everything())
# CeA_CX3CL1_sIPSC_stat_LF <- CeA_CX3CL1_sIPSC_stat_LF %>% mutate(Type = "Late-Firing neurons") %>% dplyr::select(Type, everything())

#CeA_CX3CL1_sEPSC_df <- CeA_CX3CL1_sEPSC_stat_all  %>% dplyr::bind_rows(CeA_CX3CL1_sEPSC_stat_RS) %>% dplyr::bind_rows(CeA_CX3CL1_sEPSC_stat_LF)

```

On the contrary, CX3CL1 application led to reduction in GABAegic synaptic transmission, manifested as decreased frequency of sIPSCs onto Late-Firing neurons from`r round(CeA_sIPSC_final_subset_LF %>% filter(Experiment == 'CX3CL1(2nM)' & Condition == "baseline") %>% ungroup() %>% summarize(mean(median_Frequency)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_sIPSC_final_subset_LF %>% filter(Experiment == 'CX3CL1(2nM)' & Condition == "baseline") %>% ungroup() %>% dplyr::summarize(x = sd(median_Frequency), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)` to `r round(CeA_sIPSC_final_subset_LF %>% filter(Experiment == 'CX3CL1(2nM)' & Condition == "CX3CL1") %>% ungroup() %>% summarize(mean(median_Frequency)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_sIPSC_final_subset_LF %>% filter(Experiment == 'CX3CL1(2nM)' & Condition == "CX3CL1") %>% ungroup() %>% dplyr::summarize(x = sd(median_Frequency), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)` Hz, n = `r CeA_sIPSC_final_subset_LF %>% filter(Experiment == 'CX3CL1(2nM)') %>% ungroup() %>% dplyr::select(Cell) %>% n_distinct()`, N = `r CeA_sIPSC_final_subset_LF %>% filter(Experiment == 'CX3CL1(2nM)') %>% group_by(Filename) %>% mutate(animals = str_sub(Filename, start = 1, end = 5)) %>% ungroup() %>% dplyr::select(animals) %>% n_distinct()`, `r CeA_CX3CL1_sIPSC_stat_LF_frak2nM_freq`, Fig. \@ref(fig:CX3CL1CeAsIPSCfig)a1).
This effect was abolished when CX3CR1 and microglial activity were blocked by AZD8797 and minocycline, respectively (`r CeA_CX3CL1_sIPSC_stat_LF_azdfrak_freq` and `r CeA_CX3CL1_sIPSC_stat_LF_minofrak_freq`).
These observations suggest a functional involvement of CX3CR1 and minocycline in the modulation of CX3CL1-induced inhibition of GABAergic transmission onto Late-Firing cells.
To examine whether this effect was mediated by spontaneous firing of neurons in the slice, the set of experiments were performed in the presence of TTX (see Fig. \@ref(fig:CX3CL1CeAsIPSCfig)<!--part?-->.
Although 60% of Late-Firing cells reacted with reduction in miniature inhibitory synaptic currents, the statistic did not reach the level of significance (baseline in TTX: `r round(CeA_sIPSC_final_subset_LF %>% filter(Experiment == 'TTX + \nCX3CL1(2nM)' & Condition == "baseline") %>% ungroup() %>% summarize(mean(median_Frequency)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_sIPSC_final_subset_LF %>% filter(Experiment == 'TTX + \nCX3CL1(2nM)' & Condition == "baseline") %>% ungroup() %>% dplyr::summarize(x = sd(median_Frequency), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)`, TTX + CX3CL1(2nM): `r round(CeA_sIPSC_final_subset_LF %>% filter(Experiment == 'TTX + \nCX3CL1(2nM)' & Condition == "CX3CL1") %>% ungroup() %>% summarize(mean(median_Frequency)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_sIPSC_final_subset_LF %>% filter(Experiment == 'TTX + \nCX3CL1(2nM)' & Condition == "CX3CL1") %>% ungroup() %>% dplyr::summarize(x = sd(median_Frequency), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)`, n = `r CeA_sIPSC_final_subset_LF %>% filter(Experiment == 'TTX + \nCX3CL1(2nM)') %>% ungroup() %>% dplyr::select(Cell) %>% n_distinct()`, N = `r CeA_sIPSC_final_subset_LF %>% filter(Experiment == 'TTX + \nCX3CL1(2nM)') %>% group_by(Filename) %>% mutate(animals = str_sub(Filename, start = 1, end = 5)) %>% ungroup() %>% dplyr::select(animals) %>% n_distinct()`, `r CeA_CX3CL1_mIPSC_stat_LF_frak2nM_freq`).
All details about statistics, number of cells, animals, as well as descriptive analysis are summarized in Table <!-- --> in Appendix \@ref(CeACX3CL1sIPSCappendix). 

In contrast, no significant effect on inhibitory synaptic transmission onto CX3CL1-treated Regular-Spiking neurons was found, despite a trend toward increased frequency (baseline: `r round(CeA_sIPSC_final_subset_RS %>% filter(Experiment == 'CX3CL1(2nM)' & Condition == "baseline") %>% ungroup() %>% summarize(mean(median_Frequency)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_sIPSC_final_subset_RS %>% filter(Experiment == 'CX3CL1(2nM)' & Condition == "baseline") %>% ungroup() %>% dplyr::summarize(x = sd(median_Frequency), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)`, CX3CL1(2nM): `r round(CeA_sIPSC_final_subset_RS %>% filter(Experiment == 'CX3CL1(2nM)' & Condition == "CX3CL1") %>% ungroup() %>% summarize(mean(median_Frequency)), digits = 2)` `r knitr::asis_output("\U00B1")` `r round(CeA_sIPSC_final_subset_RS %>% filter(Experiment == 'CX3CL1(2nM)' & Condition == "CX3CL1") %>% ungroup() %>% dplyr::summarize(x = sd(median_Frequency), count = n()) %>% dplyr::summarize(x/sqrt(count)), digits = 3)`, n = `r CeA_sIPSC_final_subset_RS %>% filter(Experiment == 'CX3CL1(2nM)') %>% ungroup() %>% dplyr::select(Cell) %>% n_distinct()`, N = `r CeA_sIPSC_final_subset_RS %>% filter(Experiment == 'CX3CL1(2nM)') %>% group_by(Filename) %>% mutate(animals = str_sub(Filename, start = 1, end = 5)) %>% ungroup() %>% dplyr::select(animals) %>% n_distinct()`, `r CeA_CX3CL1_sIPSC_stat_RS_frak2nM_freq`, Fig. \@ref(fig:CX3CL1CeAsIPSCfig)a1).
The kinetics of sIPSC and mIPSC remained unaffected, as shown in Fig.\@ref(fig:CX3CL1CeAsIPSCfigappendix) in the Appendix \@ref(CeACX3CL1sIPSCappendix).

<!--Neurons in both regions also make extensive local connections (McDonald, 1982; Sun and Cassell, 1993; Jolkkonen and Pitkänen, 1998), with local glutamate excitation of CeL neurons evoking IPSCs in neighboring neurons (Lopez de Armentia and Sah, 2004).-->

```{r CX3CL1CeAsIPSCfig, fig.cap='**CX3CL1 suppresses GABAergic transmission onto Late-Firing neurons in the CeL.** **(a1)** Boxplots presenting the difference in Late-Firing and Regular-Spiking neurons in the frequency of sIPSCs following CX3CL1 treatment **(a2)** Boxplot presenting changes of sIPSCs frequency in Late-Firing neurons across different conditions. **(b1)** Boxplots presenting the difference in Late-Firing and Regular-Spiking neurons in the amplitude of sIPSCs following CX3CL1 treatment **(a2)** Boxplot presenting changes of sIPSCs amplitude in Late-Firing neurons across different conditions. **(c)** Representative current traces of Late-Firing neurons illustrating inhibitory synaptic currents (upward deflections) before (blue) and after (red) CX3CL1 application. **(d)** Representative current traces of Late-Firing neurons illustrating inhibitory synaptic currents (upward deflections) before (blue) and after (red) CX3CL1 application in the presence of TTX, blocking action-potentials. **(e)** Representative current traces of Late-Firing neurons illustrating inhibitory synaptic currents (upward deflections) before (blue) and after (red) CX3CL1 application in the presence of AZD8797, the CX3CR1 blocker. **(f)** Representative current traces of Late-Firing neurons illustrating inhibitory synaptic currents (upward deflections) before (blue) and after (red) CX3CL1 application in the presence of minocycline, a blocker of microglial activity. Scale bar: 10pA, 1s', fig.align = 'center', echo = FALSE, message= FALSE, echo = FALSE, warning= FALSE, message = FALSE, fig.height= 15, fig.width= 14}
#knitr::include_graphics("images/results//CX3CL1_BLA_excitability.png")
#knitr::include_graphics("images/results//CX3CL1_BLA_excitability.png")

# subsetting conditions for making general boxplot
CeA_sIPSC_fin_LF <- CeA_sIPSC_final_subset_LF %>% filter(Experiment == "CX3CL1(2nM)")
CeA_sIPSC_fin_RS <- CeA_sIPSC_final_subset_RS %>% filter(Experiment == "CX3CL1(2nM)")
CeA_sIPSC_fin_RS$Cell <- as.factor(CeA_sIPSC_fin_RS$Cell)
CeA_sIPSC_fin_fin <- CeA_sIPSC_fin_LF %>% dplyr::bind_rows(CeA_sIPSC_fin_RS)
CeA_sIPSC_fin_fin$Type <- plyr::revalue(CeA_sIPSC_fin_fin$Type, c("LF" = "Late-Firing", "RS" = "Regular-Spiking"))
# making boxplots with facets

bp_CeA_s_freq_sIPSC_gen <- plot_boxplot(CeA_sIPSC_fin_fin, median_Frequency, ylabel = "sIPSC Frequency (Hz)", vary1 = 0, vary2 = 5, dot_size = 2,  mtitle = "CeL neurons") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5)) 

bp_CeA_s_freq_sIPSC_gen  <- bp_CeA_s_freq_sIPSC_gen + facet_wrap(~ Type, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 14, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5),  strip.text = element_text(size = 11, face="bold"), strip.background = element_blank()) + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE, size = 8, label.y = 4) 

bp_CeA_s_freq_sIPSC_LF <- plot_boxplot(CeA_sIPSC_final_subset_LF, median_Frequency, ylabel = "s/mIPSC Frequency (Hz)", vary1 = 0, vary2 = 5, dot_size = 2,  mtitle = "Late-Firing neurons") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5)) 

bp_CeA_s_freq_sIPSC_LF  <- bp_CeA_s_freq_sIPSC_LF  + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 14, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5),  strip.text = element_text(size = 11, face="bold"), strip.background = element_blank()) + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE, size = 8, label.y = 4) 

bp_CeA_s_freq_sIPSC_RS <- plot_boxplot(CeA_sIPSC_final_subset_RS, median_Frequency, ylabel = "s/mIPSC Frequency (Hz)", vary1 = 0, vary2 = 5, dot_size = 2,  mtitle = "Regular-Spiking neurons") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5)) 

bp_CeA_s_freq_sIPSC_RS  <- bp_CeA_s_freq_sIPSC_RS  + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 14, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5),  strip.text = element_text(size = 11, face="bold"), strip.background = element_blank()) + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE, size = 8, label.y = 4) 

# making boxplots for amplitude
bp_CeA_s_amp_sIPSC_gen  <- plot_boxplot(CeA_sIPSC_fin_fin, median_Amplitude, ylabel = "IPSC Amplitude (pA)", vary1 = 0, vary2 = 40, dot_size = 2,  mtitle = "CeL neurons") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5))
bp_CeA_s_amp_sIPSC_gen  <- bp_CeA_s_amp_sIPSC_gen  + facet_wrap(~ Type, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 14, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5),  strip.text = element_text(size = 11, face="bold"), strip.background = element_blank()) + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE, size = 8, label.y = 35)


bp_CeA_s_amp_sIPSC_LF  <- plot_boxplot(CeA_sIPSC_final_subset_LF, median_Amplitude, ylabel = "s/mIPSC Amplitude (pA)", vary1 = 0, vary2 = 40, dot_size = 2,  mtitle = "Late-Firing neurons") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5))
bp_CeA_s_amp_sIPSC_LF  <- bp_CeA_s_amp_sIPSC_LF  + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 14, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5),  strip.text = element_text(size = 11, face="bold"), strip.background = element_blank()) + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE, size = 8, label.y = 35)

bp_CeA_s_amp_sIPSC_RS  <- plot_boxplot(CeA_sIPSC_final_subset_RS, median_Amplitude, ylabel = "s/mIPSC Amplitude (pA)", vary1 = 0, vary2 = 40, dot_size = 2,  mtitle = "") + theme(plot.title = element_text(size= 16, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5))
bp_CeA_s_amp_sIPSC_RS  <- bp_CeA_s_amp_sIPSC_RS  + facet_wrap(~ Experiment, nrow = 1, scales = "free_x") + theme(plot.title = element_text(size= 14, face="bold"), axis.text.x = element_text(angle = 30, vjust = 0.7, hjust=0.5),  strip.text = element_text(size = 11, face="bold"), strip.background = element_blank()) + stat_compare_means(method = 't.test', hide.ns = TRUE, label = 'p.signif', paired = TRUE, label.x.npc = 'center', var.equal = TRUE, size = 8, label.y = 35)

#importing representative traces
# fig("images//results//IV_representative_minoa.png", aspect.ratio = "free", b_pos = "inside", b_size = 0, b_margin =  ggplot2::margin(0, 0, 0, 0))
representative_frak2nM <-  fig("images//results//CeA_frak2nM_sIPSC_frak2nM.png", aspect.ratio = "free", b_pos = "inside", b_size = 0, b_margin =  ggplot2::margin(0, 0, 0, 0))
representative_azdfrak2nM <- fig("images//results//CeA_frak2nM_sIPSC_azdfrak.png", aspect.ratio = "free", b_pos = "inside", b_size = 0, b_margin =  ggplot2::margin(0, 0, 0, 0))
representative_minofrak2nM <- fig("images//results//CeA_frak2nM_sIPSC_minofrak.png", aspect.ratio = "free", b_pos = "inside", b_size = 0, b_margin =  ggplot2::margin(0, 0, 0, 0))
representative_ttxfrak2nM <- fig("images//results//CeA_frak2nM_mIPSC_frak2nM.png", aspect.ratio = "free", b_pos = "inside", b_size = 0, b_margin =  ggplot2::margin(0, 0, 0, 0))


#using patchwork to do layout of the figure
A <- (bp_CeA_s_freq_sIPSC_gen| bp_CeA_s_freq_sIPSC_LF) + plot_layout(tag_level = "new", widths = c(0.5,1))
B <-  (bp_CeA_s_amp_sIPSC_gen| bp_CeA_s_amp_sIPSC_LF) + plot_layout(tag_level = "new", widths = c(0.5,1))
C <-  ((representative_frak2nM + ggtitle("CX3CL1(2nM)")) | (representative_ttxfrak2nM + ggtitle("TTX + CX3CL1(2nM)")))
D <-  ((representative_azdfrak2nM + ggtitle("AZD8797 + CX3CL1(2nM)")) | (representative_minofrak2nM + ggtitle("minocycline + CX3CL1(2nM)"))) 

# C <- (((traces_frak2nM +  ggtitle('CX3CL1(2nM)')) | (traces_azdfrak + ggtitle('AZD8797 + CX3CL1(2nM)')) | (traces_minofrak + ggtitle('minocycline + CX3CL1(2nM)')) + plot_layout(tag_level = "new")))

lay <- "
AA
BB
CC
DD
"

figure1 <- wrap_plots(A = A, B = B, C = C, D = D, design = lay)

figure1 <- figure1 + plot_annotation(tag_levels = c('a', '1'))


figure1


```

<!-- two major classes of CeL neurons with distinct firing patterns,-->

### CX3CR1 receptor expression in the CeA

Having found that mainly Regular-Spiking neurons are reactive to CX3CL1 application, as assessed by changes in an input resistance, time membrane constant, and excitability, the next step was to examine whether these cell-specific effects are reflected by different CX3CR1 expression.
Unfortunately, neither Late-Firing  nor Regular-Spiking electrophysiological type do not clearly correlate with any specific molecular marker.
According to literature,<!-- zmienić--> around 15% of Regular-Spiking neurons express PKC`r knitr::asis_output("\U03B4")`, whereas around 60% of all SOM-immunopositive neurons belong to the RS type [@haubensak_2010; @li_2013a].
Immunohistochemical data presented in Fig.<!-- --> show that CX3CR1 was co-expressed with <!-- --> % of SOM-positive and <!-- -->% of PKC`r knitr::asis_output("\U03B4")`-expressing neurons in the CeL.
The neuronal expression of CX3CL1 was also assessed and it was .... in RS neurons and .... in LF neurons.

To better characterize the CX3CR1 expression in CeL neurons based on their electrophysiological subtypes, the immunostainings were performed on thicker brain slices after electrophysiological recordings.<!--the CX3CR1 expression was also directly verified by immunofluorescent staining of a set of slices with identified firing pattern of patched neurons.--> 
Patched neurons were identified as either Regular-Spiking or Late-Firing CeL subtype and filled with biocitin-based internal solution in the recording electrode, and then fixed, as described in Method \@ref(postimmuno). 

